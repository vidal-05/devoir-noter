/**
 * crisp-client
 * @version v3.0.0 e0e2da7
 * @author Crisp IM SAS
 * @date 1/13/2026
 */
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["stylesheets/common_default_e0e2da7.css","stylesheets/features/overlay_default_e0e2da7.css","stylesheets/features/browsing_default_e0e2da7.css","stylesheets/features/call_default_e0e2da7.css","stylesheets/features/chat_default_e0e2da7.css"])))=>i.map(i=>d[i]);
var t=null;function e(){if(null===t)throw new Error("Client not initialized");return t}function i(t){const e=Object.create(null);for(const i of t.split(","))e[i]=1;return t=>t in e}const s={},n=[],r=()=>{},o=()=>!1,u=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),a=t=>t.startsWith("onUpdate:"),l=Object.assign,h=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},c=Object.prototype.hasOwnProperty,d=(t,e)=>c.call(t,e),D=Array.isArray,f=t=>"[object Map]"===E(t),p=t=>"[object Set]"===E(t),m=t=>"[object Date]"===E(t),F=t=>"function"==typeof t,g=t=>"string"==typeof t,v=t=>"symbol"==typeof t,w=t=>null!==t&&"object"==typeof t,b=t=>(w(t)||F(t))&&F(t.then)&&F(t.catch),y=Object.prototype.toString,E=t=>y.call(t),C=t=>"[object Object]"===E(t),k=t=>g(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,B=i(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),A=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},x=/-\w/g,S=A(t=>t.replace(x,t=>t.slice(1).toUpperCase())),z=/\B([A-Z])/g,I=A(t=>t.replace(z,"-$1").toLowerCase()),j=A(t=>t.charAt(0).toUpperCase()+t.slice(1)),R=A(t=>t?`on${j(t)}`:""),O=(t,e)=>!Object.is(t,e),M=(t,...e)=>{for(let i=0;i<t.length;i++)t[i](...e)},q=(t,e,i,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:i})},U=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let P;const T=()=>P||(P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function L(t){if(D(t)){const e={};for(let i=0;i<t.length;i++){const s=t[i],n=g(s)?W(s):L(s);if(n)for(const t in n)e[t]=n[t]}return e}if(g(t)||w(t))return t}const N=/;(?![^(]*\))/g,V=/:([^]+)/,H=/\/\*[^]*?\*\//g;function W(t){const e={};return t.replace(H,"").split(N).forEach(t=>{if(t){const i=t.split(V);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function J(t){let e="";if(g(t))e=t;else if(D(t))for(let i=0;i<t.length;i++){const s=J(t[i]);s&&(e+=s+" ")}else if(w(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const G=i("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function K(t){return!!t||""===t}function Y(t,e){if(t===e)return!0;let i=m(t),s=m(e);if(i||s)return!(!i||!s)&&t.getTime()===e.getTime();if(i=v(t),s=v(e),i||s)return t===e;if(i=D(t),s=D(e),i||s)return!(!i||!s)&&function(t,e){if(t.length!==e.length)return!1;let i=!0;for(let s=0;i&&s<t.length;s++)i=Y(t[s],e[s]);return i}(t,e);if(i=w(t),s=w(e),i||s){if(!i||!s)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t){const s=t.hasOwnProperty(i),n=e.hasOwnProperty(i);if(s&&!n||!s&&n||!Y(t[i],e[i]))return!1}}return String(t)===String(e)}function Z(t,e){return t.findIndex(t=>Y(t,e))}const X=t=>!(!t||!0!==t.De),Q=t=>g(t)?t:null==t?"":D(t)||w(t)&&(t.toString===y||!F(t.toString))?X(t)?Q(t.value):JSON.stringify(t,tt,2):String(t),tt=(t,e)=>X(e)?tt(t,e.value):f(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[e,i],s)=>(t[et(e,s)+" =>"]=i,t),{})}:p(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>et(t))}:v(e)?et(e):!w(e)||D(e)||C(e)?e:String(e),et=(t,e="")=>{var i;return v(t)?`Symbol(${null!=(i=t.description)?i:e})`:t};function it(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}let st,nt;class rt{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=st,!t&&st&&(this.index=(st.scopes||(st.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let t,e;if(this._isPaused=!0,this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){let t,e;if(this._isPaused=!1,this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=st;try{return st=this,t()}finally{st=e}}}on(){1===++this._on&&(this.prevScope=st,st=this)}off(){this._on>0&&0===--this._on&&(st=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){let e,i;for(this._active=!1,e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(this.effects.length=0,e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0}}}const ot=new WeakSet;class ut{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,st&&st.active&&st.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,ot.has(this)&&(ot.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||ct(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,kt(this),ft(this);const t=nt,e=bt;nt=this,bt=!0;try{return this.fn()}finally{pt(this),nt=t,bt=e,this.flags&=-3}}stop(){if(1&this.flags){for(let t=this.deps;t;t=t.nextDep)Ft(t);this.deps=this.depsTail=void 0,kt(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?ot.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){mt(this)&&this.run()}get dirty(){return mt(this)}}let at,lt,ht=0;function ct(t,e=!1){if(t.flags|=8,e)return t.next=lt,void(lt=t);t.next=at,at=t}function dt(){ht++}function Dt(){if(--ht>0)return;if(lt){let t=lt;for(lt=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let t;for(;at;){let i=at;for(at=void 0;i;){const s=i.next;if(i.next=void 0,i.flags&=-9,1&i.flags)try{i.trigger()}catch(e){t||(t=e)}i=s}}if(t)throw t}function ft(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function pt(t){let e,i=t.depsTail,s=i;for(;s;){const t=s.prevDep;-1===s.version?(s===i&&(i=t),Ft(s),gt(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=t}t.deps=e,t.depsTail=i}function mt(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(_t(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function _t(t){if(4&t.flags&&!(16&t.flags))return;if(t.flags&=-17,t.globalVersion===$t)return;if(t.globalVersion=$t,!t.isSSR&&128&t.flags&&(!t.deps&&!t._dirty||!mt(t)))return;t.flags|=2;const e=t.dep,i=nt,s=bt;nt=t,bt=!0;try{ft(t);const i=t.fn(t._value);(0===e.version||O(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(n){throw e.version++,n}finally{nt=i,bt=s,pt(t),t.flags&=-3}}function Ft(t,e=!1){const{dep:i,prevSub:s,nextSub:n}=t;if(s&&(s.nextSub=n,t.prevSub=void 0),n&&(n.prevSub=s,t.nextSub=void 0),i.subs===t&&(i.subs=s,!s&&i.computed)){i.computed.flags&=-5;for(let t=i.computed.deps;t;t=t.nextDep)Ft(t,!0)}e||--i.sc||!i.map||i.map.delete(i.key)}function gt(t){const{prevDep:e,nextDep:i}=t;e&&(e.nextDep=i,t.prevDep=void 0),i&&(i.prevDep=e,t.nextDep=void 0)}function vt(t,e){t.effect instanceof ut&&(t=t.effect.fn);const i=new ut(t);e&&l(i,e);try{i.run()}catch(n){throw i.stop(),n}const s=it(i.run,i);return s.effect=i,s}function wt(t){t.effect.stop()}let bt=!0;const yt=[];function Et(){yt.push(bt),bt=!1}function Ct(){const t=yt.pop();bt=void 0===t||t}function kt(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const t=nt;nt=void 0;try{e()}finally{nt=t}}}let $t=0;class Bt{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class At{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.me=!0}track(t){if(!nt||!bt||nt===this.computed)return;let e=this.activeLink;if(void 0===e||e.sub!==nt)e=this.activeLink=new Bt(nt,this),nt.deps?(e.prevDep=nt.depsTail,nt.depsTail.nextDep=e,nt.depsTail=e):nt.deps=nt.depsTail=e,xt(e);else if(-1===e.version&&(e.version=this.version,e.nextDep)){const t=e.nextDep;t.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=t),e.prevDep=nt.depsTail,e.nextDep=void 0,nt.depsTail.nextDep=e,nt.depsTail=e,nt.deps===e&&(nt.deps=t)}return e}trigger(t){this.version++,$t++,this.notify(t)}notify(t){dt();try{0;for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Dt()}}}function xt(t){if(t.dep.sc++,4&t.sub.flags){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let t=e.deps;t;t=t.nextDep)xt(t)}const i=t.dep.subs;i!==t&&(t.prevSub=i,i&&(i.nextSub=t)),t.dep.subs=t}}const St=new WeakMap,zt=Symbol(""),It=Symbol(""),jt=Symbol("");function Rt(t,e,i){if(bt&&nt){let e=St.get(t);e||St.set(t,e=new Map);let s=e.get(i);s||(e.set(i,s=new At),s.map=e,s.key=i),s.track()}}function Ot(t,e,i,s,n,r){const o=St.get(t);if(!o)return void $t++;const u=t=>{t&&t.trigger()};if(dt(),"clear"===e)o.forEach(u);else{const n=D(t),r=n&&k(i);if(n&&"length"===i){const t=Number(s);o.forEach((e,i)=>{("length"===i||i===jt||!v(i)&&i>=t)&&u(e)})}else switch((void 0!==i||o.has(void 0))&&u(o.get(i)),r&&u(o.get(jt)),e){case"add":n?r&&u(o.get("length")):(u(o.get(zt)),f(t)&&u(o.get(It)));break;case"delete":n||(u(o.get(zt)),f(t)&&u(o.get(It)));break;case"set":f(t)&&u(o.get(zt))}}Dt()}function Mt(t){const e=ke(t);return e===t?e:(Rt(e,0,jt),Ee(t)?e:e.map(Be))}function qt(t){return Rt(t=ke(t),0,jt),t}function Ut(t,e){return ye(t)?be(t)?Ae(Be(e)):Ae(e):Be(e)}const Pt={__proto__:null,[Symbol.iterator](){return Tt(this,Symbol.iterator,t=>Ut(this,t))},concat(...t){return Mt(this).concat(...t.map(t=>D(t)?Mt(t):t))},entries(){return Tt(this,"entries",t=>(t[1]=Ut(this,t[1]),t))},every(t,e){return Nt(this,"every",t,e,void 0,arguments)},filter(t,e){return Nt(this,"filter",t,e,t=>t.map(t=>Ut(this,t)),arguments)},find(t,e){return Nt(this,"find",t,e,t=>Ut(this,t),arguments)},findIndex(t,e){return Nt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Nt(this,"findLast",t,e,t=>Ut(this,t),arguments)},findLastIndex(t,e){return Nt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Nt(this,"forEach",t,e,void 0,arguments)},includes(...t){return Ht(this,"includes",t)},indexOf(...t){return Ht(this,"indexOf",t)},join(t){return Mt(this).join(t)},lastIndexOf(...t){return Ht(this,"lastIndexOf",t)},map(t,e){return Nt(this,"map",t,e,void 0,arguments)},pop(){return Wt(this,"pop")},push(...t){return Wt(this,"push",t)},reduce(t,...e){return Vt(this,"reduce",t,e)},reduceRight(t,...e){return Vt(this,"reduceRight",t,e)},shift(){return Wt(this,"shift")},some(t,e){return Nt(this,"some",t,e,void 0,arguments)},splice(...t){return Wt(this,"splice",t)},toReversed(){return Mt(this).toReversed()},toSorted(t){return Mt(this).toSorted(t)},toSpliced(...t){return Mt(this).toSpliced(...t)},unshift(...t){return Wt(this,"unshift",t)},values(){return Tt(this,"values",t=>Ut(this,t))}};function Tt(t,e,i){const s=qt(t),n=s[e]();return s===t||Ee(t)||(n._next=n.next,n.next=()=>{const t=n._next();return t.done||(t.value=i(t.value)),t}),n}const Lt=Array.prototype;function Nt(t,e,i,s,n,r){const o=qt(t),u=o!==t&&!Ee(t),a=o[e];if(a!==Lt[e]){const e=a.apply(t,r);return u?Be(e):e}let l=i;o!==t&&(u?l=function(e,s){return i.call(this,Ut(t,e),s,t)}:i.length>2&&(l=function(e,s){return i.call(this,e,s,t)}));const h=a.call(o,l,s);return u&&n?n(h):h}function Vt(t,e,i,s){const n=qt(t);let r=i;return n!==t&&(Ee(t)?i.length>3&&(r=function(e,s,n){return i.call(this,e,s,n,t)}):r=function(e,s,n){return i.call(this,e,Ut(t,s),n,t)}),n[e](r,...s)}function Ht(t,e,i){const s=ke(t);Rt(s,0,jt);const n=s[e](...i);return-1!==n&&!1!==n||!Ce(i[0])?n:(i[0]=ke(i[0]),s[e](...i))}function Wt(t,e,i=[]){Et(),dt();const s=ke(t)[e].apply(t,i);return Dt(),Ct(),s}const Jt=i("__proto__,__v_isRef,__isVue"),Gt=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>"arguments"!==t&&"caller"!==t).map(t=>Symbol[t]).filter(v));function Kt(t){v(t)||(t=String(t));const e=ke(this);return Rt(e,0,t),e.hasOwnProperty(t)}class Yt{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){if("__v_skip"===e)return t.me;const s=this._isReadonly,n=this._isShallow;if("__v_isReactive"===e)return!s;if("__v_isReadonly"===e)return s;if("__v_isShallow"===e)return n;if("__v_raw"===e)return i===(s?n?pe:fe:n?De:de).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const r=D(t);if(!s){let t;if(r&&(t=Pt[e]))return t;if("hasOwnProperty"===e)return Kt}const o=Reflect.get(t,e,xe(t)?t:i);if(v(e)?Gt.has(e):Jt(e))return o;if(s||Rt(t,0,e),n)return o;if(xe(o)){const t=r&&k(e)?o:o.value;return s&&w(t)?ge(t):t}return w(o)?s?ge(o):_e(o):o}}class Zt extends Yt{constructor(t=!1){super(!1,t)}set(t,e,i,s){let n=t[e];const r=D(t)&&k(e);if(!this._isShallow){const t=ye(n);if(Ee(i)||ye(i)||(n=ke(n),i=ke(i)),!r&&xe(n)&&!xe(i))return t||(n.value=i),!0}const o=r?Number(e)<t.length:d(t,e),u=Reflect.set(t,e,i,xe(t)?t:s);return t===ke(s)&&(o?O(i,n)&&Ot(t,"set",e,i):Ot(t,"add",e,i)),u}deleteProperty(t,e){const i=d(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&i&&Ot(t,"delete",e,void 0),s}has(t,e){const i=Reflect.has(t,e);return v(e)&&Gt.has(e)||Rt(t,0,e),i}ownKeys(t){return Rt(t,0,D(t)?"length":zt),Reflect.ownKeys(t)}}class Xt extends Yt{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Qt=new Zt,te=new Xt,ee=new Zt(!0),ie=new Xt(!0),se=t=>t,ne=t=>Reflect.getPrototypeOf(t);function re(t){return function(...e){return"delete"!==t&&("clear"===t?void 0:this)}}function oe(t,e){const i={get(i){const s=this.__v_raw,n=ke(s),r=ke(i);t||(O(i,r)&&Rt(n,0,i),Rt(n,0,r));const{has:o}=ne(n),u=e?se:t?Ae:Be;return o.call(n,i)?u(s.get(i)):o.call(n,r)?u(s.get(r)):void(s!==n&&s.get(i))},get size(){const e=this.__v_raw;return!t&&Rt(ke(e),0,zt),e.size},has(e){const i=this.__v_raw,s=ke(i),n=ke(e);return t||(O(e,n)&&Rt(s,0,e),Rt(s,0,n)),e===n?i.has(e):i.has(e)||i.has(n)},forEach(i,s){const n=this,r=n.__v_raw,o=ke(r),u=e?se:t?Ae:Be;return!t&&Rt(o,0,zt),r.forEach((t,e)=>i.call(s,u(t),u(e),n))}};l(i,t?{add:re("add"),set:re("set"),delete:re("delete"),clear:re("clear")}:{add(t){e||Ee(t)||ye(t)||(t=ke(t));const i=ke(this);return ne(i).has.call(i,t)||(i.add(t),Ot(i,"add",t,t)),this},set(t,i){e||Ee(i)||ye(i)||(i=ke(i));const s=ke(this),{has:n,get:r}=ne(s);let o=n.call(s,t);o||(t=ke(t),o=n.call(s,t));const u=r.call(s,t);return s.set(t,i),o?O(i,u)&&Ot(s,"set",t,i):Ot(s,"add",t,i),this},delete(t){const e=ke(this),{has:i,get:s}=ne(e);let n=i.call(e,t);n||(t=ke(t),n=i.call(e,t)),s&&s.call(e,t);const r=e.delete(t);return n&&Ot(e,"delete",t,void 0),r},clear(){const t=ke(this),e=0!==t.size,i=t.clear();return e&&Ot(t,"clear",void 0,void 0),i}});return["keys","values","entries",Symbol.iterator].forEach(s=>{i[s]=function(t,e,i){return function(...s){const n=this.__v_raw,r=ke(n),o=f(r),u="entries"===t||t===Symbol.iterator&&o,a="keys"===t&&o,l=n[t](...s),h=i?se:e?Ae:Be;return!e&&Rt(r,0,a?It:zt),{next(){const{value:t,done:e}=l.next();return e?{value:t,done:e}:{value:u?[h(t[0]),h(t[1])]:h(t),done:e}},[Symbol.iterator](){return this}}}}(s,t,e)}),i}function ue(t,e){const i=oe(t,e);return(e,s,n)=>"__v_isReactive"===s?!t:"__v_isReadonly"===s?t:"__v_raw"===s?e:Reflect.get(d(i,s)&&s in e?i:e,s,n)}const ae={get:ue(!1,!1)},le={get:ue(!1,!0)},he={get:ue(!0,!1)},ce={get:ue(!0,!0)},de=new WeakMap,De=new WeakMap,fe=new WeakMap,pe=new WeakMap;function me(t){return t.me||!Object.isExtensible(t)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((t=>E(t).slice(8,-1))(t))}function _e(t){return ye(t)?t:we(t,!1,Qt,ae,de)}function Fe(t){return we(t,!1,ee,le,De)}function ge(t){return we(t,!0,te,he,fe)}function ve(t){return we(t,!0,ie,ce,pe)}function we(t,e,i,s,n){if(!w(t))return t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const r=me(t);if(0===r)return t;const o=n.get(t);if(o)return o;const u=new Proxy(t,2===r?s:i);return n.set(t,u),u}function be(t){return ye(t)?be(t.__v_raw):!(!t||!t.__v_isReactive)}function ye(t){return!(!t||!t.__v_isReadonly)}function Ee(t){return!(!t||!t.__v_isShallow)}function Ce(t){return!!t&&!!t.__v_raw}function ke(t){const e=t&&t.__v_raw;return e?ke(e):t}function $e(t){return!d(t,"__v_skip")&&Object.isExtensible(t)&&q(t,"__v_skip",!0),t}const Be=t=>w(t)?_e(t):t,Ae=t=>w(t)?ge(t):t;function xe(t){return!!t&&!0===t.De}const Se={get:(t,e,i)=>{return"__v_raw"===e?t:xe(s=Reflect.get(t,e,i))?s.value:s;var s},set:(t,e,i,s)=>{const n=t[e];return xe(n)&&!xe(i)?(n.value=i,!0):Reflect.set(t,e,i,s)}};function ze(t){return be(t)?t:new Proxy(t,Se)}class Ie{constructor(t,e,i){this.fn=t,this.setter=e,this._value=void 0,this.dep=new At(this),this.De=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$t-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=i}notify(){if(this.flags|=16,!(8&this.flags)&&nt!==this)return ct(this,!0),!0}get value(){const t=this.dep.track();return _t(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function je(t,e,i=!1){let s,n;F(t)?s=t:(s=t.get,n=t.set);return new Ie(s,n,i)}const Re={},Oe=new WeakMap;let Me;function qe(t,e,i=s){const{immediate:n,deep:o,once:u,scheduler:a,augmentJob:l,call:c}=i,d=t=>o?t:Ee(t)||!1===o||0===o?Ue(t,1):Ue(t);let f,p,m,g,v=!1,w=!1;if(xe(t)?(p=()=>t.value,v=Ee(t)):be(t)?(p=()=>d(t),v=!0):D(t)?(w=!0,v=t.some(t=>be(t)||Ee(t)),p=()=>t.map(t=>xe(t)?t.value:be(t)?d(t):F(t)?c?c(t,2):t():void 0)):p=F(t)?e?c?()=>c(t,2):t:()=>{if(m){Et();try{m()}finally{Ct()}}const e=Me;Me=f;try{return c?c(t,3,[g]):t(g)}finally{Me=e}}:r,e&&o){const t=p,e=!0===o?1/0:o;p=()=>Ue(t(),e)}const b=st,y=()=>{f.stop(),b&&b.active&&h(b.effects,f)};if(u&&e){const t=e;e=(...e)=>{t(...e),y()}}let E=w?new Array(t.length).fill(Re):Re;const C=t=>{if(1&f.flags&&(f.dirty||t))if(e){const t=f.run();if(o||v||(w?t.some((t,e)=>O(t,E[e])):O(t,E))){m&&m();const i=Me;Me=f;try{const i=[t,E===Re?void 0:w&&E[0]===Re?[]:E,g];E=t,c?c(e,3,i):e(...i)}finally{Me=i}}}else f.run()};return l&&l(C),f=new ut(p),f.scheduler=a?()=>a(C,!1):C,g=t=>function(t,e=!1,i=Me){if(i){let e=Oe.get(i);e||Oe.set(i,e=[]),e.push(t)}}(t,!1,f),m=f.onStop=()=>{const t=Oe.get(f);if(t){if(c)c(t,4);else for(const e of t)e();Oe.delete(f)}},e?n?C(!0):E=f.run():a?a(it(C,null,!0),!0):f.run(),y.pause=it(f.pause,f),y.resume=it(f.resume,f),y.stop=y,y}function Ue(t,e=1/0,i){if(e<=0||!w(t)||t.me)return t;if(((i=i||new Map).get(t)||0)>=e)return t;if(i.set(t,e),e--,xe(t))Ue(t.value,e,i);else if(D(t))for(let s=0;s<t.length;s++)Ue(t[s],e,i);else if(p(t)||f(t))t.forEach(t=>{Ue(t,e,i)});else if(C(t)){for(const s in t)Ue(t[s],e,i);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Ue(t[s],e,i)}return t}const Pe={PROJECT_NAME:"crisp-client",REVISION:"e0e2da7",PROTOCOL:"__CRISP__INTERNAL__PROTOCOL__",URL_CLIENT:"https://client.crisp.chat",URL_RELAY_CLIENT:"https://client.relay.crisp.chat",URL_RELAY_STREAM:"https://stream.relay.crisp.chat",URL_WEBSITE:"https://crisp.chat",URL_GO:"https://go.crisp.chat",URL_IMAGE:"https://image.crisp.chat",URL_GAME:"https://game.crisp.chat",PLATFORM_NAME:"crisp-client@v2",PLATFORM_SIGNATURE_KEY:"1k/2y/2u/2z/38/1e/3d/38/2y/23/1e/1y/29/34/1j/26",SOCKET_AFFINITY:!0,RTC_ICE:[{urls:["stun:stun.media.crisp.chat:3478","stun:stun.media.crisp.chat:3479"]},{urls:["turn:turn.media.crisp.chat:3478?transport=udp","turn:turn.media.crisp.chat:3478?transport=tcp","turn:turn.media.crisp.chat:3479?transport=udp","turn:turn.media.crisp.chat:3479?transport=tcp","turns:turn.media.crisp.chat:443?transport=tcp"],username:"client_9F9kh",credential:"DPCEHTqUb7jiJ2mvnzcUmFV4mKK6c8jntUXo4gC8tYCbHTocuy9YJiCxpQ4tmG3p"}],CIRCUIT_BREAKER_DOMAINS:[],CIRCUIT_BREAKER_AGENTS:["Trident","Googlebot","Bingbot","Slurp","DuckDuckBot","Baiduspider","YandexBot","GTmetrix","Lighthouse","Acunetix","Ahrefs","SemrushBot","SiteAuditBot","SplitSignalBot","HeadlessChrome"],CIRCUIT_BREAKER_ENGINES:[{element:"head link[rel='icon'][type='image/x-icon'][href^='https://sellpass.io']"},{element:"head script[src*='/cdn.sellix.io/']"},{element:"head link[rel='preconnect'][href^='https://cdn.sellix.io/']"},{element:"head link[rel='preconnect'][href^='https://api.sellsn.io']"},{element:"head link[rel='author'][href^='https://ereemby.com/']"},{element:"body script[src$='/aiz-core.js']"}],ENVIRONMENT:"production",TEST:!1,SMILEYS:{"small-smile":":)","big-smile":":D",blushing:":$",confused:"x)",cool:"8)",crying:":'(",embarrassed:":/",heart:"<3",laughing:":'D",sad:":(",angry:":@",sick:":S","thumbs-up":"[+1]",surprised:":o",tongue:":P",winking:";)"},LOCALE_DEFAULT:"en",LOCALE_AVAILABLE:["af","ar-ae","ar-sa","ar-ye","ar","az","bg","bn","ca","ckb","cs","da","de","el","en","eo","es","et","eu","fa","fi","fo","fr","gu","he","hi","hr","hu","hy","id","is","it","ja","ka","ko","lt","lv","ml","mn","ms","nl-be","nl","no","pl","ps","pt-br","pt","ro","ru","sk","sl","sr-cyrl-cs","sr","sv","ta","th","tr","uk","vi","zh-hk","zh-tw","zh"],LOCALE_WEBSITE:["en","fr","es","pt","de","nl","fi","pl","tr"],FILE_PREVIEW:{IMAGE:["image/jpeg","image/jpg","image/webp","image/png","image/gif"],VIDEO:["video/mp4","video/webm"]},THEME:{DEFAULT_COLOR:"default",AVAILABLE_COLORS:{default:{10:"#F0F2F5",20:"#EFF5FE",100:"#E2EEFF",200:"#66788A",500:"#1972F5",600:"#055EE1",700:"#0057D7",800:"#0051C8",900:"#004AB5",reverse:"#FFFFFF"},red:{10:"#F0F2F5",20:"#F9F3F3",100:"#FFE5E4",200:"#66788A",500:"#E51E0F",600:"#CC1B0E",700:"#C5170A",800:"#B81206",900:"#A71004",reverse:"#FFFFFF"},pink:{10:"#F0F2F5",20:"#F7F2F2",100:"#FFE0EB",200:"#66788A",500:"#F11D64",600:"#DB165A",700:"#CE1454",800:"#C20F4D",900:"#B40A45",reverse:"#FFFFFF"},purple:{10:"#F0F2F5",20:"#F8F3FA",100:"#FADDFF",200:"#66788A",500:"#B520CF",600:"#9B19B2",700:"#9614AE",800:"#8A0DA1",900:"#800896",reverse:"#FFFFFF"},deep_purple:{10:"#F0F2F5",20:"#F6F5FA",100:"#EDE2FF",200:"#66788A",500:"#682AD5",600:"#581FBB",700:"#5019B0",800:"#441599",900:"#3B0F89",reverse:"#FFFFFF"},indigo:{10:"#F0F2F5",20:"#F5F5FB",100:"#DDE2FF",200:"#66788A",500:"#2943D1",600:"#1732C4",700:"#112BB9",800:"#0F249A",900:"#091C87",reverse:"#FFFFFF"},blue:{10:"#F0F2F5",20:"#EFF5FE",100:"#E2EEFF",200:"#66788A",500:"#1972F5",600:"#055EE1",700:"#0057D7",800:"#0051C8",900:"#004AB5",reverse:"#FFFFFF"},light_blue:{10:"#F0F2F5",20:"#EFF5F7",100:"#DCF0F9",200:"#66788A",500:"#009FDF",600:"#008CCB",700:"#0088C5",800:"#007EB7",900:"#0076AB",reverse:"#FFFFFF"},cyan:{10:"#F0F2F5",20:"#F1F7F7",100:"#DBF7F9",200:"#66788A",500:"#01A2B4",600:"#009CAE",700:"#008A9A",800:"#008493",900:"#007B89",reverse:"#FFFFFF"},teal:{10:"#F0F2F5",20:"#E7F4F4",100:"#D6EEE9",200:"#66788A",500:"#00947C",600:"#00816C",700:"#007B66",800:"#00705D",900:"#006655",reverse:"#FFFFFF"},green:{10:"#F0F2F5",20:"#EDF5ED",100:"#D6F3D7",200:"#66788A",500:"#28A52D",600:"#1A941F",700:"#148919",800:"#0F7B13",900:"#0A6C0E",reverse:"#FFFFFF"},light_green:{10:"#F0F2F5",20:"#F0F7F0",100:"#DFF6C6",200:"#66788A",500:"#6EB700",600:"#64A500",700:"#5E9C00",800:"#528800",900:"#487800",reverse:"#FFFFFF"},amber:{10:"#F0F2F5",20:"#F6F4ED",100:"#FFF0C1",200:"#66788A",500:"#E1AE01",600:"#CD9E00",700:"#C49700",800:"#B88E00",900:"#A37E00",reverse:"#FFFFFF"},orange:{10:"#F0F2F5",20:"#F5F5EF",100:"#FFECCF",200:"#66788A",500:"#EC6800",600:"#E16300",700:"#CE5B00",800:"#BE5400",900:"#B54F00",reverse:"#FFFFFF"},deep_orange:{10:"#F0F2F5",20:"#FDF5F5",100:"#FFE8E0",200:"#66788A",500:"#E45300",600:"#CD4A00",700:"#C24702",800:"#B84200",900:"#AC3E00",reverse:"#FFFFFF"},brown:{10:"#F0F2F5",20:"#F7F1EF",100:"#F2EAE7",200:"#66788A",500:"#924B32",600:"#8C462D",700:"#7F3D25",800:"#75361F",900:"#692E19",reverse:"#FFFFFF"},grey:{10:"#F0F2F5",20:"#F4F4F4",100:"#E5E5E5",200:"#66788A",500:"#7A7A7A",600:"#6B6B6B",700:"#646464",800:"#5B5B5B",900:"#505050",reverse:"#FFFFFF"},blue_grey:{10:"#F0F2F5",20:"#F2F7F8",100:"#DCEDF6",200:"#66788A",500:"#447991",600:"#3C7189",700:"#32657C",800:"#2A5A70",900:"#27556A",reverse:"#FFFFFF"},black:{10:"#F0F2F5",20:"#F2F2F2",100:"#E9E9E9",200:"#66788A",500:"#2A2A2A",600:"#313131",700:"#454545",800:"#525252",900:"#5B5B5B",reverse:"#FFFFFF"}}}},Te="development"===Pe.ENVIRONMENT,Le=void 0!==window.console,Ne=Te&&Le,Ve="anonymous";var He=(t,e,i)=>{};const We=new class{constructor(){this.Fe=/^(Error)/,this.ge=/^(\s*at\s+)/,this.ve=/(?:(.+?)(?:\s+\(|@))?(?:(.+?):(\d+):(\d+))/}setLogSink(t){if("function"!=typeof t)throw new Error("Invalid function");He=t}warn(...t){const e=this.we("warn",...t);He("warn",e[0],t)}error(...t){const e=this.we("error",...t);Ne&&console.error(...e),He("error",e[0],t)}info(...t){const e=this.we("info",...t);He("info",e[0],t)}log(...t){const e=this.we("log",...t);He("log",e[0],t)}debug(...t){const e=this.we("debug",...t);He("debug",e[0],t)}be(){try{let t=(new Error).stack;t=t.replace(this.Fe,"").trim();let e=t.split("\n")[3]||"";e=e.replace(this.ge,"").trim();const i=e.match(this.ve);if(i){const[,t=Ve,e="unknown",s="?",n="?"]=i,r=t.split("/")[0]||Ve,o=r.includes(".")?r.split(".")[0]:null;return{function:r,class:o,file:e.split("/").pop(),line:s,column:n}}return{function:"unknown",class:null,file:"unknown",line:"?",column:"?"}}catch{return{function:"unknown",class:null,file:"unknown",line:"?",column:"?"}}}we(t,...e){const i=this.be();let s;s=i.function===Ve?`${i.file}:${i.line}`:i.class?`${i.class}:${i.function}`:`${i.function}`;return[`[${t.toUpperCase()}] [${s}]`,...e]}};const Je=[];class Ge{constructor(){Ze(function(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}(this.reset,this),0)}reset(){}}function Ke(t,e){if("object"!=typeof t||!t)return t;if("object"!=typeof e||!e)return t;for(let i in e)e.hasOwnProperty(i)&&("object"!=typeof e[i]||null===e[i]||Array.isArray(e[i])?t[i]=e[i]:(("object"!=typeof t[i]||null===t[i]||Array.isArray(t[i]))&&(t[i]={}),Ke(t[i],e[i])));return t}function Ye(t,e,i){let s=JSON.parse(JSON.stringify(t)),n=_e(Object.assign(e,t));return Ze(()=>{Ke(n,s)},1),"function"==typeof n.reset&&Ze(n.reset,0),n}function Ze(t,e=0){Je.push({fn:t,priority:e}),Je.sort((t,e)=>e.priority-t.priority)}function Xe(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}var Qe=Object.defineProperty,ti=Object.defineProperties,ei=Object.getOwnPropertyDescriptors,ii=Object.getOwnPropertySymbols,si=Object.prototype.hasOwnProperty,ni=Object.prototype.propertyIsEnumerable,ri=(t,e,i)=>e in t?Qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,oi=(t,e)=>{for(var i in e||(e={}))si.call(e,i)&&ri(t,i,e[i]);if(ii)for(var i of ii(e))ni.call(e,i)&&ri(t,i,e[i]);return t},ui=(t,e)=>ti(t,ei(e)),ai=(t,e,i)=>(ri(t,"symbol"!=typeof e?e+"":e,i),i);let li=!1;const hi=[],ci=Promise.resolve(),di=t=>ci.then(t),Di=t=>{hi.includes(t)||hi.push(t),li||(li=!0,di(fi))},fi=()=>{for(const t of hi)t();hi.length=0,li=!1};setInterval(()=>{fi()},1e3);const pi=Array.isArray,mi=t=>"string"==typeof t,_i=t=>null!==t&&"object"==typeof t,Fi=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},gi=/-(\w)/g,vi=Fi(t=>t.replace(gi,(t,e)=>e?e.toUpperCase():"")),wi=/\B([A-Z])/g,bi=Fi(t=>t.replace(wi,"-$1").toLowerCase());function yi(t){if(pi(t)){const e={};for(let i=0;i<t.length;i++){const s=t[i],n=mi(s)?$i(s):yi(s);if(n)for(const t in n)e[t]=n[t]}return e}if(mi(t)||_i(t))return t}const Ei=/;(?![^(]*\))/g,Ci=/:([^]+)/,ki=/\/\*[^]*?\*\//g;function $i(t){const e={};return t.replace(ki,"").split(Ei).forEach(t=>{if(t){const i=t.split(Ci);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Bi(t){let e="";if(mi(t))e=t;else if(pi(t))for(let i=0;i<t.length;i++){const s=Bi(t[i]);s&&(e+=s+" ")}else if(_i(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const Ai=/^(spellcheck|draggable|form|list|type)$/,xi=({el:t,get:e,effect:i,arg:s,modifiers:n})=>{let r;"class"===s&&(t._class=t.className),i(()=>{let i=e();if(s)(null==n?void 0:n.camel)&&(s=vi(s)),Si(t,s,i,r);else{for(const e in i)Si(t,e,i[e],r&&r[e]);for(const e in r)(!i||!(e in i))&&Si(t,e,null)}r=i})},Si=(t,e,i,s)=>{if("class"===e)t.setAttribute("class",Bi(t._class?[t._class,i]:i)||"");else if("style"===e){i=yi(i);const{style:e}=t;if(i)if(mi(i))i!==s&&(e.cssText=i);else{for(const t in i)Ii(e,t,i[t]);if(s&&!mi(s))for(const t in s)null==i[t]&&Ii(e,t,"")}else t.removeAttribute("style")}else t instanceof SVGElement||!(e in t)||Ai.test(e)?"true-value"===e?t._trueValue=i:"false-value"===e?t._falseValue=i:null!=i?t.setAttribute(e,i):t.removeAttribute(e):(t[e]=i,"value"===e&&(t._value=i))},zi=/\s*!important$/,Ii=(t,e,i)=>{pi(i)?i.forEach(i=>Ii(t,e,i)):e.startsWith("--")?t.setProperty(e,i):zi.test(i)?t.setProperty(bi(e),i.replace(zi,""),"important"):t[e]=i},ji=(t,e)=>{const i=t.getAttribute(e);return null!=i&&t.removeAttribute(e),i},Ri=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Oi=["ctrl","shift","alt","meta"],Mi={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&0!==t.button,middle:t=>"button"in t&&1!==t.button,right:t=>"button"in t&&2!==t.button,exact:(t,e)=>Oi.some(i=>t[`${i}Key`]&&!e[i])},qi=({el:t,get:e,exp:i,arg:s,ctx:n,modifiers:r})=>{if(s){var o=t=>{Ri.test(i)?e(`${i}`)(t):(n.scope.$event=t,e(`${i}`),delete n.scope.$event)};if("vue:mounted"===s)return void di(o);if("vue:unmounted"===s)return()=>o();if(r){"click"===s&&(r.right&&(s="contextmenu"),r.middle&&(s="mouseup"));const t=o;o=e=>{if(!("key"in e)||bi(e.key)in r){for(const t in r){const i=Mi[t];if(i&&i(e,r))return}return t(e)}}}((t,e,i,s)=>{t.addEventListener(e,i,s)})(t,s,o,r)}},Ui=({el:t,get:e,effect:i})=>{i(()=>{t.textContent=Pi(e())})},Pi=t=>null==t?"":_i(t)?JSON.stringify(t,null,2):String(t),Ti={true:!0,false:!1,null:null,undefined:void 0},Li={};"+ - * / % === !== == != < > <= >= && || ! =".split(" ").forEach(function(t){Li[t]=!0});const Ni={n:"\n",f:"\f",r:"\r",t:"\t",i:"\v",o:"'",u:'"'};class Vi{constructor(){}h(t){for(this.text=t,this.index=0,this.l=[];this.text.length>this.index;){var e=this.text.charAt(this.index);if('"'===e||"'"===e)this.p(e);else if(this.v(e)||"."===e&&this.v(this.m()))this.k();else if(this.I(this.A()))this.j();else if("?"===e&&"."===this.m())this.l.push({index:this.index,text:"?.",C:!0}),this.index+=2;else if(this.is(e,"(){}[].,;:?"))this.l.push({index:this.index,text:e}),this.index++;else if(this.S(e))this.index++;else{var i=e+this.m(),s=i+this.m(2),n=Li[i],r=Li[s];if(Li[e]||n||r){var o=r?s:n?i:e;this.l.push({index:this.index,text:o,operator:!0}),this.index+=o.length}else this.$("Unexpected next character ",this.index,this.index+1)}}return this.l}is(t,e){return-1!==e.indexOf(t)}m(t){var e=t||1;return this.text.length>this.index+e&&this.text.charAt(this.index+e)}v(t){return t>="0"&&"9">=t&&"string"==typeof t}S(t){return" "===t||"\r"===t||"\t"===t||"\n"===t||"\v"===t||"Â "===t}I(t){return this.U(t)}U(t){return t>="a"&&"z">=t||t>="A"&&"Z">=t||"_"===t||"$"===t}M(t){return this.T(t)}T(t,e){return this.U(t,e)||this.v(t)}codePointAt(t){return 1===t.length?t.charCodeAt(0):(t.charCodeAt(0)<<10)+t.charCodeAt(1)-56613888}A(){var t=this.text.charAt(this.index),e=this.m();if(!e)return t;var i=t.charCodeAt(0),s=e.charCodeAt(0);return 55296>i||i>56319||56320>s||s>57343?t:t+e}L(t){return"-"===t||"+"===t||this.v(t)}$(t,e,i){i=i||this.index;var s=void 0!==e?"s "+e+"-"+this.index+" ["+this.text.substring(e,i)+"]":" "+i;throw Error("Lexer Error: "+t+" at column"+s+" in expression ["+this.text+"].")}k(){for(var t="",e=this.index;this.text.length>this.index;){var i=this.text.charAt(this.index).toLowerCase();if("."===i||this.v(i))t+=i;else{var s=this.m();if("e"===i&&this.L(s))t+=i;else if(this.L(i)&&s&&this.v(s)&&"e"===t.charAt(t.length-1))t+=i;else{if(!this.L(i)||s&&this.v(s)||"e"!==t.charAt(t.length-1))break;this.$("Invalid exponent")}}this.index++}this.l.push({index:e,text:t,N:!0,value:+t})}j(){var t=this.index;for(this.index+=this.A().length;this.text.length>this.index;){var e=this.A();if(!this.M(e))break;this.index+=e.length}this.l.push({index:t,text:this.text.slice(t,this.index),identifier:!0})}p(t){var e=this.index;this.index++;for(var i="",s=t,n=!1;this.text.length>this.index;){var r=this.text.charAt(this.index);if(s+=r,n){if("u"===r){var o=this.text.substring(this.index+1,this.index+5);o.match(/[\da-f]{4}/i)||this.$("Invalid unicode escape [\\u"+o+"]"),this.index+=4,i+=String.fromCharCode(parseInt(o,16))}else i+=Ni[r]||r;n=!1}else if("\\"===r)n=!0;else{if(r===t)return this.index++,void this.l.push({index:e,text:s,N:!0,value:i});i+=r}this.index++}this.$("Unterminated quote",e)}}function Hi(t){return t.type===Ji.O||t.type===Ji.P}const Wi=class{constructor(t,e){ai(this,"wt",{$t:{type:Wi.X},Ut:{type:Wi.Y}}),this.q=t,this.options=e}et(t){this.text=t,this.l=this.q.h(t);const e=this.it();return 0!==this.l.length&&this.$("is an unexpected token",this.l[0]),e}it(){const t=[];for(;;)if(this.l.length>0&&!this.m("}",")",";","]")&&t.push(this.rt()),!this.nt(";"))return{type:Wi.V,body:t}}rt(){return{type:Wi.B,st:this.st()}}st(){return this.ot()}ot(){const t=this.ut();if(this.nt("=")){if(!Hi(t))throw Error("Trying to assign a value to a non l-value");return{type:Wi.D,left:t,right:this.ot(),operator:"="}}return t}ut(){const t=this.ht();let e,i;return this.nt("?")&&(e=this.st(),this.ct(":"))?(i=this.st(),{type:Wi.R,test:t,alternate:e,lt:i}):t}ht(){let t=this.ft();for(;this.nt("||");)t={type:Wi.G,operator:"||",left:t,right:this.ft()};return t}ft(){let t=this.vt();for(;this.nt("&&");)t={type:Wi.G,operator:"&&",left:t,right:this.vt()};return t}vt(){let t,e=this.dt();for(;t=this.nt("==","!=","===","!==");)e={type:Wi.W,operator:t.text,left:e,right:this.dt()};return e}dt(){let t,e=this.yt();for(;t=this.nt("<",">","<=",">=");)e={type:Wi.W,operator:t.text,left:e,right:this.yt()};return e}yt(){let t,e=this.xt();for(;t=this.nt("+","-");)e={type:Wi.W,operator:t.text,left:e,right:this.xt()};return e}xt(){let t,e=this.bt();for(;t=this.nt("*","/","%");)e={type:Wi.W,operator:t.text,left:e,right:this.bt()};return e}bt(){let t;return(t=this.nt("+","-","!"))?{type:Wi.Z,operator:t.text,prefix:!0,kt:this.bt()}:this.gt()}gt(){let t,e;for(this.nt("(")?(t=this.st(),this.ct(")")):this.nt("[")?t=this.Et():this.nt("{")?t=this.object():this.wt.hasOwnProperty(this.m().text)?t=Object.assign({},this.wt[this.ct().text]):Ti.hasOwnProperty(this.m().text)?t={type:Wi.F,value:Ti[this.ct().text]}:this.m().identifier?t=this.identifier():this.m().N?t=this.N():this.$("not a primary expression",this.m());e=this.nt("(","[",".","?.");)"("===e.text?(t={type:Wi._,It:t,arguments:this.At()},this.ct(")")):"["===e.text?(t={type:Wi.P,object:t,jt:this.st(),computed:!0},this.ct("]")):"."===e.text?t={type:Wi.P,object:t,jt:this.identifier(),computed:!1}:"?."===e.text&&(this.m("[")?(this.ct("["),t={type:Wi.P,object:t,jt:this.st(),computed:!0,optional:!0},this.ct("]")):t={type:Wi.P,object:t,jt:this.identifier(),computed:!1,optional:!0});return t}At(){const t=[];if(")"!==this.Ct().text)do{t.push(this.st())}while(this.nt(","));return t}identifier(){const t=this.ct();return t.identifier||this.$("is not a valid identifier",t),{type:Wi.O,name:t.text}}N(){return{type:Wi.F,value:this.ct().value}}Et(){const t=[];if("]"!==this.Ct().text)do{if(this.m("]"))break;t.push(this.st())}while(this.nt(","));return this.ct("]"),{type:Wi.H,elements:t}}object(){const t=[];let e;if("}"!==this.Ct().text)do{if(this.m("}"))break;e={type:Wi.J,kind:"init"},this.m().N?(e.key=this.N(),e.computed=!1,this.ct(":"),e.value=this.st()):this.m().identifier?(e.key=this.identifier(),e.computed=!1,this.m(":")?(this.ct(":"),e.value=this.st()):e.value=e.key):this.m("[")?(this.ct("["),e.key=this.st(),this.ct("]"),e.computed=!0,this.ct(":"),e.value=this.st()):this.$("invalid key",this.m()),t.push(e)}while(this.nt(","));return this.ct("}"),{type:Wi.K,properties:t}}$(t,e){throw Error(`Syntax Error: Token '${e.text}' ${t} at column ${e.index+1} of the expression [${this.text}] starting at [${this.text.substring(e.index)}].`)}ct(t){if(0===this.l.length)throw Error("Unexpected end of expression: "+this.text);const e=this.nt(t);return e||this.$("is unexpected, expecting ["+t+"]",this.m()),e}Ct(){if(0===this.l.length)throw Error("Unexpected end of expression: "+this.text);return this.l[0]}m(t,e,i,s){return this.St(0,t,e,i,s)}St(t,e,i,s,n){if(this.l.length>t){const r=this.l[t],o=r.text;if(o===e||o===i||o===s||o===n||!e&&!i&&!s&&!n)return r}return!1}nt(t,e,i,s){const n=this.m(t,e,i,s);return!!n&&(this.l.shift(),n)}};let Ji=Wi;function Gi(t,e){let i,s;const n=t.Mt=function(t,e){switch(t.type){case"MemberExpression":if(t.computed)return!1;break;case"UnaryExpression":return 1;case"BinaryExpression":return"+"!==t.operator&&1;case"CallExpression":return!1}return void 0===e?2:e}(t,e);switch(t.type){case Ji.V:i=!0,t.body.forEach(function(t){Gi(t.st,n),i=i&&t.st.N}),t.N=i;break;case Ji.F:t.N=!0,t.Tt=[];break;case Ji.Z:Gi(t.kt,n),t.N=t.kt.N,t.Tt=t.kt.Tt;break;case Ji.W:Gi(t.left,n),Gi(t.right,n),t.N=t.left.N&&t.right.N,t.Tt=t.left.Tt.concat(t.right.Tt);break;case Ji.G:Gi(t.left,n),Gi(t.right,n),t.N=t.left.N&&t.right.N,t.Tt=t.N?[]:[t];break;case Ji.R:Gi(t.test,n),Gi(t.alternate,n),Gi(t.lt,n),t.N=t.test.N&&t.alternate.N&&t.lt.N,t.Tt=t.N?[]:[t];break;case Ji.O:t.N=!1,t.Tt=[t];break;case Ji.P:Gi(t.object,n),t.computed&&Gi(t.jt,n),t.N=t.object.N&&(!t.computed||t.jt.N),t.Tt=t.N?[]:[t];break;case Ji._:i=!1,s=[],t.arguments.forEach(function(t){Gi(t,n),i=i&&t.N,s.push.apply(s,t.Tt)}),t.N=i,t.Tt=[t];break;case Ji.D:Gi(t.left,n),Gi(t.right,n),t.N=t.left.N&&t.right.N,t.Tt=[t];break;case Ji.H:i=!0,s=[],t.elements.forEach(function(t){Gi(t,n),i=i&&t.N,s.push.apply(s,t.Tt)}),t.N=i,t.Tt=s;break;case Ji.K:i=!0,s=[],t.properties.forEach(function(t){Gi(t.value,n),i=i&&t.value.N,s.push.apply(s,t.value.Tt),t.computed&&(Gi(t.key,!1),i=i&&t.key.N,s.push.apply(s,t.key.Tt))}),t.N=i,t.Tt=s;break;case Ji.X:case Ji.Y:t.N=!1,t.Tt=[]}}ai(Ji,"V",1),ai(Ji,"B",2),ai(Ji,"D",3),ai(Ji,"R",4),ai(Ji,"G",5),ai(Ji,"W",6),ai(Ji,"Z",7),ai(Ji,"_",8),ai(Ji,"P",9),ai(Ji,"O",10),ai(Ji,"F",11),ai(Ji,"H",12),ai(Ji,"J",13),ai(Ji,"K",14),ai(Ji,"X",15),ai(Ji,"Y",16),ai(Ji,"tt",17);let Ki=class{compile(t){const e=this;let i,s;Gi(t),(i=function(t){if(1===t.body.length&&Hi(t.body[0].st))return{type:Ji.D,left:t.body[0].st,right:{type:Ji.tt},operator:"="}}(t))&&(s=this.Lt(i));const n=function(t){if(1!==t.length)return;const e=t[0].st,i=e.Tt;return 1!==i.length||i[0]!==e?i:void 0}(t.body);let r;n&&(r=[],n.forEach(function(t,i){const s=e.Lt(t);s.Mt=t.Mt,t.input=s,r.push(s),t.Nt=i}));const o=[];t.body.forEach(function(t){o.push(e.Lt(t.st))});const u=0===t.body.length?noop:1===t.body.length?o[0]:function(t,e){let i;return o.forEach(function(s){i=s(t,e)}),i};return s&&(u.assign=function(t,e,i){return s(t,i,e)}),r&&(u.inputs=r),u}Lt(t,e,i){let s,n,r,o=this;if(t.input)return this.inputs(t.input,t.Nt);switch(t.type){case Ji.F:return this.value(t.value,e);case Ji.Z:return n=this.Lt(t.kt),this["unary"+t.operator](n,e);case Ji.W:case Ji.G:return s=this.Lt(t.left),n=this.Lt(t.right),this["binary"+t.operator](s,n,e);case Ji.R:return this["ternary?:"](this.Lt(t.test),this.Lt(t.alternate),this.Lt(t.lt),e);case Ji.O:return o.identifier(t.name,e,i);case Ji.P:return s=this.Lt(t.object,!1,!!i),t.computed||(n=t.jt.name),t.computed&&(n=this.Lt(t.jt)),t.computed?this.Ot(s,n,e,i,t.optional):this.Pt(s,n,e,i,t.optional);case Ji._:return r=[],t.arguments.forEach(function(t){r.push(o.Lt(t))}),n=this.Lt(t.It,!0),function(t,i,s,o){const u=n(t,i,s,o);let a;if(null!=u.value){const e=[];for(let n=0;r.length>n;++n)e.push(r[n](t,i,s,o));a=u.value.apply(u.context,e)}return e?{value:a}:a};case Ji.D:return s=this.Lt(t.left,!0,1),n=this.Lt(t.right),function(t,i,r,o){const u=s(t,i,r,o),a=n(t,i,r,o);return u.context[u.name]=a,e?{value:a}:a};case Ji.H:return r=[],t.elements.forEach(function(t){r.push(o.Lt(t))}),function(t,i,s,n){const o=[];for(let e=0;r.length>e;++e)o.push(r[e](t,i,s,n));return e?{value:o}:o};case Ji.K:return r=[],t.properties.forEach(function(t){r.push(t.computed?{key:o.Lt(t.key),computed:!0,value:o.Lt(t.value)}:{key:t.key.type===Ji.O?t.key.name:""+t.key.value,computed:!1,value:o.Lt(t.value)})}),function(t,i,s,n){const o={};for(let e=0;r.length>e;++e)r[e].computed?o[r[e].key(t,i,s,n)]=r[e].value(t,i,s,n):o[r[e].key]=r[e].value(t,i,s,n);return e?{value:o}:o};case Ji.X:return function(t){return e?{value:t}:t};case Ji.Y:return function(t,i){return e?{value:i}:i};case Ji.tt:return function(t,i,s){return e?{value:s}:s}}}"unary+"(t,e){return function(i,s,n,r){let o=t(i,s,n,r);return o=void 0!==o?+o:0,e?{value:o}:o}}"unary-"(t,e){return function(i,s,n,r){let o=t(i,s,n,r);return o=void 0!==o?-o:-0,e?{value:o}:o}}"unary!"(t,e){return function(i,s,n,r){const o=!t(i,s,n,r);return e?{value:o}:o}}"binary+"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o),a=(h=e(s,n,r,o),void 0===(l=u)?h:void 0===h?l:l+h);var l,h;return i?{value:a}:a}}"binary-"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o),a=e(s,n,r,o),l=(void 0!==u?u:0)-(void 0!==a?a:0);return i?{value:l}:l}}"binary*"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)*e(s,n,r,o);return i?{value:u}:u}}"binary/"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)/e(s,n,r,o);return i?{value:u}:u}}"binary%"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)%e(s,n,r,o);return i?{value:u}:u}}"binary==="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)===e(s,n,r,o);return i?{value:u}:u}}"binary!=="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)!==e(s,n,r,o);return i?{value:u}:u}}"binary=="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)==e(s,n,r,o);return i?{value:u}:u}}"binary!="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)!=e(s,n,r,o);return i?{value:u}:u}}"binary<"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)<e(s,n,r,o);return i?{value:u}:u}}"binary>"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)>e(s,n,r,o);return i?{value:u}:u}}"binary<="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)<=e(s,n,r,o);return i?{value:u}:u}}"binary>="(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)>=e(s,n,r,o);return i?{value:u}:u}}"binary&&"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)&&e(s,n,r,o);return i?{value:u}:u}}"binary||"(t,e,i){return function(s,n,r,o){const u=t(s,n,r,o)||e(s,n,r,o);return i?{value:u}:u}}"ternary?:"(t,e,i,s){return function(n,r,o,u){const a=t(n,r,o,u)?e(n,r,o,u):i(n,r,o,u);return s?{value:a}:a}}value(t,e){return function(){return e?{context:void 0,name:void 0,value:t}:t}}identifier(t,e,i){return function(s,n,r,o){const u=n&&t in n?n:s;i&&1!==i&&u&&null==u[t]&&(u[t]={});const a=u?u[t]:void 0;return e?{context:u,name:t,value:a}:a}}Ot(t,e,i,s,n){return function(r,o,u,a){const l=t(r,o,u,a);let h,c;return n&&null==l?c=void 0:null!=l&&(h=e(r,o,u,a),h+="",s&&1!==s&&l&&!l[h]&&(l[h]={}),c=l[h]),i?{context:l,name:h,value:c}:c}}Pt(t,e,i,s,n){return function(r,o,u,a){const l=t(r,o,u,a);let h;return n&&null==l?h=void 0:(s&&1!==s&&l&&null==l[e]&&(l[e]={}),h=null!=l?l[e]:void 0),i?{context:l,name:e,value:h}:h}}inputs(t,e){return function(i,s,n,r){return r?r[e]:t(i,s,n)}}},Yi=class{constructor(t,e){this.et=new Ji(t,e),this.qt=new Ki}parse(t){const e=this.Vt(t),i=this.qt.compile(e.et);return i.Bt=0===(s=e.et).body.length||1===s.body.length&&(s.body[0].st.type===Ji.F||s.body[0].st.type===Ji.H||s.body[0].st.type===Ji.K),i.N=function(t){return t.N}(e.et),i.Dt=e.Dt,i;var s}Vt(t){let e=!1;return":"===(t=t.trim()).charAt(0)&&":"===t.charAt(1)&&(e=!0,t=t.substring(2)),{et:this.et.et(t),Dt:e}}};const Zi=new function(t={}){const e=new Vi,i=new Yi(e,t);function s(t){return i.parse(t)}return s.parse=function(t){return i.parse(t)},s},Xi=(t,e,i)=>Qi(t,e),Qi=(t,e,i)=>{try{return Zi(e)(t)}catch(s){console.error(s)}},ts={bind:xi,on:qi,show:({el:t,get:e,effect:i})=>{const s=t.style.display;i(()=>{t.style.display=e()?s:"none"})},text:Ui,html:({el:t,get:e,effect:i})=>{i(()=>{t.innerHTML=e()})},effect:({el:t,ctx:e,exp:i,effect:s})=>{di(()=>s(()=>Qi(e.scope,i)))}},es=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,is=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,ss=/^\(|\)$/g,ns=/^[{[]\s*((?:[\w_$]+\s*,?\s*)+)[\]}]$/,rs=(t,e,i)=>{const s=e.match(es);if(!s)return;const n=t.nextSibling,r=t.parentElement,o=new Text("");r.insertBefore(o,t),r.removeChild(t);const u=s[2].trim();let a,l,h,c,d=s[1].trim().replace(ss,"").trim(),D=!1,f="key",p=t.getAttribute(f)||t.getAttribute(f=":key")||t.getAttribute(f="v-bind:key");p&&(t.removeAttribute(f),"key"===f&&(p=JSON.stringify(p))),(c=d.match(is))&&(d=d.replace(is,"").trim(),l=c[1].trim(),c[2]&&(h=c[2].trim())),(c=d.match(ns))&&(a=c[1].split(",").map(t=>t.trim()),D="["===d[0]);let m,F,g,v=!1;const w=(t,e,s,n)=>{const r={};a?a.forEach((t,i)=>r[t]=e[D?i:t]):r[d]=e,n?(l&&(r[l]=n),h&&(r[h]=s)):l&&(r[l]=s);const o=ms(i,r),u=p?Xi(o.scope,p):s;return t.set(u,s),o.key=u,o},b=(e,i)=>{const s=new Fs(t,e);return s.key=e.key,s.insert(r,i),s};return i.effect(()=>{const t=Xi(i.scope,u),e=g;if([F,g]=(t=>{const e=new Map,i=[];if(pi(t))for(let s=0;s<t.length;s++)i.push(w(e,t[s],s));else if("number"==typeof t)for(let s=0;s<t;s++)i.push(w(e,s+1,s));else if(_i(t)){let s=0;for(const n in t)i.push(w(e,t[n],s++,n))}return[i,e]})(t),v){for(let e=0;e<m.length;e++)g.has(m[e].key)||m[e].remove();const t=[];let i,s,n=F.length;for(;n--;){const u=F[n],a=e.get(u.key);let l;null==a?l=b(u,i?i.el:o):(l=m[a],Object.assign(l.ctx.scope,u.scope),a!==n&&(m[a+1]!==i||s===i)&&(s=l,l.insert(r,i?i.el:o))),t.unshift(i=l)}m=t}else m=F.map(t=>b(t,o)),v=!0}),n},os=({el:t,ctx:{scope:{$refs:e}},get:i,effect:s})=>{let n;return s(()=>{const s=i();e[s]=t,n&&s!==n&&delete e[n],n=s}),()=>{n&&delete e[n]}},us=/^(?:v-|:|@)/,as=/\.([\w-]+)/g;let ls=!1;const hs=(t,e)=>{const i=t.nodeType;if(1===i){const i=t;if(i.hasAttribute("v-pre"))return;let s;if(ji(i,"v-cloak"),s=ji(i,"v-if"))return((t,e,i)=>{const s=t.parentElement,n=new Comment("v-if");s.insertBefore(n,t);const r=[{exp:e,el:t}];let o,u;for(;(o=t.nextElementSibling)&&(u=null,""===ji(o,"v-else")||(u=ji(o,"v-else-if")));)s.removeChild(o),r.push({exp:u,el:o});const a=t.nextSibling;s.removeChild(t);let l,h=-1;const c=()=>{l&&(s.insertBefore(n,l.el),l.remove(),l=void 0)};return i.effect(()=>{for(let t=0;t<r.length;t++){const{exp:e,el:o}=r[t];if(!e||Xi(i.scope,e))return void(t!==h&&(c(),l=new Fs(o,i),l.insert(s,n),s.removeChild(n),h=t))}h=-1,c()}),a})(i,s,e);if(s=ji(i,"v-for"))return rs(i,s,e);if((s=ji(i,"v-scope"))||""===s){const t=s?Xi(e.scope,s):{};e=ms(e,t),t.$template&&fs(i,t.$template)}const n=null!=ji(i,"v-once");n&&(ls=!0),(s=ji(i,"ref"))&&Ds(i,os,`"${s}"`,e),cs(i,e);const r=[];for(const{name:t,value:o}of[...i.attributes])us.test(t)&&"v-cloak"!==t&&("v-model"===t?r.unshift([t,o]):"@"===t[0]||/^v-on\b/.test(t)?r.push([t,o]):ds(i,t,o,e));for(const[t,o]of r)ds(i,t,o,e);n&&(ls=!1)}else if(3===i){const i=t.data;if(i.includes(e.delimiters[0])){let s,n=[],r=0;for(;s=e.delimitersRE.exec(i);){const t=i.slice(r,s.index);t&&n.push(JSON.stringify(t)),n.push(`$s(${s[1]})`),r=s.index+s[0].length}r<i.length&&n.push(JSON.stringify(i.slice(r))),Ds(t,Ui,n.join("+"),e)}}else 11===i&&cs(t,e)},cs=(t,e)=>{let i=t.firstChild;for(;i;)i=hs(i,e)||i.nextSibling},ds=(t,e,i,s)=>{let n,r,o,u=e.replace(as,(t,e)=>((o||(o={}))[e]=!0,""));if(":"===u[0])n=xi,r=u.slice(1);else if("@"===u[0])n=qi,r=u.slice(1);else{const t=u.indexOf(":"),e=t>0?u.slice(2,t):u.slice(2);n=ts[e]||s.dirs[e],r=t>0?u.slice(t+1):void 0}n&&(n===xi&&"ref"===r&&(n=os),Ds(t,n,i,s,r,o),t.removeAttribute(e))},Ds=(t,e,i,s,n,r)=>{const o=e({el:t,get:(t=i)=>Xi(s.scope,t),effect:s.effect,ctx:s,exp:i,arg:n,modifiers:r});o&&s.cleanups.push(o)},fs=(t,e)=>{if("#"===e[0]){const i=document.querySelector(e);return void t.appendChild(i.content.cloneNode(!0))}t.innerHTML=e},ps=(t,e)=>{const i=ui(oi({delimiters:["{{","}}"],delimitersRE:/\{\{([^]+?)\}\}/g},e),{scope:e?e.scope:t.reactive({}),dirs:e?e.dirs:{},effects:[],blocks:[],cleanups:[],effect:e=>{if(ls)return Di(e),e;const s=t.effect(e,{scheduler:()=>Di(s)});return i.effects.push(s),s},remove:t.remove,stop:t.stop,reactive:t.reactive});return i},ms=(t,e={})=>{const i=t.scope,s=Object.create(i);Object.defineProperties(s,Object.getOwnPropertyDescriptors(e)),s.$refs=Object.create(i.$refs);const n=t.reactive(new Proxy(s,{set:(t,e,s,r)=>r!==n||Object.prototype.hasOwnProperty.call(t,e)?Reflect.set(t,e,s,r):Reflect.set(i,e,s)}));return _s(n),ui(oi({},t),{scope:n,remove:t.remove,stop:t.stop,reactive:t.reactive})},_s=t=>{for(const e of Object.keys(t))"function"==typeof t[e]&&(t[e]=Xe(t[e],t))};let Fs=class{constructor(t,e,i=!1){ai(this,"template"),ai(this,"ctx"),ai(this,"key"),ai(this,"parentCtx"),ai(this,"isFragment"),ai(this,"start"),ai(this,"end"),this.isFragment=t instanceof HTMLTemplateElement,i?this.template=t:this.isFragment?this.template=t.content.cloneNode(!0):this.template=t.cloneNode(!0),i?this.ctx=e:(this.parentCtx=e,e.blocks.push(this),this.ctx=ps({reactive:e.reactive,effect:e.effect,remove:e.remove,stop:e.stop},e)),hs(this.template,this.ctx)}get el(){return this.start||this.template}insert(t,e=null){if(this.isFragment)if(this.start){let i,s=this.start;for(;s&&(i=s.nextSibling,t.insertBefore(s,e),s!==this.end);)s=i}else this.start=new Text(""),this.end=new Text(""),t.insertBefore(this.end,e),t.insertBefore(this.start,this.end),t.insertBefore(this.template,this.end);else t.insertBefore(this.template,e)}remove(){if(this.parentCtx&&this.parentCtx.remove(this.parentCtx.blocks,this),this.start){const t=this.start.parentNode;let e,i=this.start;for(;i&&(e=i.nextSibling,t.removeChild(i),i!==this.end);)i=e}else this.template.parentNode.removeChild(this.template);this.teardown()}teardown(){this.ctx.blocks.forEach(t=>{t.teardown()}),this.ctx.effects.forEach(this.ctx.stop),this.ctx.cleanups.forEach(t=>t())}};const gs=t=>t.replace(/[-.*+?^${}()|[\]\/\\]/g,"\\$&"),vs=(t,e)=>{const i=ps(t);if(e&&(i.scope=t.reactive(e),_s(i.scope),e.$delimiters)){const[t,s]=i.delimiters=e.$delimiters;i.delimitersRE=new RegExp(gs(t)+"([^]+?)"+gs(s),"g")}let s;return i.scope.$s=Pi,i.scope.$nextTick=di,i.scope.$refs=Object.create(null),{directive(t,e){return e?(i.dirs[t]=e,this):i.dirs[t]},mount(t){if("string"==typeof t&&!(t=document.querySelector(t)))return;let e;return e=(t=t||document.documentElement).hasAttribute("v-scope")?[t]:[...t.querySelectorAll("[v-scope]")].filter(t=>!t.matches("[v-scope] [v-scope]")),e.length||(e=[t]),s=e.map(t=>new Fs(t,i,!0)),this},unmount(){s.forEach(t=>t.teardown())}}};const ws=Ye({users_available:!1,last_available:0,was_availability_online:!1,availability:"away"},{receive(t=!1,i=!1){if(ws.users_available=t,!0===i){let t=(new Date).getTime();ws.last_available=t}e().Action.event("website:availability:changed",ws.users_available)},apply(){let t=!0===ws.users_available?"online":"away";Xo.availability.availability=t,!1===ws.was_availability_online&&"online"===t&&(ws.was_availability_online=!0)}});function bs(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}let ys=class{constructor(t){this.parent=t,this.smiley_map={angry:":@",blushing:":$",confused:"x)",cool:"8)",crying:":'(",embarrassed:":/",heart:"<3",laughing:":'D",sad:":(",sick:":S","small-smile":":)","big-smile":":D","thumbs-up":"[+1]",surprised:":o",tongue:":P",winking:";)"},this.ye={angry:"((?:=|:)(?:-)?@)",blushing:"((?:=|:)(?:-)?\\$)",cool:"(8(?:-)?\\))",confused:"(x(?:-)?\\))",crying:"((?:=|:)'(?:-)?\\()",embarrassed:"((?:=|:)(?:-)?\\/)",heart:"(&lt;3)",laughing:"((?:=|:)(?:-)?'D)",sad:"((?:=|:)(?:-)?(?:\\(|\\|))",sick:"((?:=|:)(?:-)?S)","small-smile":"((?:=|:)(?:-)?\\))","big-smile":"((?:=|:)(?:-)?D)","thumbs-up":"(\\[\\+1\\])",surprised:"((?:=|:)(?:-)?o)",tongue:"((?:=|:)(?:-)?P)",winking:"(;(?:-)?\\))"},this.Ee()}code(t,e="small"){return this.parent.template.render("smiley",{name:t,size:e})}parse(t){let e,i,s,n,r,o=t;for(e in this.Ce)if(this.Ce.hasOwnProperty(e))for(i=this.Ce[e];null!==(r=o.match(i));)s="small",o===r[2]&&(s="large"),n=this.code(e,s),o=o.replace(i,`$1${n}$3`);return o}count(t){let e,i,s=0,n=t;for(e in this.Ce)if(this.Ce.hasOwnProperty(e))for(i=this.Ce[e];!0===i.test(n);)s++,n=n.replace(i,"$1[]$3");return s}name(t){let e,i,s=null;for(e in this.Ce)if(this.Ce.hasOwnProperty(e)&&(i=this.Ce[e],t.match(i))){s=e;break}return s}Ee(){let t;for(t in this.Ce={},this.ye)this.Ce[t]=new RegExp(`(^|\\s|\\()${this.ye[t]}($|\\s|\\))`,"i")}},Es=class{constructor(t){this.parent=t,this.ke=/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED8\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDD1D\uDEEF]\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE]|[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE]|\uDEEF\u200D\uD83D\uDC69\uD83C[\uDFFB-\uDFFE])))?))?|\uDD75(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE8A\uDE8E-\uDEC2\uDEC6\uDEC8\uDECD-\uDEDC\uDEDF-\uDEEA\uDEEF]|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC30\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE])|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3\uDE70]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF]|\uDEEF\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g}code(t,e="small"){return this.parent.template.render("emoji",{name:t,size:e})}count(t){let e=t.match(this.ke);return e?e.length:0}parse(t){let e=this.$e(t)?"large":"small";return t.replace(this.ke,t=>this.code(t,e))}$e(t){let e=this.count(t);return!(e<1||e>3)&&""===t.replace(this.ke,"").trim()}};var Cs,ks;var $s,Bs=($s=ks?Cs:(ks=1,Cs=["com","net","org","info","biz","mobi","chat","email","help","watch","name","pro","aero","asia","cat","coop","edu","gov","int","jobs","mil","museum","post","tel","travel","xxx","xyz","top","site","online","club","shop","work","app","live","store","space","website","tech","life","dev","blog","cloud","page","link","design","group","company","agency","network","media","immo","ac","ad","ae","af","ag","ai","al","am","an","ao","aq","ar","as","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","bj","bl","bm","bn","bo","bq","br","bs","bt","bv","bw","by","bz","ca","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","ee","eg","eh","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","io","iq","ir","is","it","je","jm","jo","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mf","mg","mh","mk","ml","mm","mn","mo","mp","mq","mr","ms","mt","mu","mv","mw","mx","my","mz","na","nc","ne","nf","ng","ni","nl","no","np","nr","nu","nz","om","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","tt","tv","tw","tz","ua","ug","uk","um","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","ye","yt","za","zm","zw"]))&&$s.Be&&Object.prototype.hasOwnProperty.call($s,"default")?$s.default:$s;let As=class{constructor(t){this.parent=t,this.Ae=Bs,this.xe={"&":/&amp;/g,"<":/&lt;/g,">":/&gt;/g,'"':/&quot;/g},this.Se={"&amp;":/&/g,"&lt;":/</g,"&gt;":/>/g,"&quot;":/"/g},this.ze=/&#(\d+);|&#x([0-9A-Fa-f]+);/g,this.Ie={"\\\\":/\\/g,"\\t":/\t/g,"\\n":/\n/g,"\\u00A0":/\u00A0/g,"&quot;":/"/g,"&apos;":/'/g,"&lowbar;":/_/g,"&ast;":/\*/g,"&plus;":/\+/g,"&#126;":/~/g},this.je={"<":/&lt;/g,">":/&gt;/g},this.Re=/[-\/\\^$*+?.()|[\]{}]/g,this.Oe=/([\#$\*\_\-+![\]\(\)`~><\.|{}])/g,this.Me=/\n(\s+)?\n(\s+)?\n/g,this.qe=/\n/g,this.Ue=/^([a-z]{1,20})\n((?:\n?.*)*)$/,this.Pe=new RegExp("^(.+?)(?:\\s+=(?:(\\d+|auto)(?:x(\\d+|auto))?)?)?$"),this.Te=/(,|\.)(\s|$)/g,this.Le=/\u0001/g,this.Ne=/^(www\.)/i,this.Ve={links:{prefix:"(\\s|<[^<>]+\\/>|<[^a][^<>]*>|\\(|^)",suffix:"(\\s||<[^<>]+\\/>|</[^a][^<>]*>|\\)|$)"},markdown_simple:{prefix:"(^)",suffix:"($)"},markdown_includes:{prefix:"(\\s|<[^<>]+\\/>|<[^<>]+>|\\(|^)",suffix:"(\\s|.|,|:|<[^<>]+\\/>|\\)|$)"},markdown_formatting:{prefix:"(\\s|<[^<>]+\\/>|\\(|^)",suffix:""},markdown_list:{prefix:"(^\\s*)",suffix:"(.*?)($)"}},this.He=["title","list","code_inline","blockquote","table","emphasis"],this.We=["code_block","code_inline"],this.Je=["decode_html_entities","escape","consecutive_lines","markdown","links_uri","links_domain","emails","phones","smileys","emojis","new_lines"],this.Ge={escape:this.Ke,decode_html_entities:this.Ye,consecutive_lines:this.Ze,new_lines:this.Xe,emails:this.Qe,phones:this.tn,markdown:this.en,links_domain:this.sn,links_uri:this.nn,smileys:this.rn,emojis:this.un},this.an={markdown_link_image:this.ln,markdown_image:this.hn,markdown_code_block:this.cn,markdown_table:this.dn},this.Dn(),this.pn()}format(t,e={},i=[]){let s,n,r=t;for(s=0;s<this.Je.length;s++)n=this.Je[s],-1===i.indexOf(n)&&(r=bs(this.Ge[n],this)(r,e));return r}replace(t,e=[]){let i,s,n=t;for(i=0;i<e.length;i++)s=i+1,n=n.replace(`%${s}s`,e[i]);return n}attribute(t){return this.Ke(t,{},this.Ie)}html(t,e=!1){return this.Ke(t,{},!0===e?this.xe:this.Se)}escape_regex(t){return t.replace(this.Re,"\\$&")}Ke(t,e={},i=null){let s,n,r=t,o=i||this.Se;for(n in o)o.hasOwnProperty(n)&&(s=o[n],r=r.replace(s,n));return r}Ye(t,e={}){return t.replace(this.ze,(t,e,i)=>{let s=e?parseInt(e,10):parseInt(i,16);return String.fromCharCode(s)})}Ze(t,e={}){return t.replace(this.Me,"\n\n")}Xe(t,e={}){let i=this.parent.template.render("new_line",{},e);return t.trim().replace(this.qe,i)}Qe(t,e={}){return this.mn(t,this.Fn.email,(t,i,s,n)=>`${i}${this.parent.template.render("link_email",{email:s,no_external_link:this.parent.config.runtime.no_external_link||!1},e)}${n}`)}tn(t,e={}){return this.mn(t,this.Fn.phone,(t,i,s,n)=>`${i}${this.parent.template.render("link_phone",{phone:s,no_external_link:this.parent.config.runtime.no_external_link||!1},e)}${n}`)}en(t,e={}){t=`\n${t}\n`;for(let i=0;i<this.gn.length;i++)t=t.replace(this.gn[i][1],this.vn(this.gn[i],e));return t.trim()}sn(t,e={}){return this.mn(t,this.Fn.domain,(t,i,s,n)=>`${i}${this.parent.template.render("link_domain",{domain_value:s,domain_name:s,no_external_link:this.parent.config.runtime.no_external_link||!1},e)}${n}`)}nn(t,e={}){return this.mn(t,this.Fn.uri,(t,i,s,n)=>{let r=!0===this.Ne.test(s)?`http://${s}`:s;return`${i}${this.parent.template.render("link_uri",{uri_value:r,uri_name:s,no_external_link:this.parent.config.runtime.no_external_link||!1},e)}${n}`})}rn(t,e={}){return this.parent.Smileys.parse(t)}un(t,e={}){return this.parent.Emojis.parse(t)}ln(t){return this.wn("type",t)}hn(t){return this.wn("value",t)}cn(t){let e=(t.value||"").match(this.Ue);(null==e?void 0:e[1])?(t.type=e[1],t.value=e[2]):t.type="none",t.value=(t.value||"").trim()}dn(t){let e=t.type.split("|"),i=e.slice(1,e.length-1).map(t=>(t||"").trim()),s=t.value.split("\n").map(t=>{let e=t.split("|"),s=e.slice(1,e.length-1).map(t=>(t||"").trim()),n=i.length-s.length;if(0!==n)if(n<0)s=s.slice(0,i.length);else for(let i=0;i<n;i++)s.push("");return s});t.type=i,t.value=s}vn(t,e={}){return(i,s,n,r,o)=>{let u=`markdown_${t[0]}`,a="",l="",h={type:null,value:null,url_crisp_image:this.parent.config.url.crisp_image,no_external_link:this.parent.config.runtime.no_external_link||!1};a=("string"==typeof s?s:null)||"",l=("string"==typeof o?o:null)||"",h.type=n,h.value=r,-1!==this.He.indexOf(t[0])&&"string"==typeof h.value&&(h.value=h.value.trim()),-1!==this.We.indexOf(t[0])&&"string"==typeof h.value&&(h.value=this.bn(h.value));let c=this.an[u]||null;return null!==c&&bs(c,this)(h),`${a}${this.parent.template.render(u,h,e)}${l}`}}mn(t,e,i){let s=t.match(e);if(s)for(let n=0;n<s.length;n++){let e=s[n].replace(this.Te,(t,e,i)=>`${e}${i}`);t=t.replace(s[n],e)}return t.replace(e,(t,e,s,n)=>i(t,e,s,n.replace(this.Le,"")))}bn(t){let e=t;return e=this.Ke(e,{},this.je),e=e.replace(this.Oe,t=>`&#${t.charCodeAt(0)};`),e}wn(t,e){let i=(e[t]||"").match(this.Pe);if((null==i?void 0:i[1])&&(null==i?void 0:i[2])&&(null==i?void 0:i[3])){e[t]=i[1];let s=i[2],n=i[3]||s;s&&"auto"!==s&&(e.width=s),n&&"auto"!==n&&(e.height=n)}}yn(t,e="gi",i={}){return new RegExp(`${i.prefix||""}${t}${i.suffix||""}`,e)}Dn(){this.Fn={email:this.yn("([\\w\\._-]+@[\\w\\.\\/_-]+)","gi",this.Ve.links),phone:this.yn("(\\+[0-9]{1,3}[ \\(\\)\\-0-9]{7,20})","gi",this.Ve.links),domain:this.yn(["((?:[^<>\\(\\)\\s,@]+)(?:\\.(?:",this.Ae.map(bs(this.escape_regex,this)).join("|"),")))"].join(""),"gim",this.Ve.links),uri:this.yn("((?:(?:(?:https?|ftps?|file):)|(?:www\\.))(?:[^<>\\(\\)\\s]+))","gim",this.Ve.links)}}pn(){this.gn=[["code_block",this.yn("(`{2,3})((?:\\n+)?(?:(?!\\2).(?:\\n+)?)*)(?:\\2)","gi",{prefix:"(\\s|<[^<>]+\\/>|^)",suffix:"(\\s|\\.|,|:|$)"})],["code_inline",this.yn("(`{1})([^`]*)(?:\\2)","gim",{prefix:"(\\s|<[^<>]+\\/>|\\(|^)",suffix:"(\\s|\\.|,|:|\\)|<\\/[^<>]+>|$)"})],["title",this.yn("(#{1})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["title",this.yn("(#{2})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["title",this.yn("(#{3})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["title",this.yn("(#{4})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["title",this.yn("(#{5})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["title",this.yn("(#{6})(?:[\\s]+)([^#].*)","gim",this.Ve.markdown_simple)],["link_image",this.yn("\\[!\\[(?:[^\\[]*)\\]\\(([^\\)]+)\\)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["image",this.yn("!\\[([^\\[]*)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["link_text",this.yn("\\[([^\\[]+)\\]\\(([^\\)]+)\\)","gim",{prefix:"(\\s|<[^<>]+\\/>|<[^a][^<>]*>|\\(|^)",suffix:"(\\s|.|,|:|<[^<>]+\\/>|</[^a][^<>]*>|\\)|$)"})],["youtube",this.yn("\\$\\{youtube\\}\\[([^\\[]*)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["vimeo",this.yn("\\$\\{vimeo\\}\\[([^\\[]*)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["dailymotion",this.yn("\\$\\{dailymotion\\}\\[([^\\[]*)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["frame",this.yn("\\$\\{frame\\}\\[([^\\[]*)\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)],["bold",this.yn("(\\*\\*)(.*?)(?:\\2)","gim",this.Ve.markdown_formatting)],["underline",this.yn("(__)(.*?)(?:\\2)","gim",this.Ve.markdown_formatting)],["italic",this.yn("(\\*|_)(.*?)(?:\\2)","gim",this.Ve.markdown_formatting)],["delete",this.yn("(\\~\\~)(.*?)(?:\\2)","gim",this.Ve.markdown_formatting)],["highlight",this.yn("(\\+\\+)(.*?)(?:\\2)","gim",this.Ve.markdown_formatting)],["list",this.yn("(\\*)(?:[\\s]+)","gim",this.Ve.markdown_list)],["list",this.yn("(?:([\\d]{1,2})\\.)(?:[\\s]+)","gim",this.Ve.markdown_list)],["blockquote",this.yn("(&gt;|\\>)(?:[\\s]+)(.*)","gim",this.Ve.markdown_simple)],["table",this.yn("(?:(\\|(?:[^\\|\\r\\n]{0,999}\\|){1,19})(?: *\\n)(?:\\|(?: *\\-{1,99} *\\|){1,19}))((?: *\\n\\|(?:[^\\|\\r\\n]{0,999}\\|){1,19}){1,49})","gi",{prefix:"(\\s|^)",suffix:"(\\s|$)"})],["emphasis",this.yn("(\\|{1})(?:[\\s]+)([^\\|].*)","gim",this.Ve.markdown_simple)],["emphasis",this.yn("(\\|{2})(?:[\\s]+)([^\\|].*)","gim",this.Ve.markdown_simple)],["emphasis",this.yn("(\\|{3})(?:[\\s]+)([^\\|].*)","gim",this.Ve.markdown_simple)],["interpolate",this.yn('(?:\\{\\{\\s*)([^\\{\\}\\|\\s]+)(?:\\s*\\|\\s*(?:(?:&quot;)|")([^&"]*)(?:(?:&quot;)|"))?(?:\\s*\\}\\})',"gim",{prefix:"(\\s|\\(|^)",suffix:""})],["line",this.yn("(-{3,})","gim",{prefix:"(^)(\\s+)?",suffix:"(\\s|$)"})],["color",this.yn("\\$\\{color\\}\\[(#[0-9A-Fa-f]{6})\\]\\(([^\\)]+)\\)","gim",this.Ve.markdown_includes)]]}},xs=class{constructor(t){this.parent=t,this.En=/^(\S+)((?:\s+)(.+))?$/}parse_first_name(t){return this.Cn(t,1)}parse_last_name(t){return this.Cn(t,3)}Cn(t,e){let i=(t||"").trim();if(i){let t=i.match(this.En);(null==t?void 0:t[e])&&(i=t[e].trim())}return i}},Ss=class{constructor(t){this.parent=t,this.kn={type:"none",decision:"index"}}evaluate_filters(t,e="",i=""){for(let s=0;s<t.length;s++){let n=t[s];switch(n.type){case"any":return n;case"url:exact":case"url:prefix":case"url:contains":{let t=(n.value||"").toLowerCase(),i=e.toLowerCase(),s=n.type.split(":")[1],r=!1;if(r="contains"===s?i.includes(t):"prefix"===s?i.startsWith(t):i===t&&!0,!0===r)return n;break}case"language":if(i===n.value)return n;break;default:throw new Error(`Missing filter rule implementation for type: '${n.type}'`)}}return this.kn}};const zs=new class{init(t){this.$n(t),this.Smileys=new ys(this),this.Emojis=new Es(this),this.Parse=new As(this),this.Name=new xs(this),this.Page=new Ss(this)}$n(t){(null==t?void 0:t.template)&&(this.template=t.template),(null==t?void 0:t.config)&&(this.config=t.config)}};const Is=/^(?:\s*)(?:(?:javascript|vbscript):)/i;const js=new class{constructor(){this.init()}init(){zs.init({template:{render:(t,e)=>{let i=this[`render_${t}`];if("function"==typeof i)return function(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}(i,this)(e);throw new Error(`Render service is missing for: ${t}`)}},config:{url:{crisp_image:Pe.URL_IMAGE},runtime:{}}})}parse(){return zs.Parse}name(){return zs.Name}smileys(){return zs.Smileys}page(){return zs.Page}html(t){return this.parse().html(t)}attribute(t){return this.parse().attribute(t)}lower(t){return(t||"").toLowerCase()}filterLinkSafe(t){let e="#";return t&&!1===Is.test(t)&&(e=t),e}render_new_line(){return'<br class="cc-1rzu4" />'}render_link_email(t){return`<a class="cc-13wgx cc-1mxl0" data-email="${this.attribute(t.email)}" href="mailto:${t.email}" target="_blank" rel="noopener noreferrer">${t.email}</a>`}render_link_phone(t){return`<a class="cc-13wgx cc-45k2a" href="tel:${t.phone}" target="_blank" rel="noopener noreferrer">${t.phone}</a>`}render_link_uri(t){return`<a class="cc-13wgx cc-qape1" href="${t.uri_value}" target="_blank" rel="noopener noreferrer">${t.uri_name}</a>`}render_link_domain(t){return`<a class="cc-13wgx cc-1s1er" href="http://${t.domain_value}/" rel="noopener noreferrer" target="_blank">${t.domain_name}</a>`}render_markdown_blockquote(t){return`<span class="cc-frbzi cc-j7g9w">${t.value}</span>`}render_markdown_table(t){return'<table class="cc-frbzi cc-159gr"><thead><tr>'+t.type.map(t=>`<th>${t}</th>`).join("")+"</tr></thead><tbody>"+t.value.map(t=>"<tr>"+t.map(t=>`<td>${t}</td>`).join("")+"</tr>").join("")+"</tbody></table>"}render_markdown_interpolate(t){return`<span class="cc-frbzi cc-euwmp">{{ ${t.type}${t.value?' | "'+t.value+'"':""} }}</span>`}render_markdown_color(t){return`<span class="cc-frbzi cc-33ysn" style="color: ${t.type};">${t.value}</span>`}render_markdown_bold(t){return`<span class="cc-frbzi cc-53ybt cc-vqf16">${t.value}</span>`}render_markdown_code_inline(t){return`<span class="cc-frbzi cc-w8r32 cc-mxy19 cc-r7tre">${t.value}</span>`}render_markdown_code_block(t){return`<span class="cc-frbzi cc-w8r32 cc-vdow5 cc-r7tre">${t.value}</span>`}render_markdown_delete(t){return`<span class="cc-frbzi cc-ibcby">${t.value}</span>`}render_markdown_highlight(t){return`<span class="cc-frbzi cc-1q2pi">${t.value}</span>`}render_markdown_image(t){return`<span class="cc-frbzi cc-1y6po" data-show-preview-url="${this.attribute(t.value)}"><img src="${t.url_crisp_image}/process/original/?url=${encodeURIComponent(t.value)}" alt="${this.attribute(t.type)}" /></span>`}render_markdown_italic(t){return`<span class="cc-frbzi cc-pxtz9">${t.value}</span>`}render_markdown_underline(t){return`<span class="cc-frbzi cc-fktp8">${t.value}</span>`}render_markdown_line(){return'<span class="cc-frbzi cc-gufgm"></span>'}render_markdown_link_text(t){return`<a class="cc-frbzi cc-yv6sk cc-11g9w" href="${this.attribute(this.filterLinkSafe(t.value))}" target="${this.attribute("_blank")}" rel="noopener noreferrer">${t.type}</a>`}render_markdown_link_image(t){return`<a class="cc-frbzi cc-yv6sk cc-pig40" href="${this.attribute(this.filterLinkSafe(t.value))}" target="_blank" rel="noopener noreferrer"><span class="cc-frbzi cc-1y6po"><img src="${t.url_crisp_image}/process/original/?url=${encodeURIComponent(t.type)}" alt="" /></span></a>`}render_markdown_list(t){return`<span class="cc-frbzi cc-1rkq5" data-type="${this.attribute(t.type)}">${t.value}</span>`}render_markdown_title(t){return`<span class="cc-frbzi cc-1i0k1 cc-vqf16" data-type="${this.attribute(t.type)}">${t.value}</span>`}render_markdown_emphasis(t){return`<span class="cc-frbzi cc-j2pfb cc-vqf16" data-type="${this.attribute(t.type)}">${t.value}</span>`}render_markdown_youtube(t){let e=`https://www.youtube.com/embed/${encodeURIComponent(t.value)}?autoplay=1&rel=0`,i=encodeURIComponent(`https://img.youtube.com/vi/${encodeURIComponent(t.value)}/hqdefault.jpg`);return`<a class="cc-frbzi cc-1vcwa cc-1unxt" href="${e}" target="${this.attribute("_blank")}" rel="noopener noreferrer"><span class="cc-1sl8g cc-1srvi cc-34ww6 cc-17oh3"><img src="${t.url_crisp_image}/process/resize/?url=${i}&width=960&height=960" alt="${this.attribute(t.type)}" /></span></a>`}render_markdown_vimeo(t){let e=`https://vimeo.com/${encodeURIComponent(t.value)}?autoplay=1`;return`<a class="cc-13wgx cc-qape1" href="${e}" target="${this.attribute("_blank")}" rel="noopener noreferrer">${t.type||e}</a>`}render_markdown_dailymotion(t){let e=`https://www.dailymotion.com/embed/video/${encodeURIComponent(t.value)}`,i=encodeURIComponent(`https://www.dailymotion.com/thumbnail/video/${encodeURIComponent(t.value)}`);return`<a class="cc-frbzi cc-1vcwa cc-12n8m" href="${e}" target="${this.attribute("_blank")}" rel="noopener noreferrer"><span class="cc-1sl8g cc-1w7n8 cc-34ww6 cc-17oh3"><img src="${t.url_crisp_image}/process/resize/?url=${i}&width=320&height=240" alt="${this.attribute(t.type)}" /></span></a>`}render_markdown_frame(t){return`<a class="cc-13wgx cc-qape1" href="${this.attribute(this.filterLinkSafe(t.value))}" target="${this.attribute("_blank")}" rel="noopener noreferrer">${t.type||t.value}</a>`}render_smiley(t){return`<span class="cc-f45nf" data-size="${this.attribute(t.size)}" data-name="${this.attribute(t.name)}"></span>`}render_emoji(t){return`<span class="cc-16j3k" data-size="${this.attribute(t.size)}">${t.name}</span>`}};const Rs=Ye({code:"",direction:"ltr"},{});function Os(t){return{all:t=t||new Map,on:function(e,i){var s=t.get(e);s?s.push(i):t.set(e,[i])},off:function(e,i){var s=t.get(e);s&&(i?s.splice(s.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var s=t.get(e);s&&s.slice().map(function(t){t(i)}),(s=t.get("*"))&&s.slice().map(function(t){t(e,i)})}}}function Ms(){return(new Date).getTime()}Rs.web=je(()=>{let t=null;t=Pe.LOCALE_DEFAULT;let e=Rs.code;return!0===Pe.LOCALE_WEBSITE.includes(e)&&(t=e),t});class qs{constructor(){this.Bn=Os(),this.An={},this.xn=[]}subscribe(t,e){this.Bn.on(t,t=>{e(t)}),this.Sn(t),this.An[t]||(this.An[t]=[]),this.An[t].push(e)}unsubscribe(t,e){this.Bn.off(t,e),this.An[t]&&(this.An[t]=this.An[t].filter(t=>t!==e))}emit(t,e){uu.setTimeout(()=>{this.xn.length<50&&this.xn.push({event:t,data:e,timestamp:Ms()}),this.Bn.emit(t,e)},1)}Sn(t){this.xn.forEach(e=>{e.event===t&&e.timestamp>Ms()-1e3&&this.Bn.emit(e.event,e.data)}),this.xn=this.xn.filter(e=>e.event!==t)}}const Us=new class extends qs{constructor(){super()}subscribe(t,e){super.subscribe(t,e)}unsubscribe(t,e){super.unsubscribe(t,e)}blurFromForeground(){super.emit("blur-from-foreground")}focusOnForeground(){super.emit("focus-on-foreground")}scrollTo(t=0){super.emit("scroll-to",t)}scrollToLastMessage(t="to"){super.emit("scroll-to-last-message",t)}checkClearance(){super.emit("check-clearance")}handleScroll(t){super.emit("handle-scroll",t)}propagateScroll(t){super.emit("propagate-scroll",t)}};const Ps=new class{getTriggers(){var t,e,i,s;return(null==(s=null==(i=null==(e=null==(t=Xo.website)?void 0:t.plugins)?void 0:e["urn:crisp.im:triggers:0"])?void 0:i.settings)?void 0:s.triggers)||{}}getCustomization(t,e,i=null){var s,n,r,o,u;let a=null;return a=(null==(u=null==(o=null==(r=null==(n=null==(s=Xo.website)?void 0:s.plugins)?void 0:n["urn:crisp.im:customization:0"])?void 0:r.settings)?void 0:o[t])?void 0:u[e])||{},i&&(a=a[i]||null),a}},Ts=["ltr","rtl"];const Ls=new class extends Ge{constructor(){super(),this.zn=Pe.LOCALE_AVAILABLE,this.In()}reset(){this.In()}detect(t=[]){var e;let i,s=Pe.LOCALE_DEFAULT,n=[];t.length&&(this.zn=uu.intersect(t,Pe.LOCALE_AVAILABLE),this.zn.length>0&&!this.zn.includes(s)&&(s=Pe.LOCALE_DEFAULT=this.zn[0]));for(let r=0;r<(null==(e=Xo.base.browser_locales)?void 0:e.length);r++)i=Xo.base.browser_locales[r],i&&(n.push(i.toLowerCase()),i.includes("-")&&(i=i.split("-")[0],i&&n.push(i.toLowerCase())));for(let r=0;r<n.length;r++)if(this.zn.includes(n[r])){s=n[r];break}return s}async load(t){try{let e=t;if(this.zn.includes(t)||(e=Pe.LOCALE_DEFAULT),null!==this.jn&&this.jn._meta.locale_code!==t&&(this.jn=null),null===this.jn){let t=await fetch(`${Pe.URL_CLIENT}/static/locales/${e}.json?${Pe.REVISION}`),i=await t.json();this.Rn(e,i),Xo.locale.code=i._meta.locale_code||e,Xo.locale.direction=this.direction()}}catch(e){throw We.error(e),"LocaleHelper.load: "+e}}direction(){var t,e;let i=null;if(!(null==(e=null==(t=this.jn)?void 0:t._meta)?void 0:e.locale_direction))throw new Error("Cannot get locale direction, locale data not loaded");return i=this.jn._meta.locale_direction,Ts.includes(i)||(i="ltr"),i}text(t,e,i=[]){let s,n,r=null;"object"==typeof e?(s=e[0],n=e[1]):s=n=e;let o=`${t}.${s}.${n}`;return null===this.jn||void 0===this.jn._strings[t]||void 0===this.jn._strings[t][n]?o:(r=Ps.getCustomization("text",t,s)||this.jn._strings[t][n],r=js.parse().replace(r,i),r=this.On(r),r)}Rn(t,e){if(null!==this.jn)throw new Error("Locale has already been loaded (double requested handled?)");if("object"!=typeof e)throw new Error("Did not receive a proper locale data file");if(e._meta.locale_code!==t)throw new Error(`Received a mismatching locale code, expected: ${t}`);this.jn=e}On(t){let e=null;try{e=decodeURIComponent(escape(t))}catch{e=t}return e}In(){this.jn=null}};const Ns=new class{url(t,e,i,s=null){var n,r,o,u;let a=Pe.URL_IMAGE;return"string"==typeof s&&null!==s?Pe.TEST||s.substring(0,a.length)===a?s:`${a}/process/thumbnail/?url=${encodeURIComponent(s)}&width=${t}&height=${t}&${null==(r=null==(n=Xo.website)?void 0:n.website)?void 0:r.buster}`:`${a}/avatar/${e}/${i||"default"}/${t}/?${null==(u=null==(o=Xo.website)?void 0:o.website)?void 0:u.buster}`}};function Vs(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}function Hs(t){return t&&t.t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ws,Js;var Gs=Hs(function(){if(Js)return Ws;Js=1;var t=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];return Ws=function(i){var s,n,r=i,o=i.indexOf("["),u=i.indexOf("]");-1!=o&&-1!=u&&(i=i.substring(0,o)+i.substring(o,u).replace(/:/g,";")+i.substring(u,i.length));for(var a,l,h=t.exec(i||""),c={},d=14;d--;)c[e[d]]=h[d]||"";return-1!=o&&-1!=u&&(c.source=r,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=(n=(s=c.path).replace(/\/{2,9}/g,"/").split("/"),"/"!=s.substr(0,1)&&0!==s.length||n.splice(0,1),"/"==s.substr(s.length-1,1)&&n.splice(n.length-1,1),n),c.queryKey=(a=c.query,l={},a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,i){e&&(l[e]=i)}),l),c}}());const Ks=Object.create(null);Ks.open="0",Ks.close="1",Ks.ping="2",Ks.pong="3",Ks.message="4",Ks.upgrade="5",Ks.noop="6";const Ys=Object.create(null);Object.keys(Ks).forEach(t=>{Ys[Ks[t]]=t});const Zs={type:"error",data:"parser error"},Xs="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Qs="function"==typeof ArrayBuffer,tn=({type:t,data:e},i,s)=>{return Xs&&e instanceof Blob?i?s(e):en(e,s):Qs&&(e instanceof ArrayBuffer||(n=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer))?i?s(e):en(new Blob([e]),s):s(Ks[t]+(e||""));var n},en=(t,e)=>{const i=new FileReader;return i.onload=function(){const t=i.result.split(",")[1];e("b"+(t||""))},i.readAsDataURL(t)},sn="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let Zu=0;Zu<64;Zu++)sn["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(Zu)]=Zu;const nn="function"==typeof ArrayBuffer,rn=(t,e)=>{if(nn){const i=(t=>{let e,i,s,n,r,o=.75*t.length,u=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);const l=new ArrayBuffer(o),h=new Uint8Array(l);for(e=0;e<u;e+=4)i=sn[t.charCodeAt(e)],s=sn[t.charCodeAt(e+1)],n=sn[t.charCodeAt(e+2)],r=sn[t.charCodeAt(e+3)],h[a++]=i<<2|s>>4,h[a++]=(15&s)<<4|n>>2,h[a++]=(3&n)<<6|63&r;return l})(t);return on(i,e)}return{base64:!0,data:t}},on=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;var _,un={};var an=function(){if(_)return un;function t(e){if(e)return function(e){for(var i in t.prototype)e[i]=t.prototype[i];return e}(e)}return _=1,un.Emitter=t,t.prototype.on=t.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},t.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,s=this._callbacks["$"+t];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n=0;n<s.length;n++)if((i=s[n])===e||i.fn===e){s.splice(n,1);break}return 0===s.length&&delete this._callbacks["$"+t],this},t.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(i){s=0;for(var n=(i=i.slice(0)).length;s<n;++s)i[s].apply(this,e)}return this},t.prototype.emitReserved=t.prototype.emit,t.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},t.prototype.hasListeners=function(t){return!!this.listeners(t).length},un}(),ln="undefined"!=typeof window?window:Function("return this")();const hn=setTimeout,cn=clearTimeout;function dn(t,e){e.useNativeTimers?(t.setTimeoutFn=Vs(hn,ln),t.clearTimeoutFn=Vs(cn,ln)):(t.setTimeoutFn=Vs(setTimeout,ln),t.clearTimeoutFn=Vs(clearTimeout,ln))}function Dn(t){return"string"==typeof t?function(t){let e=0,i=0;for(let s=0,n=t.length;s<n;s++)e=t.charCodeAt(s),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(s++,i+=4);return i}(t):Math.ceil(1.33*(t.byteLength||t.size))}class fn extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class pn extends an.Emitter{constructor(t){super(),this.writable=!1,dn(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,i){return super.emitReserved("error",new fn(t,e,i)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=((t,e)=>{if("string"!=typeof t)return{type:"message",data:on(t,e)};const i=t.charAt(0);return"b"===i?{type:"message",data:rn(t.substring(1),e)}:Ys[i]?t.length>1?{type:Ys[i],data:t.substring(1)}:{type:Ys[i]}:Zs})(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const mn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("");let _n,Fn=0;function gn(t){let e="";do{e=mn[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}const $="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),vn=ln.WebSocket||ln.MozWebSocket,wn="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class bn extends pn{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,i=wn?{}:function(t,...e){return e.reduce((e,i)=>(t.hasOwnProperty(i)&&(e[i]=t[i]),e),{})}(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=wn?new vn(t,e,i):e?new vn(t,e):new vn(t)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],s=e===t.length-1;tn(i,this.supportsBinary,t=>{try{this.ws.send(t)}catch(e){}s&&$(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let i="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=function(){const t=gn(+new Date);return t!==_n?(Fn=0,_n=t):t+"."+gn(Fn++)}()),this.supportsBinary||(t.b64=1);const s=function(t){let e="";for(let i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e}(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(s.length?"?"+s:"")}check(){return!(!vn||"i"in vn&&this.name===bn.prototype.name)}}const yn={websocket:bn},En=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Cn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function kn(t){const e=t,i=t.indexOf("["),s=t.indexOf("]");-1!=i&&-1!=s&&(t=t.substring(0,i)+t.substring(i,s).replace(/:/g,";")+t.substring(s,t.length));let n=En.exec(t||""),r={},o=14;for(;o--;)r[Cn[o]]=n[o]||"";return-1!=i&&-1!=s&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=function(t,e){const i=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.substr(0,1)&&0!==e.length||i.splice(0,1),"/"==e.substr(e.length-1,1)&&i.splice(i.length-1,1),i}(0,r.path),r.queryKey=function(t,e){const i={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,s){e&&(i[e]=s)}),i}(0,r.query),r}let $n=class t extends an.Emitter{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=kn(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=kn(e.host).host),dn(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},i=t.split("&");for(let s=0,n=i.length;s<n;s++){let t=i[s].split("=");e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=function(t){const e={};for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new yn[t](i)}open(){let e;if(this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(An){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",Vs(this.onDrain,this)).on("packet",Vs(this.onPacket,this)).on("error",Vs(this.onError,this)).on("close",t=>this.onClose("transport close",t))}probe(e){let i=this.createTransport(e),s=!1;t.priorWebsocketSuccess=!1;const n=()=>{s||(i.send([{type:"ping",data:"probe"}]),i.once("packet",e=>{if(!s)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;t.priorWebsocketSuccess="websocket"===i.name,this.transport.pause(()=>{s||"closed"!==this.readyState&&(h(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=i.name,this.emitReserved("upgradeError",t)}}))};function r(){s||(s=!0,h(),i.close(),i=null)}const o=t=>{const e=new Error("probe error: "+t);e.transport=i.name,r(),this.emitReserved("upgradeError",e)};function u(){o("transport closed")}function a(){o("socket closed")}function l(t){i&&t.name!==i.name&&r()}const h=()=>{i.removeListener("open",n),i.removeListener("error",o),i.removeListener("close",u),this.off("close",a),this.off("upgrading",l)};i.once("open",n),i.once("error",o),i.once("close",u),this.once("close",a),this.once("upgrading",l),i.open()}onOpen(){if(this.readyState="open",t.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let e=0;e<this.writeBuffer.length;e++){const i=this.writeBuffer[e].data;if(i&&(t+=Dn(i)),e>0&&t>this.maxPayload)return this.writeBuffer.slice(0,e);t+=2}return this.writeBuffer}write(t,e,i){return this.sendPacket("message",t,e,i),this}send(t,e,i){return this.sendPacket("message",t,e,i),this}sendPacket(t,e,i,s){if("function"==typeof e&&(s=e,e=void 0),"function"==typeof i&&(s=i,i=null),"closing"===this.readyState||"closed"===this.readyState)return;(i=i||{}).compress=!1!==i.compress;const n={type:t,data:e,options:i};this.emitReserved("packetCreate",n),this.writeBuffer.push(n),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}onError(e){t.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let i=0;const s=t.length;for(;i<s;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}};var Bn,An;$n.protocol=4,(An=Bn||(Bn={}))[An.CONNECT=0]="CONNECT",An[An.DISCONNECT=1]="DISCONNECT",An[An.EVENT=2]="EVENT",An[An.ACK=3]="ACK",An[An.CONNECT_ERROR=4]="CONNECT_ERROR",An[An.BINARY_EVENT=5]="BINARY_EVENT",An[An.BINARY_ACK=6]="BINARY_ACK";class xn extends an.Emitter{constructor(){super()}add(t){let e;if("string"!=typeof t)throw new Error("Unknown type: "+t);e=this.decodeString(t),e.type===Bn.BINARY_EVENT||e.type===Bn.BINARY_ACK?0===e.attachments&&super.emitReserved("decoded",e):super.emitReserved("decoded",e)}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(void 0===Bn[i.type])throw new Error("unknown packet type "+i.type);if(i.type===Bn.BINARY_EVENT||i.type===Bn.BINARY_ACK){const s=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const n=t.substring(s,e);if(n!=Number(n)||"-"!==t.charAt(e))throw new Error("Illegal attachments");i.attachments=Number(n)}if("/"===t.charAt(e+1)){const s=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);i.nsp=t.substring(s,e)}else i.nsp="/";const s=t.charAt(e+1);if(""!==s&&Number(s)==s){const s=e+1;for(;++e;){const i=t.charAt(e);if(null==i||Number(i)!=i){--e;break}if(e===t.length)break}i.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=function(t){try{return JSON.parse(t)}catch(e){return!1}}(t.substr(e));if(!xn.isPayloadValid(i.type,s))throw new Error("invalid payload");i.data=s}return i}static isPayloadValid(t,e){switch(t){case Bn.CONNECT:return"object"==typeof e;case Bn.DISCONNECT:return void 0===e;case Bn.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case Bn.EVENT:case Bn.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case Bn.ACK:case Bn.BINARY_ACK:return Array.isArray(e)}}destroy(){}}var Sn=Object.freeze({__proto__:null,Decoder:xn,Encoder:class{encode(t){return[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return t.type!==Bn.BINARY_EVENT&&t.type!==Bn.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e}},get PacketType(){return Bn},protocol:5});function zn(t,e,i){return t.on(e,i),function(){t.off(e,i)}}const In=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class jn extends an.Emitter{constructor(t,e,i){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[zn(t,"open",Vs(this.onopen,this)),zn(t,"packet",Vs(this.onpacket,this)),zn(t,"error",Vs(this.onerror,this)),zn(t,"close",Vs(this.onclose,this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(In.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const i={type:Bn.EVENT,data:e,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,s=e.pop();this._registerAckCallback(t,s),i.id=t}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?this.packet(i):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,e){const i=this.flags.timeout;if(void 0===i)return void(this.acks[t]=e);const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))},i);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:Bn.CONNECT,data:t})}):this.packet({type:Bn.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Bn.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Bn.EVENT:this.onevent(t);break;case Bn.BINARY_EVENT:break;case Bn.ACK:this.onack(t);break;case Bn.BINARY_ACK:break;case Bn.DISCONNECT:this.ondisconnect();break;case Bn.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let i=!1;return function(...s){i||(i=!0,e.packet({type:Bn.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>this.packet(t)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Bn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var Rn,On;var Mn=Hs(function(){if(On)return Rn;function t(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}return On=1,Rn=t,t.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+i:t-i}return 0|Math.min(t,this.max)},t.prototype.reset=function(){this.attempts=0},t.prototype.setMin=function(t){this.ms=t},t.prototype.setMax=function(t){this.max=t},t.prototype.setJitter=function(t){this.jitter=t},Rn}());class qn extends an.Emitter{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,dn(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=e.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new Mn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const s=e.parser||Sn;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new $n(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const s=zn(e,"open",function(){i.onopen(),t&&t()}),n=zn(e,"error",e=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",e),t?t(e):i.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&s();const i=this.setTimeoutFn(()=>{s(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}return this.subs.push(s),this.subs.push(n),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(zn(t,"ping",Vs(this.onping,this)),zn(t,"data",Vs(this.ondata,this)),zn(t,"error",Vs(this.onerror,this)),zn(t,"close",Vs(this.onclose,this)),zn(this.decoder,"decoded",Vs(this.ondecoded,this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i||(i=new jn(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const i of e)if(this.nsps[i].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Un={};function Pn(t,e){"object"==typeof t&&(e=t,t=void 0);const i=function(t,e="",i){let s=t;i=i||"undefined"!=typeof location&&location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==i?i.protocol+"//"+t:"https://"+t),s=Gs(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const n=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+n+":"+s.port+e,s.href=s.protocol+"://"+n+(i&&i.port===s.port?"":":"+s.port),s}(t,(e=e||{}).path||"/socket.io"),s=i.source,n=i.id,r=i.path,o=Un[n]&&r in Un[n].nsps;let u;return e.forceNew||e["force new connection"]||!1===e.multiplex||o?u=new qn(s,e):(Un[n]||(Un[n]=new qn(s,e)),u=Un[n]),i.query&&!e.query&&(e.query=i.queryKey),u.socket(i.path,e)}Object.assign(Pn,{Manager:qn,Socket:jn,io:Pn,connect:Pn});var Tn="invalid",Ln="undefined"!=typeof ArrayBuffer,Nn="0123456789abcdef".split(""),Vn=[-2147483648,8388608,32768,128],Hn=[24,16,8,0],Wn=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Jn=[];function Gn(t){t?(Jn[0]=Jn[16]=Jn[1]=Jn[2]=Jn[3]=Jn[4]=Jn[5]=Jn[6]=Jn[7]=Jn[8]=Jn[9]=Jn[10]=Jn[11]=Jn[12]=Jn[13]=Jn[14]=Jn[15]=0,this.blocks=Jn):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}function Kn(t,e){var i,s=typeof t;if("string"===s){var n,r=[],o=t.length,u=0;for(i=0;i<o;++i)(n=t.charCodeAt(i))<128?r[u++]=n:n<2048?(r[u++]=192|n>>6,r[u++]=128|63&n):n<55296||n>=57344?(r[u++]=224|n>>12,r[u++]=128|n>>6&63,r[u++]=128|63&n):(n=65536+((1023&n)<<10|1023&t.charCodeAt(++i)),r[u++]=240|n>>18,r[u++]=128|n>>12&63,r[u++]=128|n>>6&63,r[u++]=128|63&n);t=r}else{if("object"!==s)throw new Error(Tn);if(null===t)throw new Error(Tn);if(Ln&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||Ln&&ArrayBuffer.isView(t)))throw new Error(Tn)}t.length>64&&(t=new Gn(!0).update(t).digest());var a=[],l=[];for(i=0;i<64;++i){var h=t[i]||0;a[i]=92^h,l[i]=54^h}Gn.call(this,e),this.update(l),this.oKeyPad=a,this.inner=!0,this.memory=e}Gn.prototype.update=function(t){if(!this.finalized){var e,i=typeof t;if("string"!==i){if("object"!==i)throw new Error(Tn);if(null===t)throw new Error(Tn);if(Ln&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!(Array.isArray(t)||Ln&&ArrayBuffer.isView(t)))throw new Error(Tn);e=!0}for(var s,n,r=0,o=t.length,u=this.blocks;r<o;){if(this.hashed&&(this.hashed=!1,u[0]=this.block,u[16]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0),e)for(n=this.start;r<o&&n<64;++r)u[n>>2]|=t[r]<<Hn[3&n++];else for(n=this.start;r<o&&n<64;++r)(s=t.charCodeAt(r))<128?u[n>>2]|=s<<Hn[3&n++]:s<2048?(u[n>>2]|=(192|s>>6)<<Hn[3&n++],u[n>>2]|=(128|63&s)<<Hn[3&n++]):s<55296||s>=57344?(u[n>>2]|=(224|s>>12)<<Hn[3&n++],u[n>>2]|=(128|s>>6&63)<<Hn[3&n++],u[n>>2]|=(128|63&s)<<Hn[3&n++]):(s=65536+((1023&s)<<10|1023&t.charCodeAt(++r)),u[n>>2]|=(240|s>>18)<<Hn[3&n++],u[n>>2]|=(128|s>>12&63)<<Hn[3&n++],u[n>>2]|=(128|s>>6&63)<<Hn[3&n++],u[n>>2]|=(128|63&s)<<Hn[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=u[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},Gn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=Vn[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},Gn.prototype.hash=function(){var t,e,i,s,n,r,o,u,a,l=this.h0,h=this.h1,c=this.h2,d=this.h3,D=this.h4,f=this.h5,p=this.h6,m=this.h7,F=this.blocks;for(t=16;t<64;++t)e=((n=F[t-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,i=((n=F[t-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,F[t]=F[t-16]+e+F[t-7]+i|0;for(a=h&c,t=0;t<64;t+=4)this.first?(r=704751109,m=(n=F[0]-210244248)-1521486534|0,d=n+143694565|0,this.first=!1):(e=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),s=(r=l&h)^l&c^a,m=d+(n=m+(i=(D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))+(D&f^~D&p)+Wn[t]+F[t])|0,d=n+(e+s)|0),e=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),s=(o=d&l)^d&h^r,p=c+(n=p+(i=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&D^~m&f)+Wn[t+1]+F[t+1])|0,e=((c=n+(e+s)|0)>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),s=(u=c&d)^c&l^o,f=h+(n=f+(i=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&D)+Wn[t+2]+F[t+2])|0,e=((h=n+(e+s)|0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),s=(a=h&c)^h&d^u,D=l+(n=D+(i=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&p^~f&m)+Wn[t+3]+F[t+3])|0,l=n+(e+s)|0;this.h0=this.h0+l|0,this.h1=this.h1+h|0,this.h2=this.h2+c|0,this.h3=this.h3+d|0,this.h4=this.h4+D|0,this.h5=this.h5+f|0,this.h6=this.h6+p|0,this.h7=this.h7+m|0},Gn.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,s=this.h3,n=this.h4,r=this.h5,o=this.h6,u=this.h7;return Nn[t>>28&15]+Nn[t>>24&15]+Nn[t>>20&15]+Nn[t>>16&15]+Nn[t>>12&15]+Nn[t>>8&15]+Nn[t>>4&15]+Nn[15&t]+Nn[e>>28&15]+Nn[e>>24&15]+Nn[e>>20&15]+Nn[e>>16&15]+Nn[e>>12&15]+Nn[e>>8&15]+Nn[e>>4&15]+Nn[15&e]+Nn[i>>28&15]+Nn[i>>24&15]+Nn[i>>20&15]+Nn[i>>16&15]+Nn[i>>12&15]+Nn[i>>8&15]+Nn[i>>4&15]+Nn[15&i]+Nn[s>>28&15]+Nn[s>>24&15]+Nn[s>>20&15]+Nn[s>>16&15]+Nn[s>>12&15]+Nn[s>>8&15]+Nn[s>>4&15]+Nn[15&s]+Nn[n>>28&15]+Nn[n>>24&15]+Nn[n>>20&15]+Nn[n>>16&15]+Nn[n>>12&15]+Nn[n>>8&15]+Nn[n>>4&15]+Nn[15&n]+Nn[r>>28&15]+Nn[r>>24&15]+Nn[r>>20&15]+Nn[r>>16&15]+Nn[r>>12&15]+Nn[r>>8&15]+Nn[r>>4&15]+Nn[15&r]+Nn[o>>28&15]+Nn[o>>24&15]+Nn[o>>20&15]+Nn[o>>16&15]+Nn[o>>12&15]+Nn[o>>8&15]+Nn[o>>4&15]+Nn[15&o]+Nn[u>>28&15]+Nn[u>>24&15]+Nn[u>>20&15]+Nn[u>>16&15]+Nn[u>>12&15]+Nn[u>>8&15]+Nn[u>>4&15]+Nn[15&u]},Gn.prototype.toString=Gn.prototype.hex,Gn.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,s=this.h3,n=this.h4,r=this.h5,o=this.h6,u=this.h7;return[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,u>>24&255,u>>16&255,u>>8&255,255&u]},Kn.prototype=new Gn,Kn.prototype.finalize=function(){if(Gn.prototype.finalize.call(this),this.inner){this.inner=!1;var t=this.digest();Gn.call(this,this.memory),this.update(this.oKeyPad),this.update(t),Gn.prototype.finalize.call(this)}};var Yn,Zn=((Yn=function(t){return new Gn(!0).update(t).hex()}).create=function(){return new Gn},Yn.update=function(t){return Yn.create().update(t)},Yn);Zn.hmac=function(){var t=function(t,e){return new Kn(t,!0).update(e).hex()};return t.create=function(t){return new Kn(t)},t.update=function(e,i){return t.create(e).update(i)},t}();var Xn,Qn={exports:{}},tr=Qn.exports;var er=Hs(function(){return Xn||(Xn=1,t=Qn,s=function(t){if("object"!=typeof t.document)throw new Error("Cookies.js requires a `window` with a `document` object");var e=function(t,i,s){return 1===arguments.length?e.get(t):e.set(t,i,s)};return e._document=t.document,e._cacheKeyPrefix="cookey.",e._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),e.defaults={path:"/",secure:!1},e.get=function(t){e._cachedDocumentCookie!==e._document.cookie&&e._renewCache();var s=e._cache[e._cacheKeyPrefix+t];return s===i?i:decodeURIComponent(s)},e.set=function(t,s,n){return(n=e._getExtendedOptions(n)).expires=e._getExpiresDate(s===i?-1:n.expires),e._document.cookie=e._generateCookieString(t,s,n),e},e.expire=function(t,s){return e.set(t,i,s)},e._getExtendedOptions=function(t){return{path:t&&t.path||e.defaults.path,domain:t&&t.domain||e.defaults.domain,expires:t&&t.expires||e.defaults.expires,secure:t&&t.secure!==i?t.secure:e.defaults.secure}},e._isValidDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())},e._getExpiresDate=function(t,i){if(i=i||new Date,"number"==typeof t?t=t===1/0?e._maxExpireDate:new Date(i.getTime()+1e3*t):"string"==typeof t&&(t=new Date(t)),t&&!e._isValidDate(t))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return t},e._generateCookieString=function(t,e,i){var s=(t=(t=t.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(e=(e+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return s+=(i=i||{}).path?";path="+i.path:"",s+=i.domain?";domain="+i.domain:"",(s+=i.expires?";expires="+i.expires.toUTCString():"")+(i.secure?";secure":"")},e._getCacheFromString=function(t){for(var s={},n=t?t.split("; "):[],r=0;r<n.length;r++){var o=e._getKeyValuePairFromCookieString(n[r]);s[e._cacheKeyPrefix+o.key]===i&&(s[e._cacheKeyPrefix+o.key]=o.value)}return s},e._getKeyValuePairFromCookieString=function(t){var e=t.indexOf("=");e=e<0?t.length:e;var i,s=t.substr(0,e);try{i=decodeURIComponent(s)}catch(n){}return{key:i,value:t.substr(e+1)}},e._renewCache=function(){e._cache=e._getCacheFromString(e._document.cookie),e._cachedDocumentCookie=e._document.cookie},e._areEnabled=function(){var t="cookies.js",i="1"===e.set(t,1).get(t);return e.expire(t),i},e.enabled=e._areEnabled(),e},n=(e="undefined"==typeof window?tr:window)&&"object"==typeof e.document?s(e):s,(t.exports=n).Cookies=n),Qn.exports;var t,e,i,s,n}());class ir{constructor(t){this.parent=t,this.h()}setIgnorePrivacy(t=!1){this._ignorePrivacy=t}setVisitorCompose(t=!0){this._visitorCompose=t}reset(){this.h()}h(){this._ignorePrivacy=!1,this._visitorCompose=!0}}class sr{constructor(t){this.parent=t}get(t){let e=this.parent.cookie.get(t);if(void 0===e)try{if(window.localStorage&&"function"==typeof window.localStorage.getItem){let i=parseInt(window.localStorage.getItem(`${t}:e`)||"0",10);i>0&&i<=(new Date).getTime()?(e=void 0,"function"==typeof window.localStorage.removeItem&&(window.localStorage.removeItem(t),window.localStorage.removeItem(`${t}:e`))):e=window.localStorage.getItem(t)}}catch{}return void 0!==e?e:null}set(t,e,i={}){this.parent.cookie.set(t,e,i);try{window.localStorage&&"function"==typeof window.localStorage.setItem&&(window.localStorage.setItem(`${t}:e`,void 0!==i.expires?(new Date).getTime()+i.expires:0),window.localStorage.setItem(t,e))}catch{}}expire(t,e={}){this.parent.cookie.expire(t,e);try{window.localStorage&&"function"==typeof window.localStorage.removeItem&&(window.localStorage.removeItem(t),window.localStorage.removeItem(`${t}:e`))}catch{}}}class nr{constructor(t){this.parent=t,this.h()}setTimeout(t,e=0){let i=setTimeout(()=>{delete this.o[i],t()},e);return this.o[i]=i,i}clearTimeout(t){t in this.o&&(clearTimeout(this.o[t]),delete this.o[t])}setInterval(t,e=0){let i=setInterval(t,e);return this.l[i]=i,i}clearInterval(t){t in this.l&&(clearInterval(this.l[t]),delete this.l[t])}reset(){for(let t in this.o)this.clearTimeout(t);for(let t in this.l)this.clearInterval(t);this.h()}h(){this.o={},this.l={}}}class rr{constructor(t){this.parent=t,this.h()}addEventListener(t,e,i,s={}){return window[t].addEventListener(e,i,s),this.u.push({instanceName:t,eventName:e,fnHandler:i,options:s}),i}removeEventListener(t,e,i){let s=this.u.find(s=>s.eventName===e&&s.instanceName===t&&s.fnHandler===i);s&&(s.fnHandler&&window[t].removeEventListener(e,s.fnHandler,s.options),this.u=this.u.filter(s=>s.eventName!==e||s.instanceName!==t||s.fnHandler!==i))}reset(){for(let t in this.u)this.removeEventListener(t.instanceName,t.eventName,t.fnHandler);this.h()}h(){this.u=[]}}class or{constructor(t){this.parent=t,this.h(),this.p()}getState(){this._(this.parent.socket.connected||!1)}reset(){this.h()}h(){this.m=!1,this.v=!1}p(){this.parent.socket.on("connect",()=>{this.m=!0,this._(!0)}),this.parent.socket.on("disconnect",()=>{this._(!1)}),this.parent.socket.on("connect_error",t=>{"TransportError"===(null==t?void 0:t.type)&&this.k()}),this.parent.socket.io.on("reconnect_failed",()=>{this._(!1,!0)})}_(t=!0,e=!1){this.parent.event.emit("socket:state",{connected:t,failed_reconnect:e})}k(){var t;(null==(t=this.parent.ioRelayRescueClient)?void 0:t.url)&&!0!==this.m&&!0!==this.v&&!0!==this.parent.socket.connected&&(this.v=!0,this.parent.socket.disconnect(),this.parent.socket.io.uri=this.parent.ioRelayRescueClient.url,this.parent.socket.io.opts.path=this.parent.ioRelayRescueClient.path,this.parent.event.emit("socket:rescued",{}))}}class ur{constructor(t){this.parent=t,this.h(),this.p()}bindTo(t,e,i,s=null,n=null){this.S=t,this.u=e,this.A=i,this.M=s,this.D=n,!0!==this.C?this.parent.stream.connect():this.j()}unbindFrom(){this.R(),this.parent.stream.disconnect()}reset(){this.h()}h(){this.C=!1,this.S=null,this.u=[],this.A={},this.M=null,this.D=null,this.$=null,this.O=null}p(){this.parent.stream.on("connect",()=>{this.C=!0,this.j()}),this.parent.stream.on("disconnect",()=>{this.C=!1,this.q()}),this.parent.stream.on("socket:bound",()=>{this.T()})}j(){if(this.$!==this.S||this.O!==this.u){this.$=this.S,this.O=this.u;let t=[];this.$&&t.push(this.$),this.parent.stream.emit("socket:bind",{ray:"client",events:this.O,rooms:t,context:this.A})}else this.T()}q(){null!==this.D&&this.D(),this.R(),this.$=null,this.O=null}T(){null!==this.M&&this.M(),this.R()}R(){this.S=null,this.u=[],this.A={},this.M=null,this.D=null}}const ar="crisp-client";class lr{constructor(t){this.parent=t,this.h()}init(){this.p()}update(t,e,i=function(){},s=function(){}){let n={ray:this.N(t),type:t,data:e};this.U.push(n.ray),this.I[n.ray]={success:i,error:s},this.parent.socket.emit("storage:sync:update",n),this.parent.event.emit("storage:sync:update",n)}getStampLocal(t,e=[]){let i=this.generateStoreKey(t,e);return"object"==typeof window.localStorage&&window.localStorage.getItem(i)||""}setStampLocal(t,e=[],i=""){let s=this.generateStoreKey(t,e);return"object"==typeof window.localStorage&&(window.localStorage.setItem(s,i),!0)}isSyncingStorage(){return this.U.length>0&&!0}reset(){this.clearLocalStorage(),this.h()}generateStoreKey(t,e=[]){let i=`${ar}/${t}`;return e.length>0&&(i+=`/${e.join("/")}`),i}clearLocalStorage(){let t=`${ar}/`;for(let e=window.localStorage.length-1;e>=0;e--){let i=window.localStorage.key(e);(null==i?void 0:i.startsWith(t))&&window.localStorage.removeItem(i)}}h(){this.P=1,this.B=0,this.I={},this.U=[]}p(){this.parent.socket.on("storage:sync:updated",Vs(this.L,this))}L(t){if("object"==typeof this.I[t.ray]){t.error?"function"==typeof this.I[t.ray].error&&this.I[t.ray].error():"function"==typeof this.I[t.ray].success&&this.I[t.ray].success(),delete this.I[t.ray];let e=this.U.indexOf(t.ray);-1!==e&&this.U.splice(e,1)}this.parent.event.emit("storage:sync:updated",t)}N(t){return`${t}/${Math.floor(1e5*Math.random())}/${this.B++}`}}const hr=1e3,cr=15e4,dr=["browsing:action:start","browsing:action:stop","browsing:action:heartbeat","browsing:assist:start","browsing:assist:stop","browsing:assist:heartbeat","browsing:assist:mouse","browsing:assist:scroll","browsing:assist:click"];class Dr{constructor(t){this.parent=t,this.h(),this.p(),this.H(),this.F(),this.J(),this.V(),this.K()}init(t,e,i){this.parent.Stream.bindTo(null,dr,{session_id:this.parent.Session._sessionId},()=>{-1===(this.parent.device.capabilities||[]).indexOf("browsing")||!0!==this.parent.Config._ignorePrivacy&&"1"===(null==navigator?void 0:navigator.doNotTrack)?(this.parent.stream.emit("client:browsing:request:decline",{}),this.G()):(this.Y=t.deps.treeMirror||null,this.W=!0,!0===t.resume?(this.parent.stream.emit("client:browsing:resume",{browsing_id:this.X}),this.Z(!0),!0===this.tt&&this.st(!0)):(this.Z(!0),this.parent.stream.emit("client:browsing:request:accept",{useragent:navigator.userAgent}))),"function"==typeof e&&e()},()=>{"function"==typeof i&&i()})}restoreBrowsingState(){this.X&&(!1===this.it()?this.et({resume:!0}):this.G())}toggleIgnoreScrollEvent(t=!1){this.ht=t}reset(){!0===this.tt&&this.G(),this.h(),this.nt()}h(){var t;if(this.parent.Schedule.clearInterval(this.rt),this.parent.Schedule.clearInterval(this.ot),this.parent.Schedule.clearInterval(this.lt),this.parent.Schedule.clearInterval(this.ct),"object"==typeof this.ut)for(let e in this.ut)this.parent.Schedule.clearTimeout(this.ut[e]);if("object"==typeof this.dt)for(let e in this.dt)this.parent.Schedule.clearTimeout(this.dt[e].deadTimeout);(null==(t=this.ft)?void 0:t.deferEvent)&&this.parent.Schedule.clearTimeout(this.ft.deferEvent),this.W=!1,this.X=null,this.tt=!1,this.gt=null,this.rt=null,this.ot=null,this.lt=null,this.ct=null,this.ht=!1,this._t=null,this.Y=null,this.wt=null,this.yt=0,this.ut={},this.vt=[],this.dt={assist:{ongoing:!1,lastHeartbeat:null,deadTimeout:null}},this.bt={x:0,y:0,lastX:0,lastY:0},this.kt={x:0,y:0,lastX:0,lastY:0},this.ft={lastCall:(new Date).getTime(),deferEvent:null}}St(){return this.parent.Storage.generateStoreKey("browsing",[this.parent.websiteId])}p(){this.parent.socket.on("browsing:request:initiate",Vs(this.et,this)),this.parent.stream.on("client:browsing:request:initiated",Vs(this.At,this)),this.parent.stream.on("client:browsing:action:start",Vs(this.Mt,this)),this.parent.stream.on("client:browsing:action:stop",Vs(this.Et,this)),this.parent.stream.on("client:browsing:action:heartbeat",Vs(this.Dt,this)),this.parent.stream.on("client:browsing:assist:start",Vs(this.Ct,this)),this.parent.stream.on("client:browsing:assist:stop",Vs(this.jt,this)),this.parent.stream.on("client:browsing:assist:heartbeat",Vs(this.Rt,this)),this.parent.stream.on("client:browsing:assist:mouse",Vs(this.$t,this)),this.parent.stream.on("client:browsing:assist:scroll",Vs(this.Ot,this)),this.parent.stream.on("client:browsing:assist:click",Vs(this.qt,this))}H(){if("object"!=typeof window.sessionStorage)return;let t=window.sessionStorage.getItem(this.St());if(!t)return;let e=JSON.parse(t);this.X=e.browsing_id||null,this.tt=e.is_playing||!1,this.gt=e.last_heartbeat||null}et(t){!0===this.W&&!0!==t.resume||(!0!==t.resume&&this.G(),this.parent.event.emit("browsing:request:initiate",t||{}))}At(t){!0===this.W&&(this.X=t.browsing_id,this.gt=(new Date).getTime(),this.xt())}Mt(){!0===this.W&&this.X&&this.st()}Et(){!0===this.W&&this.X&&this.G()}Dt(){!0===this.W&&this.X&&(this.gt=(new Date).getTime(),this.xt())}Ct(){!0===this.W&&this.X&&!0===this.Tt("assist")&&this.parent.event.emit("browsing:assist:started",{})}jt(){!0===this.W&&this.X&&!0===this.Nt("assist")&&this.parent.event.emit("browsing:assist:stopped",{})}Rt(){!0===this.W&&this.X&&this.Ut("assist")}$t(t){!0===this.W&&this.X&&!0===this.dt.assist.ongoing&&this.parent.event.emit("browsing:assist:mouse",t)}Ot(t){!0===this.W&&this.X&&!0===this.dt.assist.ongoing&&this.parent.event.emit("browsing:assist:scroll",t)}qt(t){!0===this.W&&this.X&&!0===this.dt.assist.ongoing&&this.parent.event.emit("browsing:assist:click",t)}xt(){"object"==typeof window.sessionStorage&&JSON&&"function"==typeof JSON.stringify&&window.sessionStorage.setItem(this.St(),JSON.stringify({browsing_id:this.X,is_playing:this.tt,last_heartbeat:this.gt}))}nt(){"object"==typeof window.sessionStorage&&"object"==typeof window.sessionStorage&&window.sessionStorage.removeItem(this.St())}st(t=!1){this.tt=!0,this.gt=(new Date).getTime(),this.xt(),this.It(),this.Pt(!0),this.Bt(!0),this.Lt(!0),!0!==t&&this.parent.stream.emit("client:browsing:action:started",{})}G(){let t=this.tt;this.wt&&this.wt.disconnect(),this.h(),this.xt(),!0===t&&this.parent.stream.emit("client:browsing:action:stopped",{}),this.parent.Stream.unbindFrom()}It(){this.Ht(),this.zt(),this.Ft(),this.wt&&this.wt.disconnect(),this.Y&&(this.wt=new this.Y(document,{initialize:(t,e)=>{this._t={f:"initialize",args:[t,e]},this.Jt(this._t)},applyChanged:(t,e,i,s)=>{this.vt.push({f:"applyChanged",args:[t,e,i,s]})}}))}Jt(t){if(t.f&&t.args&&"function"==typeof JSON.stringify){let e=this.yt,i=[],s=JSON.stringify(t.args);for(let t=0,n=s.length;t<n;t+=cr)i.push(s.substring(t,t+cr));for(let n=0;n<i.length;n++)this.parent.stream.emit("client:browsing:stream:mirror",{f:t.f,args:i[n],chunk:e,part:n,end:i.length-1});this.yt++}}zt(){this.parent.stream.emit("client:browsing:stream:tab",{title:document.title,url:document.location.href,width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight})}Ht(){this.parent.stream.emit("client:browsing:stream:mouse",{x:this.bt.x,y:this.bt.y})}Ft(){this.parent.stream.emit("client:browsing:stream:scroll",{x:this.kt.x,y:this.kt.y})}Vt(){this.parent.stream.emit("client:browsing:stream:click",{})}Tt(t){let e=!0!==this.dt[t].ongoing&&!0;return this.dt[t].ongoing=!0,this.Ut(t),this.parent.stream.emit(`client:browsing:${t}:started`,{}),e}Nt(t){return!0===this.dt[t].ongoing&&(this.Ut(t,!1),this.dt[t].ongoing=!1,this.parent.stream.emit(`client:browsing:${t}:stopped`,{}),!0)}Ut(t,e=!0){!0===this.dt[t].ongoing&&(null!==this.dt[t].deadTimeout&&(this.parent.Schedule.clearTimeout(this.dt[t].deadTimeout),this.dt[t].deadTimeout=null),!0===e?(this.dt[t].lastHeartbeat=(new Date).getTime(),this.dt[t].deadTimeout=this.parent.Schedule.setTimeout(()=>{this.Nt(t)},45e3)):this.dt[t].lastHeartbeat=null)}F(){this.parent.Listener.addEventListener("document","mousemove",t=>{this.bt.lastX=t.pageX,this.bt.lastY=t.pageY})}J(){this.parent.Listener.addEventListener("window","resize",()=>{null!==this.ft.deferEvent&&this.parent.Schedule.clearTimeout(this.ft.deferEvent),this.ft.deferEvent=this.parent.Schedule.setTimeout(()=>{this.ft.deferEvent=null;let t=this.ft.lastCall,e=(new Date).getTime();this.ft.lastCall=e,t&&e>t+hr&&!0===this.tt&&this.zt()},1e3)})}V(){this.parent.Listener.addEventListener("window","scroll",()=>{if(!0!==this.ht){let t=document.documentElement;this.kt.lastX=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),this.kt.lastY=(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}})}K(){this.parent.Listener.addEventListener("window","click",t=>{!0!==this.tt||t._from_crisp||this.Kt("click",()=>{this.Vt(),this.Ht()})})}it(){return null===this.gt||null!==this.gt&&(new Date).getTime()-this.gt>=45e3}Z(t=!0){null!==this.rt&&this.parent.Schedule.clearInterval(this.rt),!0===t&&(this.rt=this.parent.Schedule.setInterval(()=>{this.parent.stream.emit("client:browsing:heartbeat",{}),!0===this.it()&&this.G()},1e4))}Pt(t=!0){null!==this.lt&&(this.parent.Schedule.clearInterval(this.lt),this.lt=null),!0===t&&(this.lt=this.parent.Schedule.setInterval(()=>{this.bt.lastX===this.bt.x&&this.bt.lastY===this.bt.y||!0!==this.tt||(this.bt.x=this.bt.lastX,this.bt.y=this.bt.lastY,this.Ht())},hr))}Bt(t=!0){null!==this.ct&&(this.parent.Schedule.clearInterval(this.ct),this.ct=null),!0===t&&(this.ct=this.parent.Schedule.setInterval(()=>{this.kt.lastX===this.kt.x&&this.kt.lastY===this.kt.y||!0!==this.tt||(this.kt.x=this.kt.lastX,this.kt.y=this.kt.lastY,this.Ht(),this.Ft())},hr))}Lt(t=!0){null!==this.ot&&this.parent.Schedule.clearInterval(this.ot),!0===t&&(this.ot=this.parent.Schedule.setInterval(()=>{for(let t=0;t<this.vt.length&&!(t>=10);t++)this.Jt(this.vt[t]);this.vt.splice(0,10)},1e3))}Kt(t,e){void 0===this.ut[t]&&(this.ut[t]=this.parent.Schedule.setTimeout(()=>{delete this.ut[t],e()},500))}}const fr=["call:request:initiate","call:request:accepted","call:request:declined","call:action:stopped","call:signaling:sdp","call:signaling:candidate"];class pr{constructor(t){this.parent=t,this.h(),this.p()}init(t,e,i){this.parent.Stream.bindTo(null,fr,{session_id:this.parent.Session._sessionId},()=>{this.Gt=t.mode||null,this.Yt=t.ice||[],!0===t.has_support?(this.parent.stream.emit("client:call:request:initiated",{call_id:t.call_id}),this.Z(!0)):this.parent.stream.emit("client:call:request:decline",{}),"function"==typeof e&&e()},()=>{"function"==typeof i&&i()})}accept(){!0===this.W&&(this.Wt=!0,this.parent.stream.emit("client:call:request:accept",{}))}decline(){!0===this.W&&(this.parent.stream.emit("client:call:request:decline",{}),this.G())}stop(){!0===this.W&&(this.parent.stream.emit("client:call:action:stopped",{}),this.G())}toggleAudio(){return this.Xt("audio","getAudioTracks")}toggleVideo(){return this.Xt("video","getVideoTracks")}toggleScreensharing(){return!0===this.W&&null!==this.Qt.local&&(!1===this.Zt?this.ts():this.ss()),this.Zt}isOngoing(){return!0===this.W&&null!==this.es&&!0}hasSupportScreensharing(){return!(!navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getDisplayMedia)}getStream(t){return this.Qt[t]||null}reset(){!0===this.W&&this.G(),this.h()}h(){this.W=!1,this.Zt=!1,this.Wt=!1,this.hs=!1,this.es=null,this.rt=null,this.ns=null,this.Gt=null,this.Yt=[],this.Qt={local:null,remote:null},this.rs={video:null}}p(){this.parent.socket.on("call:request:initiate",Vs(this.et,this)),this.parent.stream.on("client:call:request:accepted",Vs(this.ls,this)),this.parent.stream.on("client:call:request:declined",Vs(this.cs,this)),this.parent.stream.on("client:call:action:stopped",Vs(this.us,this)),this.parent.stream.on("client:call:signaling:sdp",Vs(this.ds,this)),this.parent.stream.on("client:call:signaling:candidate",Vs(this.fs,this))}et(t){!0!==this.W&&(t.has_support=-1!==(this.parent.device.capabilities||[]).indexOf("call"),this.W=!0,this.parent.event.emit("call:request:initiate",t))}ls(){!0===this.W&&!0!==this.Wt&&this.G()}cs(){!0===this.W&&this.G()}us(){!0===this.W&&this.G()}ds(t){if(!0===this.W){if(this.ps(),"operator"!==t.from)return;this.es.setRemoteDescription(new RTCSessionDescription(t.sdp)).then(()=>(this.parent.event.emit("call:peer:remote:success",{}),null===this.Qt.local?this.gs():"offer"===t.sdp.type?this._s("answer"):Promise.resolve())).catch(()=>{this.parent.event.emit("call:peer:remote:error",{})})}}fs(t){if(!0===this.W){if(this.ps(),"operator"!==t.from)return;if("object"!=typeof t.candidate||null===t.candidate)return;this.es.addIceCandidate(new RTCIceCandidate({sdpMLineIndex:t.candidate.sdpMLineIndex,candidate:t.candidate.candidate})).catch(()=>{})}}ps(){null===this.es&&(this.es=new RTCPeerConnection({iceServers:this.Yt}),this.es.onicecandidate=t=>{t&&t.candidate&&this.parent.stream.emit("client:call:signaling:candidate",{from:"user",candidate:t.candidate})},this.es.ontrack=t=>{let e=t.streams[0];this.Qt.remote=e,this.parent.event.emit("call:media:remote:success",{}),e.onremovetrack=()=>{this.parent.event.emit("call:media:remote:success",{})}},this.es.oniceconnectionstatechange=()=>{let t=this.es;null!==t&&"failed"!==t.iceConnectionState&&"closed"!==t.iceConnectionState||this.ys(),null!==t&&"disconnected"===t.iceConnectionState&&(this.ns=this.parent.Schedule.setTimeout(()=>{this.ns=null,null!==this.es&&"connected"===t.iceConnectionState||this.ys()},5e3)),null!==t&&"connected"===t.iceConnectionState&&!0!==this.hs&&this.parent.Schedule.setTimeout(()=>{this.gs(!0)},200)},this.es.onnegotiationneeded=()=>{this._s("offer")},this.es.onclose=()=>{this.ys()})}gs(t=!1){let e=()=>{this.parent.event.emit("call:peer:local:error",{})};this.vs(i=>{navigator.mediaDevices.getUserMedia({audio:!0,video:"video"===this.Gt&&!0===i.video}).then(e=>(this.Qt.local=e,this.parent.event.emit("call:media:local:success",{retried:t||!1}),!0===t&&(this.hs=!0),this.bs(e,t))).catch(e)},e)}bs(t,e=!1){let i=t.getTracks();!0===e&&this.es.getSenders().forEach(t=>{t.track&&t.track.stop(),this.es.removeTrack(t)});for(let s=0;s<i.length;s++)this.es.addTrack(i[s],t);!0!==e&&this._s("answer")}vs(t,e){var i;let s={audio:!1,video:!1};(null==(i=navigator.mediaDevices)?void 0:i.enumerateDevices)?navigator.mediaDevices.enumerateDevices().then(i=>{for(let t=0;t<i.length;t++)switch(i[t].kind){case"audioinput":s.audio=!0;break;case"videoinput":s.video=!0}!0!==s.audio?e():t(s)}).catch(e):t(s)}_s(t="offer"){let e;return Promise.resolve().then(()=>{let e={OfferToReceiveAudio:!0,OfferToReceiveVideo:!0};return"answer"===t?this.es.createAnswer(e):this.es.createOffer(e)}).then(t=>(e=t,this.es.setLocalDescription(e))).then(()=>(this.parent.stream.emit("client:call:signaling:sdp",{from:"user",sdp:e}),this.parent.event.emit("call:peer:local:success",{}),Promise.resolve())).catch(()=>(this.parent.event.emit("call:peer:local:error",{}),Promise.resolve()))}G(){this.ys()}ys(){var t,e,i;if(null!==this.es){let s=this.es.getSenders();for(let e=0;e<s.length;e++)null==(t=s[e].track)||t.stop();null==(e=this.rs.video)||e.stop(),null==(i=this.es)||i.close(),this.es=null}null!==this.ns&&(this.parent.Schedule.clearTimeout(this.ns),this.ns=null),this.parent.Stream.unbindFrom(),this.W=!1,this.Zt=!1,this.Wt=!1,this.hs=!1,this.Gt=null,this.Yt=[],this.Qt.local=null,this.Qt.remote=null,this.rs.video=null,this.Z(!1),this.parent.event.emit("call:action:stopped",{})}Xt(t,e){let i=!1;if(!0===this.W&&null!==this.Qt.local){let s=!1,n=this.Qt.local[e]();for(let t=0;t<n.length;t++)s=!0,i=!n[t].enabled,n[t].enabled=i;if(!0===s){let e=!0===i?"started":"ended";this.parent.event.emit(`call:track:local:${e}`,{media:t})}}return i}ts(){!0===this.hasSupportScreensharing()&&(this.Zt=!0,navigator.mediaDevices.getDisplayMedia({video:!0}).then(t=>{var e;let i=t.getTracks()[0],s=this.es.getSenders(),n=null;for(let r=0;r<s.length;r++)if("video"===(null==(e=s[r].track)?void 0:e.kind)){n=s[r];break}null!==n?(this.rs.video=n.track,n.replaceTrack(i)):n=this.es.addTrack(i,this.Qt.local),i.onended=()=>{null!==this.es&&(this.ks(n),this.parent.event.emit("call:track:local:ended",{media:"screensharing"}))},this.parent.event.emit("call:track:local:started",{media:"screensharing"})}).catch(()=>{this.Zt=!1}))}ss(){var t;let e=this.es.getSenders(),i=null;for(let s=0;s<e.length;s++)if("video"===(null==(t=e[s].track)?void 0:t.kind)){i=e[s];break}null!==i&&(i.track.stop(),i.track.dispatchEvent(new Event("ended")))}ks(t){null!==this.rs.video?(t.replaceTrack(this.rs.video),this.rs.video=null):this.es.removeTrack(t),this.Zt=!1}Z(t=!0){null!==this.rt&&this.parent.Schedule.clearInterval(this.rt),!0===t&&(this.rt=this.parent.Schedule.setInterval(()=>{this.parent.stream.emit("client:call:heartbeat",{})},1e4))}}const mr=new RegExp(["(^(?:\\S+(?:(?:\\s+|\\?|\\!|\\.|\\(|\\)|:|;)|(?:[\\u4e00-\\u9fff])|(?:[\\u0e00-\\u0e7f])))+).*$"].join(""),"i");class _r{constructor(t){this.parent=t,this.h(),this.p()}updateMessage(t,e){let i={fingerprint:t,content:e};this.parent.socket.emit("message:update",i),this.Ss(i,"local")}sendRawMessage(t,e=0){let i=()=>{this.parent.socket.emit("message:send",t)};if(-1===this.As.indexOf(t.fingerprint)&&this.As.push(t.fingerprint),this.parent.platformName&&this.parent.platformSignatureKey){let e=[this.parent.Session._sessionId,t.fingerprint,t.type],i=this.parent.sha256.hmac.create(this.parent.platformSignatureKey.split("/").map(t=>String.fromCharCode(parseInt(t,36))).join(""));i.update(`[${e.join("|")}]`),t.signature=`${this.parent.platformName}:${i.hex()}`}this.parent.event.emit("message:send",t),this.parent.Schedule.setTimeout(()=>{this.parent.ticketGenerator?this.parent.ticketGenerator(this.parent.Session._sessionId,e=>{null!==e&&(t.ticket=e),i()}):i()},e)}sendTextMessage(t,e=0){this.sendRawMessage({type:"text",origin:"chat",content:t,timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},e)}sendFileMessage(t,e,i,s=0){this.sendRawMessage({type:"file",origin:"chat",content:{name:t,url:e,type:i},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},s)}sendAnimationMessage(t,e,i=0){this.sendRawMessage({type:"animation",origin:"chat",content:{url:t,type:e},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},i)}sendAudioMessage(t,e,i,s=0){this.sendRawMessage({type:"audio",origin:"chat",content:{url:t,type:e,duration:i},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},s)}sendPickerMessage(t,e,i,s=0){this.sendRawMessage({type:"picker",origin:"chat",content:{id:t,text:e,choices:i},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},s)}sendFieldMessage(t,e,i,s=0){this.sendRawMessage({type:"field",origin:"chat",content:{id:t,text:e,explain:i},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},s)}sendCarouselMessage(t,e,i=0){this.sendRawMessage({type:"carousel",origin:"chat",content:{text:t,targets:e},timestamp:(new Date).getTime(),fingerprint:this.generateFingerprint()},i)}sendMessageCompose(t,e=null){(!0!==this.parent.Config._ignorePrivacy&&"1"===(null==navigator?void 0:navigator.doNotTrack)||!1===this.parent.Config._visitorCompose)&&(e=null),e=this.Ms(e);let i=t!==this.Es.local.type&&!0;(!0===i||e!==(this.Es.local.excerpt||null)||"start"===this.Es.local.type&&this.Ds&&(new Date).getTime()-this.Ds>=6e4)&&(this.Ds=(new Date).getTime(),this.Es.local={type:t},e&&(this.Es.local.excerpt=e),!0===i&&null!==this.Cs&&(this.parent.Schedule.clearTimeout(this.Cs),this.Cs=null),null===this.Cs&&(this.Cs=this.parent.Schedule.setTimeout(()=>{this.Cs=null,this.parent.socket.emit("message:compose:send",this.Es.local),this.parent.event.emit("message:compose:send",this.Es.local)},!0===i?0:6e3)))}sendMessageThread(t,e=""){let i={type:t};e&&(i.text=e),this.parent.socket.emit("message:thread",i),this.parent.event.emit("message:thread",i)}receiveMessageLocal(t,e,i,s=null){let n={from:"operator",type:t,origin:"local",timestamp:(new Date).getTime(),content:e,fingerprint:null!==s?s:this.generateFingerprint(),user:i};this.parent.socket.emit("message:received:local",n),this.js(n)}receiveMessageMirror(t,e,i,s){let n={from:"operator",type:t,origin:e,timestamp:(new Date).getTime(),content:i,fingerprint:s};this.parent.socket.emit("message:received:mirror",n)}getMessageCompose(){this.parent.event.emit("message:compose:received",this.Es.remote)}getCachedMessages(){return this.Rs}countMessageHistory(){return this.Rs.length}countMessageHistoryDiff(){return this.$s.length}getMessageHistory(){if(this.Rs.length>0){for(let t=0;t<this.Rs.length;t++)this.Rs[t].origin="history";this.parent.event.emit("history:messages",this.Rs)}for(let t=0;t<this.$s.length;t++)this.Os(this.$s[t],"diff");this.$s=[]}isSendingMessages(){return this.As.length>0}markMessagesAsRead(t=!0){!0===this.qs(void 0,void 0,t)&&this.xs()}setMessagesInView(t){this.Ts=t,this.markMessagesAsRead(!1)}getUnreadMessages(){this.Ns=-1,this.Us()}setUnreadMessagesCallback(t){this.Is=t}generateFingerprint(){let t=String((new Date).getTime())+Math.ceil(100*Math.random());return t.length<15&&(t+=new Array(15-t.length+1).join("0")),t=parseInt(t,10),t}reset(){this.h()}storageSessionMessageHandle(t){this._restoreMessages(t)}syncMessageComposeDiff(t){t&&(this.Es.remote=t)}syncMessageHistoryDiff(t){if(t){this.Ps(t);for(let e=0;e<t.length;e++)this.$s.push(t[e]);this.Us()}}_restoreMessages(t){t||(t=[]),this.Rs=t,this.Bs=[],this.Ps(this.Rs);for(let e=0;e<this.Rs.length;e++){let i=this.Rs[e];this.Bs.push(i.fingerprint),t[e].is_me||i.read||this.Ls.push(i.fingerprint)}this.Us()}h(){this.Rs=[],this.Bs=[],this.$s=[],this.Ls=[],this.As=[],this.Hs=[],this.Cs=null,this.Ts=!1,this.Is=function(){},this.Ns=-1,this.Ds=0,this.Es={local:{type:"stop"},remote:{type:"stop"}}}p(){this.parent.socket.on("message:updated",Vs(this.Ss,this)),this.parent.socket.on("message:sent",Vs(this.zs,this)),this.parent.socket.on("message:received",Vs(this.Fs,this)),this.parent.socket.on("message:received:local",Vs(this.js,this)),this.parent.socket.on("message:removed",Vs(this.Js,this)),this.parent.socket.on("message:compose:received",Vs(this.Vs,this)),this.parent.socket.on("message:acknowledge:read:send",Vs(this.Ks,this)),this.parent.socket.on("message:acknowledge:read:received",Vs(this.Gs,this)),this.parent.socket.on("message:acknowledge:pending",Vs(this.Ys,this)),this.parent.socket.on("message:error:rejected",Vs(this.Ws,this))}Ms(t){let e=null;if(null!==t){let i=t.match(mr);i&&(e=(i[1]||"").trim())}return e}Xs(t){this.parent.socket.emit("message:acknowledge:pending",{origin:"chat",fingerprints:t}),this.parent.socket.emit("message:acknowledge:delivered",{origin:"chat",fingerprints:t})}Qs(t){this.parent.socket.emit("message:acknowledge:read:received",{origin:"chat",fingerprints:t})}Zs(t,e){let i=!1;!1===e&&(this.Ls=[],this.Us());for(let s=0;s<this.Rs.length;s++){let n=this.Rs[s];!0===n.read||0!==t.length&&-1===t.indexOf(n.fingerprint)||e===(!0===n.is_me)&&(n.read=!0,i=!0,this.ti(n))}return i}qs(t=[],e=!1,i=!1){let s=e||!1;return!1===e&&(!0===i||!0===this.Ts)&&this.Ls.length>0&&(this.Qs(this.Ls),s=!0),!0===s&&this.Zs(t,e)}xs(t=null,e=null){if(this.Hs.length>0){let i=[];for(let t=0;t<this.Rs.length;t++){let e=this.Rs[t];-1!==this.Hs.indexOf(e.fingerprint)&&(delete e.index,i.push(e))}this.Hs=[],this.parent.Storage.update("message",i,t,e)}else"function"==typeof t&&t()}si(t,e=null,i=null){null===this.ii(t.fingerprint)?(this.Bs.push(t.fingerprint),this.Rs.push(t),this.qs(),this.ti(t),this.xs(e,i)):"function"==typeof e&&e()}ei(t,e=null,i=null){let s=this.Bs.indexOf(t.fingerprint);-1!==s?(this.ti(t),this.xs(()=>{this.Bs.splice(s,1),this.Rs.splice(s,1);let i=this.Ls.indexOf(t.fingerprint);-1!==i&&(this.Ls.splice(i,1),this.Us()),"function"==typeof e&&e()},i)):"function"==typeof e&&e()}ii(t){let e=this.Bs.indexOf(t);return e>=0&&this.Rs[e]||null}ti(t){-1===this.Hs.indexOf(t.fingerprint)&&this.Hs.push(t.fingerprint)}Ps(t){t.sort((t,e)=>t.timestamp<e.timestamp?-1:t.timestamp>e.timestamp?1:0)}Os(t,e){t.is_me?this.zs(t,e):this.Fs(t,e)}Us(t=[]){let e=this.Ls.length;e!==this.Ns&&(this.Ns=e,"function"==typeof this.Is&&this.Is(e,this.Ls,[].concat(this.Rs,t)))}Ss(t,e="network"){let i=this.ii(t.fingerprint);null!==i&&(i.content=t.content,i.edited=!0,this.Os(i,"update"),"local"!==e&&(this.ti(i),this.xs()))}zs(t,e="network"){let i=this.As.indexOf(t.fingerprint);-1!==i&&this.As.splice(i,1);let s=t.origin;t.origin=e,t.index={current:1,total:1},this.si(t,()=>{"chat"===s||"network"!==e&&"diff"!==e||this.Xs([t.fingerprint]),this.parent.event.emit("message:sent",t)}),1===this.countMessageHistory()&&this.parent.Session.triggerEmailKeepAlive()}Fs(t,e="network",i="message:received"){t.origin=e,t.index={current:1,total:1},"update"!==e&&(this.Ls.push(t.fingerprint),this.Us([t])),this.si(t,()=>{"network"!==e&&"diff"!==e||this.Xs([t.fingerprint]),this.parent.event.emit(i,t)})}js(t){this.Fs(t,"local","message:received:local")}Js(t){let e=this.ii(t.fingerprint);null!==e&&(e.removed=!0,this.ei(e,()=>{this.parent.event.emit("message:removed",e)}))}Vs(t){this.Es.remote=t,this.parent.event.emit("message:compose:received",t)}Ks(t){!0===this.qs(t.fingerprints,!0)&&this.xs(),this.parent.event.emit("message:acknowledge:read:send",t.fingerprints)}Gs(t){for(let e=0;e<t.fingerprints.length;e++){let i=this.Ls.indexOf(t.fingerprints[e]);-1!==i&&this.Ls.splice(i,1)}this.Us()}Ys(t){this.parent.event.emit("message:acknowledge:pending",t.fingerprints)}Ws(t){let e=this.As.indexOf(t.fingerprint);-1!==e&&this.As.splice(e,1),this.parent.event.emit("message:error:rejected",t)}}const Fr=3e5,gr=["email","phone","nickname","avatar","company"],vr=new RegExp("^(https?\\:\\/\\/[^/]+)\\/chat\\/resume\\/\\?target_url=(.+)&session_id=(.+)$"),wr=/^\?.*(crisp_sid=([^&=]+)).*$/,br=/(\?.*)(crisp_sid=[^&=]+&?)(.*)$/;class yr{constructor(t){this.parent=t,this.h(),this.p()}save(){let t={domain:this.hi(),expires:this.ni()},e=this.ri();t.sameSite=e.policy,!0===e.secure&&(t.secure=!0),this.parent.Register.set(this.St(),this._sessionId,t),this.parent.tokenId&&this.parent.Register.set(this.St(this.parent.tokenId),this._sessionId,t),this.parent.event.emit("session:saved",this._sessionId)}storageSessionRetrieve(t){this.oi(t.state),this.parent.Message.storageSessionMessageHandle(t.message)}syncSessionDiff(t){this.parent.Message.syncMessageComposeDiff(t.compose),this.parent.Message.syncMessageHistoryDiff(t.messages)}syncUserData(t){for(let e=0;e<gr.length;e++){let i=gr[e];if(this.ai[i]&&this.ai[i]!==t[i]){let t=`set${i.charAt(0).toUpperCase()+i.slice(1)}`;"function"==typeof this[t]&&this[t](this.ai[i],!0,this.li[i])}else this.ai[i]=t[i]||null}this.ci(t.segments||[],this.ai.segments),this.ui(t.data||{},this.ai.data)}sendDevice(){let t=this.di();null!==t&&this.parent.socket.emit("session:device",t)}sendEvent(t=[]){let e={events:[]};for(let i=0;i<t.length;i++){let s=t[i],n={text:s[0]};null!==s[1]&&(n.data=s[1]),null!==s[2]&&(n.color=s[2]),e.events.push(n)}e.events.length>0&&this.parent.socket.emit("session:event",e)}sendFeedbackRate(t,e=null){let i={rating:{stars:t}};null!==e&&(i.rating.comment=e),this.parent.socket.emit("session:feedback:rate",i),this.parent.event.emit("session:feedback:rate",i)}sendPluginAction(t,e){let i={urn:t,data:e};this.parent.socket.emit("session:plugin:action",i),this.parent.event.emit("session:plugin:action",i)}getRequestInitiate(t=null){Object.keys&&0===Object.keys(this.fi).length&&this.parent.Message.countMessageHistoryDiff()>0&&this.pi({}),"function"==typeof t&&t()}getState(t=null){this.handleState(this.fi,t)}handleState(t,e=null){this.fi=t,this.parent.event.emit("session:state",this.fi),"function"==typeof e&&e()}setState(t,e=null){for(let i in t)this.fi[i]=t[i];this.parent.Storage.update("state",t),this.syncState(t,e)}syncState(t,e=null){this.parent.socket.emit("session:state",t),"function"==typeof e&&e()}create(){let t={website_id:this.parent.websiteId,website_domain:this.parent.websiteDomain,useragent:this.parent.device.useragent||"",timezone:this.parent.device.timezone||0,capabilities:this.parent.device.capabilities||[],locales:this.parent.device.locales||[]};this.parent.tokenId&&(t.token_id=this.parent.tokenId),this.parent.socket.emit("session:create",t)}getEmail(){return this.ai.email}setEmail(t,e=!1,i=null){let s={};if(null!==i){let t=typeof i;"string"===t?s.verify=i:"object"===t&&(s=i)}!0===this.gi("email",t,e,s)&&this.triggerEmailKeepAlive()}getPhone(){return this.ai.phone}setPhone(t,e=!1){this.gi("phone",t,e)}getNickname(){return this.ai.nickname}setNickname(t,e=!1){this.gi("nickname",t,e)}getAvatar(){return this.ai.avatar}setAvatar(t,e=!1){this.gi("avatar",t,e)}getCompany(){return this.ai.company}setCompany(t,e=!1){this.gi("company",t,e)}getData(t=null){return null===t?this.ai.data:this.ai.data[t]||null}setData(t){if(this._i.data=this._i.data||{},t)for(let e in t)this._i.data[e]=t[e];this.wi("data",()=>{this.ui(this.ai.data||{},this._i.data),delete this._i.data})}setSegments(t,e=!1){if(!0===e)this._i.segments=t||[];else if(this._i.segments=this._i.segments||[],t)for(let i=0;i<t.length;i++)this._i.segments.push(t[i]);this.wi("segments",()=>{this.ci(this.ai.segments||[],this._i.segments,e),delete this._i.segments},e||!1)}markActive(){let t=(new Date).getTime();t-Math.min(this.mi||t,this.gt||t)>=9e4&&this.Z(!0),this.mi=t}acquireSaved(){let t=this.yi(),e=null,i=(location.search||"").match(wr),s=(document.referrer||"").match(vr);i&&i[2]&&i[2]!==t.current&&(e=i[2]||null),s&&s[1]===this.parent.urlGo&&s[3]!==t.current&&(e=s[3]||null);let n=e||t.current,r=null;return t.previous&&t.current!==t.previous&&t.current===n&&(r=t.previous),{session_id:n,merge:r}}restore(){let t=this.acquireSaved();this.bi(t.session_id,t.merge)}join(t=!1){let e={website_id:this.parent.websiteId,session_id:this._sessionId,expire:Fr,storage:!0,sync:t,useragent:this.parent.device.useragent||"",timezone:this.parent.device.timezone||0,capabilities:this.parent.device.capabilities||[],locales:this.parent.device.locales||[]};if(!this.ki){let t=this.di();null!==t&&(e.device=t)}null!==this._sessionIdMerge&&(e.merge={session_id:this._sessionIdMerge}),this.parent.socket.emit("session:join",e)}reset(t=null,e=null){let i=null;try{for(let t in this.parent){let e=this.parent[t];e!==this&&e&&"object"==typeof e&&"function"==typeof e.reset&&e.reset()}this.Si()}catch(s){i=s}i?"function"==typeof e&&e(i):"function"==typeof t&&t()}triggerEmailKeepAlive(){this.ai.email&&(this.Ai&&this.parent.Schedule.clearTimeout(this.Ai),this.Ai=this.parent.Schedule.setTimeout(()=>{this.Ai=null,this.Z(!0)},5e3))}h(){if("object"==typeof this.ut)for(let t in this.ut)this.parent.Schedule.clearTimeout(this.ut[t]);this._sessionId=null,this._sessionIdMerge=null,this.ki=!1,this.mi=0,this.gt=(new Date).getTime(),this.Mi=null,this.Ai=null,this.Ei=null,this.Di=null,this.ai={},this.li={},this.fi={},this.ut={},this._i={}}p(){this.parent.socket.on("session:created",Vs(this.Ci,this)),this.parent.socket.on("session:joined",Vs(this.ji,this)),this.parent.socket.on("session:state",Vs(this.Ri,this)),this.parent.socket.on("session:error",Vs(this.$i,this)),this.parent.socket.on("session:request:initiate",Vs(this.pi,this)),this.parent.socket.on("session:request:purge",Vs(this.Oi,this)),this.parent.socket.on("session:request:feedback",Vs(this.qi,this)),this.parent.socket.on("session:feedback:rated",Vs(this.xi,this)),this.parent.socket.on("connect",()=>{this.ki?this.join(!0):this.restore()})}Ci(t){if(t.error)this.parent.event.emit("session:created",{error:t.error});else{let e=!!this.parent.tokenId;this._sessionId=t.session_id,this.save(),this.join(e),this.parent.event.emit("session:created",{session_id:this._sessionId})}}ji(t){t.error?this.parent.event.emit("session:joined",{error:t.error}):(this.ki||(this.ki=!0),this.parent.Website.setUsersAvailable(t.users_available),this.storageSessionRetrieve(t.storage||{}),this.syncSessionDiff(t.sync||{}),this.syncUserData(t),this.parent.Browsing.restoreBrowsingState(),this.parent.event.emit("session:joined",t),this.Ti(t.last_active))}Ri(t){this.handleState(t)}$i(t){"email:invalid_format"===t.type&&(delete this.ai.email,delete this.li.email),this.parent.event.emit("session:error",t)}pi(t){this.parent.event.emit("session:request:initiate",t)}Oi(t){this.parent.event.emit("session:request:purge",t)}qi(t){this.parent.event.emit("session:request:feedback",t)}xi(t){this.parent.event.emit("session:feedback:rated",t)}Si(){this.h();let t={domain:this.hi()};this.parent.Register.expire(this.St(),t),this.parent.tokenId&&this.parent.Register.expire(this.St(this.parent.tokenId),t)}yi(){var t;let e={previous:null,current:null};return this.parent.tokenId?(!0===(null==(t=this.parent.runtimeConfiguration)?void 0:t.session_merge)&&(e.previous=this.parent.Register.get(this.St())||null),e.current=this.parent.Register.get(this.St(this.parent.tokenId))||null):e.current=this.parent.Register.get(this.St())||null,e}bi(t,e=null){null!==e&&(this._sessionIdMerge=e),t?(this._sessionId=t,this.save(),this.join(!0)):this.create()}oi(t){this.fi=t||{}}Z(t=!1){this.Mi&&(this.parent.Schedule.clearTimeout(this.Mi),this.Mi=null),!0===t?(this.Ni(),this.Z()):this.Mi=this.parent.Schedule.setTimeout(()=>{this.Mi=null,this.Ni(),this.Z()},24e4)}Ti(t=0){this.mi=t||(new Date).getTime(),this.Z()}Ni(){!0===this.parent.socket.connected&&(this.gt=(new Date).getTime(),this.parent.socket.emit("session:heartbeat",{last_active:this.mi||0,availability:{type:"online",time:{for:Fr}}}))}di(){let t=document.location.href||"";if(this.Ei!==t){this.Ei=t;let e=(new Date).getTime();if(e-(this.Di||0)>=3e3){this.Di=e;let i=document.title||"";if(i.length>80&&(i=i.substring(0,77),i+="..."),!0===br.test(t)){t=t.replace(br,"$1$3");let e=t[t.length-1];"?"!==e&&"&"!==e||(t=t.substr(0,t.length-1))}if(t.length>240&&(t=t.split("?")[0]||""),t&&i&&t.length<=240){let e={page_url:t,page_title:i},s=(document.referrer||"").split("?")[0]||"";return(null==s?void 0:s.length)<=240&&s&&(e.page_referrer=s),e}}}return null}St(t=null){let e=[this.parent.websiteId];return t&&e.push(t),this.parent.Storage.generateStoreKey("session",e)}ni(){return"number"==typeof this.parent.cookieExpire&&this.parent.cookieExpire>0?this.parent.cookieExpire:15768e3}hi(){return"string"==typeof this.parent.cookieDomain&&this.parent.cookieDomain?this.parent.cookieDomain:this.Ui()}ri(){return!0===this.parent.runtimeConfiguration.cross_origin_cookies&&"https:"===document.location.protocol?{policy:"none",secure:!0}:{policy:"lax"}}Ui(){let t=document.domain,e=t,i="",s=this.ri(),n=`samesite=${s.policy};`+(!0===s.secure?"secure;":"");try{let t=0,i=e.split("."),s=this.parent.Storage.generateStoreKey("domain-detect",[`${(new Date).getTime()}`]);for(;t<i.length-1&&-1===document.cookie.indexOf(`${s}=${s}`);)e=i.slice(-1-++t).join("."),document.cookie=`${s}=${s};domain=${e};${n}`;document.cookie=`${s}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=${e};${n}`}catch{}finally{i=e||t}return i}gi(t,e,i=!1,s={}){let n=!1;if(!0===i?n=!0:e instanceof Object?!1===this.Ii(this.ai[t],e)&&(n=!0):this.ai[t]!==e&&(n=!0),!0===n&&(this.ai[t]=e,this.li[t]=s,!0===this.ki)){let i={};i[t]=e;for(let t in s)i[t]=s[t];return this.parent.socket.emit(`session:set_${t}`,i),!0}return!1}ci(t,e=[],i=!1){let s,n=[];for(let r=0;r<e.length;r++){let i=(e[r]||"").trim().toLowerCase();i&&(!0===["'",'"'].includes(i[0])&&i[i.length-1]===i[0]&&(i=i.slice(1,i.length-1)),i&&-1===t.indexOf(i)&&n.push(i))}if(!0===i?n.length>0||t.length!==e.length?(s=[].concat(e),this.ai.segments=s):s=[]:(s=n,this.ai.segments=t.concat(s)),s.length>0&&!0===this.ki){let t={segments:s};!0===i&&(t.overwrite=!0),this.parent.socket.emit("session:set_segments",t)}}ui(t,e={}){let i=!1,s={};for(let n in e)t[n]!==e[n]&&(i=!0,s[n]=e[n]);this.ai.data=t;for(let n in s)this.ai.data[n]=s[n];!0===i&&!0===this.ki&&this.parent.socket.emit("session:set_data",{data:s})}Ii(t,e){if(t instanceof Object&&e instanceof Object){let i={};for(let e in t)i[e]=!0;for(let t in e)i[t]=!0;let s=!0;for(let n in i)if(!1===this.Ii(t[n],e[n])){s=!1;break}return s}return t===e&&!0}wi(t,e,i=!1){!0===i?(void 0!==this.ut[t]&&(this.parent.Schedule.clearTimeout(this.ut[t]),delete this.ut[t]),e()):void 0===this.ut[t]&&(this.ut[t]=this.parent.Schedule.setTimeout(()=>{delete this.ut[t],e()},500))}}class Er{constructor(t){this.parent=t,this.h(),this.p()}getUsersAvailable(){this.Pi(!1)}setUsersAvailable(t){this.Bi=t}reset(){this.h()}h(){this.Bi=!1}p(){this.parent.socket.on("website:users:available",Vs(this.Li,this))}Li(t){"boolean"==typeof t&&(this.setUsersAvailable(t),this.Pi(!0))}Pi(t=!1){this.parent.event.emit("website:users:available",{available:this.Bi,changed:t})}}class Cr{constructor(t){this.parent=t,this.p()}getUrlUpload(t,e){let i={id:`${(new Date).getTime()}`,from:"visitor",file:{name:t,type:e}};this.parent.socket.emit("bucket:url:upload:generate",i),this.parent.event.emit("bucket:url:upload:generate",i)}p(){this.parent.socket.on("bucket:url:upload:generated",Vs(this.Hi,this))}Hi(t){this.parent.event.emit("bucket:url:upload:generated",t)}}class kr{constructor(t){this.parent=t,this.p()}getAnimationList(t=null,e=1){let i={id:(new Date).getTime(),from:"visitor",list:{page:e}};t&&(i.list.query=t),this.parent.socket.emit("media:animation:list",i),this.parent.event.emit("media:animation:list",i)}p(){this.parent.socket.on("media:animation:listed",Vs(this.zi,this))}zi(t){this.parent.event.emit("media:animation:listed",t)}}class $r{constructor(t){this.parent=t,this.h(),this.p()}getOverlayAnswerSearch(t,e=null){var i;if(t){let s=(null==(i=this.Fi[e||"default"])?void 0:i[this.Ji(t)])||null,n="overlay:answer:search",r={id:(new Date).getTime(),from:"visitor",search:{query:t,locale:e}};this.parent.event.emit(n,r),(null==s?void 0:s.processed)&&(null==s?void 0:s.sources)?this.parent.Schedule.setTimeout(()=>{this.Vi({id:r.id,result:s.processed,search:{query:t}}),this.Ki({id:r.id,result:s.sources,search:{query:t}})},100):this.parent.socket.emit(n,r)}}getOverlayCategorySuggest(t){if(t){let e=this.Gi[this.Ji(t)]||null,i="overlay:category:suggest",s={id:(new Date).getTime(),from:"visitor",suggest:{query:t}};this.parent.event.emit(i,s),(null==e?void 0:e.sources)?this.parent.Schedule.setTimeout(()=>{this.Yi({id:s.id,result:e.sources,suggest:{query:t}})},100):this.parent.socket.emit(i,s)}}reset(){this.h()}h(){this.Fi={},this.Gi={}}p(){this.parent.socket.on("overlay:answer:search:partial",Vs(this.Wi,this)),this.parent.socket.on("overlay:answer:search:processed",Vs(this.Vi,this)),this.parent.socket.on("overlay:answer:search:sources",Vs(this.Ki,this)),this.parent.socket.on("overlay:category:suggest:sources",Vs(this.Yi,this))}Ji(t){return t.trim().toLowerCase()}Wi(t){this.parent.event.emit("overlay:answer:search:partial",t)}Vi(t){if(t.result){let e=null!==t.result.text&&!0;this.Xi("processed","result",t,e)}}Ki(t){t.result&&this.Xi("sources","result",t)}Xi(t,e,i,s=!0){if(!0===s){let s=this.Fi;if(i.search&&"string"==typeof i.search.query){let n=i.search.locale||"default",r=this.Ji(i.search.query);n in s||(s[n]={}),r in s[n]||(s[n][r]={}),s[n][r][t]=i[e]}}this.parent.event.emit(`overlay:answer:search:${t}`,i)}Yi(t){if(t.result){let e=this.Gi;if(t.suggest&&"string"==typeof t.suggest.query){let i=this.Ji(t.suggest.query);i in e||(e[i]={}),e[i].sources=t.result}this.parent.event.emit("overlay:category:suggest:sources",t)}}}class Br{constructor(t){this.parent=t,this.h(),this.p()}getArticleSearch(t,e=null){return this.Qi("search",this.Zi,"query",Vs(this.te,this),t,e)}getArticleSuggest(t,e=null){return this.Qi("suggest",this.se,"part",Vs(this.ie,this),t,e)}reportArticleSearch(t,e=""){if(e=(e||"").trim()){let i={report:{locale:t,query:e}};this.parent.socket.emit("helpdesk:article:report",i),this.parent.event.emit("helpdesk:article:report",i)}}reset(){this.h()}h(){this.Zi={},this.se={}}p(){this.parent.socket.on("helpdesk:article:searched",Vs(this.te,this)),this.parent.socket.on("helpdesk:article:suggested",Vs(this.ie,this))}te(t){return this.ee("search",this.Zi,"query",t)}ie(t){return this.ee("suggest",this.se,"part",t)}Qi(t,e,i,s,n,r=null){var o;let u=null==(o=e[r||"default"])?void 0:o[n],a=`helpdesk:article:${t}`,l={id:(new Date).getTime(),from:"visitor",[t]:{locale:r,[i]:n}};this.parent.event.emit(a,l),u?this.parent.Schedule.setTimeout(()=>{s({id:l.id,results:u,[t]:{locale:r,[i]:n}})},100):this.parent.socket.emit(a,l)}ee(t,e,i,s){if(s[t]&&"string"==typeof s[t][i]){let n=s[t].locale||"default";e[n]=e[n]||{},e[n][s[t][i]]=s.results}this.parent.event.emit(`helpdesk:article:${t}ed`,s)}}class Ar{constructor(t){this.parent=t}fired(t,e){let i={identifier:t,name:e};this.parent.socket.emit("trigger:fired",i),this.parent.event.emit("trigger:fired",i)}}class xr{constructor(t){this.parent=t,this.h()}configure(t){this._stateProject=t.project,this._stateRevision=t.revision,this._stateEnvironment=t.environment,this._stateUseragent=t.useragent,this._statePage=t.page}report(t,e,i){if(!(this._stateProject&&this._stateRevision&&this._stateEnvironment&&this._stateUseragent&&this._statePage))throw new Error("Missing a configuration parameter. Did you call configure() before?");"object"==typeof i&&i instanceof Error&&(i={fileName:i.fileName,lineNumber:i.lineNumber,columnNumber:i.columnNumber,message:i.message,stack:i.stack});let s={project:this._stateProject,revision:this._stateRevision,environment:this._stateEnvironment,useragent:this._stateUseragent,page:this._statePage,level:t,namespace:e,traceback:i};this.parent.socket.emit("issue:report",s),this.parent.event.emit("issue:report",s)}h(){this._stateProject=null,this._stateRevision=null,this._stateEnvironment=null,this._stateUseragent=null,this._statePage=null}}const Sr=/^((?:https?|wss?):\/\/[^/]+)(\/.*)?$/;const zr=new class{constructor(){this.socket=null,this.stream=null,this.cookie=null,this.sha256=null,this.event=null,this.Storage=new lr(this),this.Schedule=new nr(this),this.Listener=new rr(this),this.Config=new ir(this),this.Register=new sr(this)}init(t){this.he(),this.ne(t),this.re(t),this.Socket=new or(this),this.Stream=new ur(this),this.Browsing=new Dr(this),this.Call=new pr(this),this.Message=new _r(this),this.Session=new yr(this),this.Website=new Er(this),this.Bucket=new Cr(this),this.Media=new kr(this),this.Overlay=new $r(this),this.Helpdesk=new Br(this),this.Trigger=new Ar(this),this.Issue=new xr(this),this.Storage.init(),this.u(),!0===t.connectSocket&&this.socket.connect()}he(){this.h(),this.oe()}h(){delete this.environment,delete this.urlGo,delete this.websiteDomain,delete this.websiteId,delete this.tokenId,delete this.cookieExpire,delete this.cookieDomain,delete this.platformName,delete this.platformSignatureKey,delete this.ticketGenerator,delete this.runtimeConfiguration,delete this.device,delete this.ioRelayClient,delete this.ioRelayStream,delete this.ioRelayRescueClient,this.ae=!1,this.le=!1}ne(t){(null==t?void 0:t.environment)&&(this.environment=t.environment||"development"),(null==t?void 0:t.urlGo)&&(this.urlGo=t.urlGo),(null==t?void 0:t.websiteDomain)&&(this.websiteDomain=t.websiteDomain),(null==t?void 0:t.websiteId)&&(this.websiteId=t.websiteId),(null==t?void 0:t.tokenId)&&(this.tokenId=t.tokenId),(null==t?void 0:t.cookieExpire)&&(this.cookieExpire=t.cookieExpire),(null==t?void 0:t.cookieDomain)&&(this.cookieDomain=t.cookieDomain),(null==t?void 0:t.platformName)&&(this.platformName=t.platformName),(null==t?void 0:t.platformSignatureKey)&&(this.platformSignatureKey=t.platformSignatureKey),(null==t?void 0:t.ticketGenerator)&&(this.ticketGenerator=t.ticketGenerator),(null==t?void 0:t.runtimeConfiguration)&&(this.runtimeConfiguration=t.runtimeConfiguration),this.device={},(null==t?void 0:t.useragent)&&(this.device.useragent=t.useragent),(null==t?void 0:t.timezone)&&(this.device.timezone=t.timezone),(null==t?void 0:t.capabilities)&&(this.device.capabilities=t.capabilities),(null==t?void 0:t.locales)&&(this.device.locales=t.locales)}re(t){let e=["websocket"];var i;this.ioRelayClient=this.ce(t.urlRelayClient),this.ioRelayStream=this.ce(t.urlRelayStream),this.ioRelayRescueClient=this.ce(t.urlRelayRescueClient),this.event={all:i=i||new Map,on:function(t,e){var s=i.get(t);s?s.push(e):i.set(t,[e])},off:function(t,e){var s=i.get(t);s&&(e?s.splice(s.indexOf(e)>>>0,1):i.set(t,[]))},emit:function(t,e){var s=i.get(t);s&&s.slice().map(function(t){t(e)}),(s=i.get("*"))&&s.slice().map(function(i){i(t,e)})}},this.socket=Pn(this.ioRelayClient.url,{path:this.ioRelayClient.path,transports:e,autoConnect:!1,timeout:25e3,reconnectionDelay:15e3,reconnectionDelayMax:6e4,reconnectionAttempts:5,randomizationFactor:.5}),this.stream=Pn(this.ioRelayStream.url,{path:this.ioRelayStream.path,transports:e,reconnection:!1,autoConnect:!1}),this.cookie=er,this.sha256=Zn}u(){this.ue(),this.Listener.addEventListener("window","pagehide",()=>{this.ae=this.socket.connected||!1,this.le=this.stream.connected||!1,!0===this.socket.connected&&this.socket.disconnect(),!0===this.stream.connected&&this.stream.disconnect()}),this.Listener.addEventListener("window","pageshow",()=>{!0===this.ae&&(this.ae=!1,this.socket.connect()),!0===this.le&&(this.le=!1,this.stream.connect())}),this.Listener.addEventListener("window","crisp-pushstate",()=>{this.de()}),this.Listener.addEventListener("window","crisp-replacestate",()=>{this.de()})}ce(t=""){const e=(t||"").match(Sr)||[];return{url:e[1]||null,path:e[2]||"/"}}ue(){if("object"!=typeof window.history)return;if("function"!=typeof window.history.pushState)return;if("function"!=typeof window.history.replaceState)return;let t=window.history;this.fe=t.pushState,t.pushState=Vs(function(...e){let i=this.fe.apply(t,e);return window.dispatchEvent(new Event("crisp-pushstate")),i},this),this.pe=t.replaceState,t.replaceState=Vs(function(...e){let i=this.pe.apply(t,e);return window.dispatchEvent(new Event("crisp-replacestate")),i},this)}oe(){this.fe&&(window.history.pushState=this.fe),this.pe&&(window.history.replaceState=this.pe)}de(){this.Session.sendDevice(),this.event.emit("window:history",{page_url:document.location.href,page_domain:document.location.hostname})}},Ir=["button","alert"],jr={firstElement:null,lastElement:null,stack:[]};const Rr=new class extends Ge{constructor(){super()}reset(){jr.firstElement=null,jr.lastElement=null,jr.stack=[]}init(t){let e=this;t.directive("crispAccessibility",{beforeMount:(t,i)=>e.mount(t,i),updated:(t,i)=>e.update(t,i),beforeUnmount:t=>e.unbind(t)})}bindPetiteVue(t){let e=t.el,i={value:{role:t.get().role,isFirst:t.get().isFirst,isLast:t.get().isLast}};return this.mount(e,i)}mount(t,e){var i,s,n;t.$cac={},t.$cac.role=null==(i=null==e?void 0:e.value)?void 0:i.role,t.$cac.isFirst=null==(s=null==e?void 0:e.value)?void 0:s.isFirst,t.$cac.isLast=null==(n=null==e?void 0:e.value)?void 0:n.isLast,t.$cac.fnOnKeydown=e=>{this.Mn(t,e)},t.removeEventListener("keydown",t.$cac.fnOnKeydown),t.addEventListener("keydown",t.$cac.fnOnKeydown),t.setAttribute("tabindex",0),t.$cac.role&&t.setAttribute("role",t.$cac.role),!0===t.$cac.isFirst&&null===jr.firstElement&&(jr.firstElement=t),!0===t.$cac.isLast&&null===jr.lastElement&&(jr.lastElement=t),jr.stack.push(t)}update(t,e){!0===jr.stack.includes(t)&&this.mount(t,e)}unbind(t){this.qn(t)}qn(t){Object.keys(t.$cac||{}).length>0&&t.removeEventListener("keydown",t.$cac.fnOnKeydown);let e=jr.stack.indexOf(t);e>-1&&jr.stack.splice(e,1),t.$cac={}}Mn(t,e){var i;switch(e.keyCode){case 13:case 32:(null==(i=e.target)?void 0:i.role)&&Ir.includes(e.target.role)&&(e.stopImmediatePropagation(),e.preventDefault(),e.target.click());break;case 9:if(null!==jr.lastElement&&null!==jr.firstElement&&jr.lastElement===t){"hidden"!==window.getComputedStyle(jr.firstElement).visibility&&(e.stopImmediatePropagation(),e.preventDefault(),jr.firstElement.focus())}}}};const Or=new class{formatText(t,e={}){return js.parse().format("string"==typeof t?t:"",e)}generateAvatarUrl(t,e,i,s=null){return Ns.url.call(Ns,t,e,i,s)}translateText(t,e,i=[]){return Ls.text.call(Ls,t,e,i)}parseFirstName(t){return js.name().parse_first_name("string"==typeof t?t:"")}imageUrlOriginal(t){return uu.filterImageUrlOriginal(t)}imageUrlResize(t,e=null,i=null){return uu.filterImageUrlResize(t,null!==e?e:600,null!==i?i:600)}};const Mr=new class{dom(t){let e=document.createElement("div");return e.innerHTML=t,e.firstChild}vue(t){let e={};return e._f=Or.formatText,e._n=Or.parseFirstName,e._e=Or.translateText,e._a=Or.generateAvatarUrl,e.imageUrlResize=Or.imageUrlResize,e.imageUrlOriginal=Or.imageUrlOriginal,vs({reactive:_e,effect:vt,stop:wt,remove:h},{$store:Xo,$render:e}).directive("crisp-accessibility",function(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}(Rr.bindPetiteVue,Rr)).mount(t)}};function qr(){return(new Date).getTime()}const Ur=/^(?:https?:[/]*)?([^/]+)(?:\/.*)?$/i,Pr={updateWebsite(t,e){var i;if(Pe.TEST){let i=Tr.Un(t,e);t=i.configuration,e=i.session}Tr.online=!1,(t=t||{}).settings=t.settings||{};let s={website:{name:t.website||"",domain:uu.extract(Ur,t.domain,Ro.website.domain,1),mailer:t.mailer||"",buster:e.buster||1,count_operators:e.count_operators||0,active_operators:e.active_operators||t.operators||[],response_metrics:e.response_metrics||{},last_available:e.last_available||qr(),status:e.status||null,trial:t.trial||!1,online:t.online||!1},channels:t.channels||{},overlay:t.overlay||{},plugins:t.plugins||{},chat:{country:uu.getOrFallback(null==(i=e.context)?void 0:i.country,null),locale:Ls.detect(t.settings.locale?[t.settings.locale]:[]),theme:uu.getOrFallback(t.settings.color_theme,"default"),allowed_pages:uu.getOrFallback(t.settings.allowed_pages,[]),blocked_pages:uu.getOrFallback(t.settings.blocked_pages,[]),blocked_locales:uu.getOrFallback(t.settings.blocked_locales,[]),tile:uu.getOrFallback(t.settings.tile,"default","string"),website_logo:uu.getOrFallback(t.settings.website_logo,!1,"boolean"),last_operator_face:uu.getOrFallback(t.settings.last_operator_face,!1,"boolean"),ongoing_operator_face:uu.getOrFallback(t.settings.ongoing_operator_face,!0,"boolean"),activity_metrics:uu.getOrFallback(t.settings.activity_metrics,!0,"boolean"),operator_privacy:uu.getOrFallback(t.settings.operator_privacy,!1,"boolean"),visitor_privacy:uu.getOrFallback(t.settings.visitor_privacy,!1,"boolean"),availability_tooltip:uu.getOrFallback(t.settings.availability_tooltip,!0,"boolean"),hide_vacation:uu.getOrFallback(t.settings.hide_vacation,!1,"boolean"),hide_on_away:uu.getOrFallback(t.settings.hide_on_away,!1,"boolean"),hide_on_mobile:uu.getOrFallback(t.settings.hide_on_mobile,!1,"boolean"),position_reverse:uu.getOrFallback(t.settings.position_reverse,!1,"boolean"),email_visitors:uu.getOrFallback(t.settings.email_visitors,!0,"boolean"),phone_visitors:uu.getOrFallback(t.settings.phone_visitors,!0,"boolean"),force_identify:uu.getOrFallback(t.settings.force_identify,!1,"boolean"),ignore_privacy:uu.getOrFallback(t.settings.ignore_privacy,!1,"boolean"),visitor_compose:uu.getOrFallback(t.settings.visitor_compose,!0,"boolean"),file_transfer:uu.getOrFallback(t.settings.file_transfer,!0,"boolean"),audio_record:uu.getOrFallback(t.settings.audio_record,!0,"boolean"),overlay_search:null!==t.overlay?uu.getOrFallback(t.settings.overlay_search,!1,"boolean"):null,overlay_mode:uu.getOrFallback(t.settings.overlay_mode,!1,"boolean"),helpdesk_link:uu.getOrFallback(t.settings.helpdesk_link,!0,"boolean"),helpdesk_only:uu.getOrFallback(t.settings.helpdesk_only,!1,"boolean"),status_health_dead:uu.getOrFallback(t.settings.status_health_dead,!0,"boolean"),wait_game:uu.getOrFallback(t.settings.wait_game,!1,"boolean"),theme_text:uu.getOrFallback(t.settings.text_theme,"default"),theme_welcome:uu.getOrFallback(t.settings.welcome_message,"default")}};uu.merge(Tr,s)},Un:(t,e)=>(window.$mock_website&&(delete t.plugins,uu.merge(t,window.$mock_website)),window.$mock_overlay&&uu.merge(t,window.$mock_overlay),window.$mock_helpdesk&&uu.merge(t,window.$mock_helpdesk),window.$mock_session&&(uu.merge(e,window.$mock_session),e.active_operators=window.$mock_session.active_operators,e.active_operators[0].timestamp=e.last_available),{configuration:t,session:e})};const Tr=Ye({website:{name:"",domain:"",mailer:"",buster:1,count_operators:0,active_operators:[],response_metrics:{},last_available:qr(),status:null,trial:!1,online:!1},channels:{},overlay:{},plugins:{},chat:{country:null,locale:"",theme:"default",allowed_pages:[],blocked_pages:[],blocked_locales:[],tile:"default",website_logo:!1,last_operator_face:!1,ongoing_operator_face:!0,activity_metrics:!0,operator_privacy:!1,visitor_privacy:!1,availability_tooltip:!0,hide_vacation:!1,hide_on_away:!1,hide_on_mobile:!1,position_reverse:!1,email_visitors:!0,phone_visitors:!0,force_identify:!1,ignore_privacy:!1,visitor_compose:!0,file_transfer:!0,audio_record:!0,overlay_search:!1,overlay_mode:!1,helpdesk_link:!0,helpdesk_only:!1,status_health_dead:!0,wait_game:!1,theme_text:"default",theme_welcome:"default"}},Pr),Lr=["Khtml","Ms","O","Moz","Webkit"],Nr={macos:/^Mac/,windows:/^Win/,linux:/^Linux/,ios:/^(?:iPhone|iPod|iPad)$/,android:/^Android$/},Vr=/^[a-z]/,Hr=/no/,Wr={Pn(){let t=null,e=document.createElement("audio"),i=Boolean(e.canPlayType&&e.canPlayType('audio/ogg; codecs="vorbis"').replace(Hr,"")),s=Boolean(e.canPlayType&&e.canPlayType('audio/mp4; codecs="mp4a.40.2"').replace(Hr,"")),n=Boolean(e.canPlayType&&e.canPlayType("audio/mpeg;").replace(Hr,""));!0===i?t="oga":!0===s?t="m4a":!0===n&&(t="mp3"),null!==t&&(Jr.html_audio_format=t,Jr.has_html_audio=!0)},Tn(t){let e=!1,i=document.documentElement.style,s=Lr.length;if(t in i)e=!0;else for(t=t.replace(Vr,t=>t.toUpperCase());s--;)if(Lr[s]+t in i){e=!0;break}return e},Ln(){let t=null,e=window.navigator.platform||null;if(null!==e)for(let i in Nr){if(!0===Nr[i].test(e)){t=i;break}}null!==t&&(Jr.operating_system=t)},Nn(){Jr.has_audio_recording=!1,window.MediaRecorder&&window.File&&navigator.mediaDevices&&"function"==typeof window.MediaRecorder.isTypeSupported&&"function"==typeof navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.enumerateDevices().then(t=>{for(let e=0;e<((null==t?void 0:t.length)||0);e++)if("audioinput"===t[e].kind){Jr.has_audio_recording=!0;break}Ro.features.audio_recording=Jr.has_audio_recording}).catch(()=>{})},Vn:t=>Boolean(t in window),Hn(){Jr.has_screen_touch=Jr.Vn("ontouchstart")||navigator.maxTouchPoints>0;let t=()=>{Jr.has_screen_touch=!0,window.removeEventListener("touchstart",t)};window.addEventListener("touchstart",t,!1)}},Jr=_e(Object.assign(Wr,{has_css_animations:!1,has_audio_recording:!1,has_html_audio:!1,html_audio_format:"mp3",has_screen_touch:!1,operating_system:null}));Jr.has_css_animations=Jr.Tn("animation")&&!0!==Pe.TEST,Jr.Nn(),Jr.Hn(),Jr.Ln(),Jr.Pn();const Gr=new class extends qs{constructor(){super()}subscribe(t,e){super.subscribe(t,e)}unsubscribe(t,e){super.unsubscribe(t,e)}handleAutocomplete(t=[]){super.emit("handle-autocomplete",t)}},Kr=Ye({searchReportTimeout:null,searchDebounceTimeout:null,activeSearchQuery:"",search:{input:"",url:"",articles:[],currentIndex:0,active:!1,initialized:!1,loading:!1},viewer:{url:"",category:"",title:"",loaded:!1},settings:{}},{doSearch(){if(!0!==Kr.showSearch())throw new Error("Helpdesk search is unavailable");e().Action.do_chat_show(),e().Action.do_chat_open()},proceedSearch(t=""){t!==Kr.activeSearchQuery&&(Kr.Wn(),Kr.search.loading=!0,Kr.searchDebounceTimeout=uu.setTimeout(()=>{if(Kr.searchDebounceTimeout=null,Kr.activeSearchQuery=t,e().Action.do_helpdesk_query(t),t){let e=t.substring(t.lastIndexOf(" ")+1).trim();e&&e.length>=2&&zr.Helpdesk.getArticleSuggest(e,Rs.code)}},100))},showSearch(t=!1){let i=!1,s=wo.generateChannelLink("helpdesk");return s&&(i=!0,"helpdesk"!==wo.mode?(Kr.search.input="",Kr.search.url=s,Kr.search.articles=[],Kr.search.currentIndex=0,Kr.search.active=!1,Kr.search.initialized=!1,Kr.search.loading=!1,wo.mode="helpdesk",e().Action.do_helpdesk_query("")):Kr.viewer.url="",!1===t&&e().Chat.Interface.requestDynamicSizingProperties()),i},articleOpen(t,i,s=null,n=null){if(!0!==Kr.showArticle(t,i,s,n))throw new Error("Helpdesk article is unavailable");e().Action.do_chat_show(),e().Action.do_chat_open()},showArticle(t,i,s=null,n=null){let r=!1,o=wo.generateChannelLink("helpdesk");return o&&(r=Kr.showSearch(!0),Kr.viewer.loaded=!1,Kr.viewer.title=s||"",Kr.viewer.category=n||"",Kr.viewer.url=`${o}${t}/article/${i}/`,e().Chat.Interface.requestDynamicSizingProperties()),r},handleArticles(t=[],e={},i=!1){var s,n;"helpdesk"===wo.mode&&(Pe.TEST&&(null==(n=null==(s=window.$mock_helpdesk)?void 0:s.search)?void 0:n.results)&&(t=window.$mock_helpdesk.search.results),Kr.search.articles=[],Kr.search.currentIndex=0,Kr.search.active=i,Kr.search.articles=t,null!==Kr.searchReportTimeout&&uu.clearTimeout(Kr.searchReportTimeout),e.query&&(Kr.searchReportTimeout=uu.setTimeout(()=>{Kr.searchReportTimeout=null;let i=(e.query||"").trim(),s=e.locale||null;t[0]&&t[0].locale&&(s=t[0].locale),s&&i&&zr.Helpdesk.reportArticleSearch(s,i)},1e3)),Kr.search.initialized=!0,Kr.search.loading=!1)},handleAutocomplete(t=[]){"helpdesk"===wo.mode&&Gr.handleAutocomplete(t)},Wn(){null!==Kr.searchDebounceTimeout&&(uu.clearTimeout(Kr.searchDebounceTimeout),Kr.searchDebounceTimeout=null),null!==Kr.searchReportTimeout&&(uu.clearTimeout(Kr.searchReportTimeout),Kr.searchReportTimeout=null)}});Kr.settings_search=je(()=>""!==Tr.website.domain&&Tr.chat.helpdesk_link&&Tr.channels.helpdesk),Kr.settings_only=je(()=>Kr.settings_search&&Tr.chat.helpdesk_only);const Yr=function(){const t="undefined"!=typeof document&&document.createElement("link").relList;return t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}(),Zr={},Xr=function(t,e,i){let s=Promise.resolve();if(e&&e.length>0){let t=function(t){return Promise.all(t.map(t=>Promise.resolve(t).then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),n=(null==i?void 0:i.nonce)||(null==i?void 0:i.getAttribute("nonce"));s=t(e.map(t=>{if((t=function(t){return"https://client.crisp.chat/static/"+t}(t))in Zr)return;Zr[t]=!0;const e=t.endsWith(".css"),i=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${i}`))return;const s=document.createElement("link");return s.rel=e?"stylesheet":Yr,e||(s.as="script"),s.crossOrigin="",s.href=t,n&&s.setAttribute("nonce",n),document.head.appendChild(s),e?new Promise((e,i)=>{s.addEventListener("load",e),s.addEventListener("error",()=>i(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function n(t){const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}return s.then(e=>{for(const t of e||[])"rejected"===t.status&&n(t.reason);return t().catch(n)})},Qr="#",to="overlay";let eo=null;const io=Ye({is_opened:!1,is_loading:!1,sidebar:{expanded:!0,scrolled:!1},main:{scrolled:!1},browse_recent:[],prompt:{query:"",asked:!1,thinking:!1},results:{query:"",answer:[],sources:[],expanded:0,category:!1,empty:!1,error:!1}},{open:(t=null)=>!0===Tr.chat.overlay_search&&(!0!==io.is_loading&&(io.is_loading=!0,io.sidebar.expanded="0"!==zr.Storage.getStampLocal(to,[Ro.website.id,"sidebar","retract"])&&!0,io.browse_recent=io.Jn()||[],Xr(()=>import("./features/overlay_default_e0e2da7.js"),__vite__mapDeps([0,1])).then(e=>{eo=e.default(".cc-jcxto"),io.focusOnPromptField(),io.is_opened=!0,io.is_loading=!1,"function"==typeof t&&t()})),!0),close(){let t=!1;return!0===io.is_opened&&(io.is_loading=!1,eo.unmount(),eo=null,!0===e().Chat._isInitialized&&Us.focusOnForeground(),io.is_opened=!1,t=!0),t},expandSidebar(t=!1){io.sidebar.expanded=t,zr.Storage.setStampLocal(to,[Ro.website.id,"sidebar","retract"],!0===t?"1":"0")},updatePromptField(t,e=!1){!0===e&&t&&t[0]!==Qr&&(t=`${Qr}${t}`),io.prompt.query!==t&&!0!==io.prompt.thinking&&(io.prompt.query=t,io.proceedSearch())},focusOnPromptField(t=!1){uu.setTimeout(()=>{let t=document.querySelector(".cc-nbz21");t&&t.focus()},!0===t?0:250)},proceedSearch(){if(!0!==io.prompt.thinking){let t=(io.prompt.query||"").trim(),e=zr.socket.connected,i=(null==t?void 0:t[0])===Qr,s=!0===i?t.slice(1):t;io.prompt.thinking=s.length>0,io.results.query=t,io.results.category=i,io.results.answer=[],io.results.sources=[],io.results.expanded=0,io.results.empty=!1,io.results.error=!1,s?(io.prompt.asked=!0,!0===i?!0===e?zr.Overlay.getOverlayCategorySuggest(s):io.handleSearchAnswer():!0===e?zr.Overlay.getOverlayAnswerSearch(s,Rs.code):io.handleSearchSources(null,!0)):io.prompt.asked=!1}},handleSearchChunk(t){io.results.answer.push(t)},handleSearchAnswer(t=null,e=null){if(t?io.results.answer=[t]:""===t?(io.results.answer=[Ls.text("overlay","results_answer_quickie_empty")],io.results.empty=!0):(io.results.answer=[],io.results.error=!0),io.prompt.thinking=!1,null!==e){let t=io.browse_recent;t.includes(e)||(t.unshift(e),t.length>5&&t.splice(5),io.Gn(t))}io.focusOnPromptField()},handleSearchSources(t=null,e=!1){io.results.sources=t||[],!0===e&&(null===t&&(io.results.error=!0),io.prompt.thinking=!1)},reset(){io.Gn([])},Jn(){if("function"==typeof(null==JSON?void 0:JSON.parse)){let t=zr.Storage.getStampLocal(to,[Ro.website.id,"browse","recent"])||null;if(null!==t)return JSON.parse(t)}return null},Gn(t=[]){"function"==typeof(null==JSON?void 0:JSON.stringify)&&zr.Storage.setStampLocal(to,[Ro.website.id,"browse","recent"],JSON.stringify(t))}});io.has_contact=je(()=>!Ro.is_invisible),io.branding_link=je(()=>`${Pe.URL_WEBSITE}/${Rs.web}/livechat/?ref=overlay&domain=${Ro.website.domain}&name=${encodeURIComponent(Tr.website.name)}`),io.browse_frequent=je(()=>{var t,e;let i=Tr.overlay,s=Rs.code;return(null==(t=i.search)?void 0:t[s])||(null==(e=i.search)?void 0:e.default)||[]}),io.browse_tags=je(()=>{var t,e;let i=Tr.overlay,s=Rs.code;return(null==(t=i.category)?void 0:t[s])||(null==(e=i.category)?void 0:e.default)||[]});const so="minimized";const no=Ye({_paneOpenHandler:function(t){},pane:{is_ongoing:!1,is_waiting:!1,is_offline:!1,animate_entrance:!1,general_entice:{visible:!1,is_concealed:!1,animate_full:!1,animate_short:!1},unread:{visible:!1,count:0},helpdesk:{url:null,only:!1}},tooltips:{new_messages:{visible:!1,animate:!0}}},{checkIsConcealed(){var t;!0===(null==(t=Tr.chat)?void 0:t.availability_tooltip)&&(no.pane.general_entice.is_concealed="1"===zr.Storage.getStampLocal(so,[Ro.website.id,"general_entice","conceal"])&&!0)},checkHelpdesk(){var t,e,i,s;!0===(null==(t=Tr.chat)?void 0:t.helpdesk_link)&&(null==(e=Tr.channels)?void 0:e.helpdesk)&&Ro.page_domain!==(null==(i=Tr.channels)?void 0:i.helpdesk)&&!0===zr.socket.connected&&(no.pane.helpdesk.url=wo.generateChannelLink("helpdesk"),no.pane.helpdesk.only=(null==(s=Tr.chat)?void 0:s.helpdesk_only)&&!0)},concealGeneralEntice(){no.pane.general_entice.is_concealed=!0,zr.Storage.setStampLocal(so,[Ro.website.id,"general_entice","conceal"],"1")},spawnPane(t,i=!0,s=!1,n=!0){let r=Mr.dom(t);if(e().Base._containerEl.innerHTML="",e().Base._containerEl.appendChild(r),Mr.vue(r),!0===i){let t=Tr,e=!0!==Ro.is_full_view&&!0===t.chat.availability_tooltip;!0===n&&Jr.has_css_animations?(!0===s&&(no.pane.animate_entrance=!0,uu.setTimeout(()=>{no.pane.animate_entrance=!1},1e3)),e&&uu.setTimeout(()=>{let t=no.pane;no.pane.general_entice.visible=!0;let e=!0===s?"animate_full":"animate_short";t.general_entice[e]=!0,uu.setTimeout(()=>{t.general_entice[e]=!1},500)},1e3*(!0===s?2:.25))):e&&(no.pane.general_entice.visible=!0)}},onPaneClick(t){let i=t.target;if(i){let t="cc-1y9m6",s=i.getAttribute("data-pop");if(!s){let t=i.closest("[data-pop]");t&&(s=t.getAttribute("data-pop")||null)}if(!0===(null==i?void 0:i.classList.contains(t)))no.concealGeneralEntice();else switch(s){case"overlay:open":no._paneOpenHandler(()=>{io.open()});break;case"helpdesk:search":Kr.doSearch();break;case"minimized:open":no._paneOpenHandler(t=>{e().Chat.init(t)})}}},paneAuthorized(t=!1,i=!1,s=!0){let n=!1,r=!1;no.checkIsConcealed(),no.checkHelpdesk(),no.spawnPane('<div class="cc-1kr6o cc-cxjxh cc-jx6a3"><div class="cc-18ov6" :aria-label="$store.chat.is_opened ? $render._e(\'minimized\', \'tooltip_button_close_hint\') : $render._e(\'minimized\', \'tooltip_button_open_hint\')" @click.prevent.stop="$store.minimized.onPaneClick" :data-pane-animate-entrance="$store.minimized.pane?.animate_entrance" :data-pop="$store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode ? \'overlay:open\' : ($store.minimized.pane?.helpdesk?.only ? \'helpdesk:search\' : \'minimized:open\')" data-maximized="false" data-is-failure="false" role="button" tabindex="0"><span class="cc-1442g"><span class="cc-17cli" v-if="$store.minimized.pane?.general_entice?.visible" :class="{ \'cc-1ok7i\': $store.minimized.pane?.general_entice?.animate_full, \'cc-r1itn\': $store.minimized.pane?.general_entice?.animate_short }" :data-with-helpdesk="$store.minimized.pane?.helpdesk?.url !== null" :data-is-concealed="$store.minimized.pane?.general_entice?.is_concealed" data-id="general_entice"><span class="cc-za3im"><span class="cc-unrzf cc-1plpv"><span class="cc-1my7a" aria-live="polite" role="dialog"><span class="cc-1akzs"><span class="cc-1y9m6 cc-orziz" v-crisp-accessibility="{ role: \'button\' }" :aria-label="$render._e(\'minimized\', \'tooltip_button_close_hint\')"></span><span class="cc-cy3oi"><span class="cc-1xl26 cc-vqf16" v-if="($store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode) || $store.minimized.pane?.helpdesk?.only">{{ $render._e("minimized", "tooltip_entice_title_search") }}</span><span class="cc-1xl26 cc-vqf16" v-else>{{ $render._e("theme_text", "default_chat", [$store.website?.chat?.theme_text + "_chat"]) }}</span><span class="cc-eaiqq"><span class="cc-ihyg6 cc-vqf16 cc-1qcl5" v-if="$store.availability?.availability === \'online\'" data-id="online">{{ $render._e("minimized", "tooltip_entice_status_online") }}</span><span class="cc-ihyg6 cc-1plpv" v-else data-id="away">{{ $render._e("minimized", "tooltip_entice_status_away") }}</span><span class="cc-rae6b"><span class="cc-9jd4w" v-for="active_avatar in $store.base.active_operators"><span class="cc-13n3c cc-1egul"><span class="cc-1mifq cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(60, active_avatar.type, active_avatar.identifier, active_avatar.avatar) + \') !important\') }"></span></span></span></span></span></span></span></span><span class="cc-aux1a"><div class="cc-1omlz cc-16kzz cc-fx907" v-if="!($store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode) &amp;&amp; !$store.minimized.pane?.helpdesk?.only" v-crisp-accessibility="{ role: \'button\' }" :data-partial-pending="$store.partial.bundle.pending.chat" :aria-label="$render._e(\'minimized\', \'tooltip_entice_action_chat\', [$store.website?.website?.name])" data-type="chat"><span class="cc-1wmlo cc-qdda2"></span><span class="cc-cr8wh cc-vqf16 cc-bxbnb">{{ $render._e("minimized", "tooltip_entice_action_chat", [$store.website?.website?.name]) }}</span></div><div class="cc-1omlz cc-16kzz" v-if="$store.website?.chat?.overlay_search || ($store.minimized.pane?.helpdesk?.url &amp;&amp; !$store.minimized.pane?.is_offline)" :data-pop="$store.website?.chat?.overlay_search &amp;&amp; (!$store.minimized.pane?.helpdesk?.only || $store.website?.chat?.overlay_mode) ? \'overlay:open\' : \'helpdesk:search\'" v-crisp-accessibility="{ role: \'button\' }" :data-partial-pending="$store.website?.chat?.overlay_search &amp;&amp; (!$store.minimized.pane?.helpdesk?.only || $store.website?.chat?.overlay_mode) ? $store.partial?.bundle?.pending?.overlay : $store.partial?.bundle?.pending?.chat" :aria-label="$render._e(\'minimized\', \'tooltip_entice_action_search\')" data-type="search"><span class="cc-1wmlo"></span><span class="cc-cr8wh cc-vqf16">{{ $render._e("minimized", "tooltip_entice_action_search") }}</span></div></span></span></span></span></span><span class="cc-1qbp0 cc-1o31k"><span class="cc-otlyh" :data-prefer-search="$store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode" data-id="chat_closed" data-is-ongoing="false"><span class="cc-xrw89" v-if="$store.minimized.pane?.is_waiting"><span class="cc-16p6v cc-975hf"></span></span><span class="cc-11f3x cc-16kzz" v-else :data-partial-pending="$store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode ? $store.partial?.bundle?.pending?.overlay : $store.partial?.bundle?.pending?.chat"><span class="cc-fajze cc-1egul" v-if="$store.website?.chat?.website_logo"><span class="cc-1p2bq cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(120, \'website\', $store.base.website?.id) + \') !important\') }"></span></span><span class="cc-fajze cc-1egul" v-else-if="$store.website?.chat?.last_operator_face &amp;&amp; $store.base.active_operators?.length &gt; 0"><span class="cc-1p2bq cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(120, $store.base.active_operators[0]?.type, $store.base.active_operators[0]?.identifier, $store.base.active_operators[0]?.avatar) + \') !important\') }"></span></span></span></span></span></div></div>',!0,t,s),no._paneOpenHandler=t=>{if(!1===n)if(n=!0,!1===i&&!0!==r){no.pane.is_waiting=!0,e().Event.triggerInteracted(!0);let i=uu.setTimeout(()=>{Ro.session_id&&(alert(Ls.text("chat","minimized_connect_alert_failure")),zr.socket.disconnect(),no.pane.is_waiting=!1,e().Action.do_chat_hide())},12e3);e().Broker._fnInitialize.master=e=>{uu.clearTimeout(i),t(e),n=!1},zr.socket.connect(),r=!0}else t(),n=!1,r=!0},ws.apply()},paneUnauthorized(t=!1,e=!0){no.spawnPane('<div class="cc-1kr6o cc-cxjxh cc-jx6a3"><div class="cc-18ov6" :aria-label="$store.chat.is_opened ? $render._e(\'minimized\', \'tooltip_button_close_hint\') : $render._e(\'minimized\', \'tooltip_button_open_hint\')" @click.prevent.stop="$store.minimized.onPaneClick" :data-pane-animate-entrance="$store.minimized.pane?.animate_entrance" :data-pop="$store.website?.chat?.overlay_search &amp;&amp; $store.website?.chat?.overlay_mode ? \'overlay:open\' : ($store.minimized.pane?.helpdesk?.only ? \'helpdesk:search\' : \'minimized:open\')" data-maximized="false" data-is-failure="true" role="button" tabindex="0"><span class="cc-1442g"><span class="cc-17cli" data-id="failure_notice"><span class="cc-za3im"><span class="cc-unrzf"><span class="cc-1uv4w cc-vqf16">{{ $render._e("minimized", "unauthorized_pane") }}</span></span></span></span></span><span class="cc-1qbp0 cc-2eonl"><span class="cc-otlyh" data-id="in_failure" data-is-ongoing="false" data-prefer-search="false"><span class="cc-11f3x"></span></span></span></div></div>',!1,t,e),no._paneOpenHandler=()=>{}}});const ro=Ye({states:{}},{update(t,e){let i,s,n,r;"object"==typeof t?i=t:(i={},i[t]=e);let o=uu.clone(ro.states);for(s in i)i.hasOwnProperty(s)&&(n=i[s],r=!1,void 0!==ro.states[s]&&ro.states[s]===n&&(r=!0),"lock"===ro.states[s]&&"unlock"!==n&&(r=!0),!1===r&&(o[s]=n));Fo.propagate("alert",o)},hook(t,e){let i=ro.hookMethods[e];"function"==typeof i&&function(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}(i,this)(t)},Kn(t){this.Yn(t)},Zn(t){this.Yn(t)},Yn(t){"show"===t?jo.checkFormIdentifyLock():jo.checkFormIdentifyUnlock()}});Ze(()=>{ro.states={}}),ro.hookMethods={warn_reply:ro.Kn,email_invalid:ro.Zn};const oo=Ye({type:"smiley",is_visible:!1,has_animation:!1,last_search_query:null,gif:{results:[],input:""}},{toggle(){oo.last_search_query=null,oo.is_visible=!oo.is_visible,oo.has_animation=!0,oo.type="smiley"},show(t){oo.type!==t&&(oo.hide(),oo.is_visible=!0,oo.type=t,"gif"===t&&oo.loadDataGif())},hide(){oo.last_search_query=null,oo.is_visible=!1,oo.has_animation=!1},loadDataGif(t=""){if(oo.last_search_query!==t){oo.last_search_query=t,zr.Media.getAnimationList(t),oo.gif.results=[];for(let t=0;t<10;t++)oo.gif.results.push({loading:!0})}}}),uo={request(){co.update("feedback")},toggle(){ao.is_visible=!ao.is_visible,!0!==ao.is_visible?Us.focusOnForeground():oo.hide()},hide(){ao.is_visible=!1},show(){ao.is_visible=!0},isOpen:()=>ao.is_visible,markAvailable(t=!1){ao.is_available=t}};Pe.TEST&&(window.$markFeedbackAvailable=()=>{ao.is_available=!0});const ao=Ye({is_visible:!1,is_available:!1,stars:{hovered:0,selected:0},comment:""},uo);const lo=["identity","game","feedback"],ho={update(t,e="default",i=!1){if(lo.includes(t)){if(!0===i||!1!==co.states[t]){let i=uu.clone(co.states);e||!1===e?i[t]=e:delete i[t],Fo.propagate("intent",i)}}else We.error(`Unknown intent: ${t}`)},cleanup(t=null){for(let e=0;e<lo.length;e++){let i=lo[e];(t||co.states)[i]||co.toggle(i,null)}},toggle(t,e="default",i=!0){if(lo.includes(t)){let s=co.toggleMethods[t];"function"==typeof s&&function(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}(s,this)(e,i)}},Xn(t="default",e=!0){t?"default"===t?jo.showIdentity(e):jo.showIdentityField(t,e):jo.hideIdentity()},Qn(t="default",e=!0){t?jo.showGame(e):jo.hideGame()},tr(t="default",e=!0){switch(t){case"default":jo.showFeedback(e);break;case"submitted":!0===e&&jo.showFeedbackSubmitted(e);break;default:jo.hideFeedback()}ao.markAvailable(!(!t||"submitted"===t))}};Pe.TEST&&(window.$triggerGame=()=>{co.update("game")});const co=Ye({states:{}},ho);Ze(()=>{co.states={}}),co.toggleMethods={identity:co.Xn,game:co.Qn,feedback:co.tr};const Do=Ye({opened:!1,target:"",title:"",loaded:!1},{open(t,e="",i={}){i.website_id=Ro.website.id,i.session_id=Ro.session_id;let s=uu.insertLinkQueryValues(t,i);!0===Do.opened&&Do.target!==s&&this.close(),!1===Do.opened&&(Do.loaded=!1,Do.target=s,Do.title=e||"",Do.opened=!0)},close(){!0===Do.opened&&(Do.opened=!1,Do.target="",Do.title="",Do.loaded=!1)}});const fo=Ye({loaded:!1,visible:!1},{start(){fo.visible=!0,fo.loaded=!1},stop(){fo.visible=!1}});function po(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}const mo=[["show","unlock"],["unlock","show"],["hide","lock"],["lock","hide"],["lock","show"]];let _o=null;const Fo=Ye({isRestored:!1,session:{},pending:{},restoredState:[]},{defaultStates:()=>({trigger:e().Trigger._processed,alert:ro.states,intent:co.states,operator:jo.operator_details,scroll:0,maximized:!0,textarea:wo.message}),receive(t,e=!1){let i,s=[];for(let n in t)t.hasOwnProperty(n)&&(uu.isEqual(t[n],Fo.session[n])||(s.push(n),Fo.session[n]=t[n],!1===e&&void 0!==Fo.pending[n]&&delete Fo.pending[n]));for(let n=0;n<s.length;n++)i=s[n],po(Fo.register[i],Fo)(Fo.session[i])},propagate(t,e,i=!1,s=null,n=null){if(!0!==i&&uu.isEqual(Fo.session[t],e))"function"==typeof s&&s(!1);else{Fo.pending[t]=e,null!==_o&&(uu.clearTimeout(_o),_o=null);let i=uu.clone(Fo.session);i[t]=e,Fo.receive(i,!0),_o=uu.setTimeout(()=>{if(uu.isEmpty(Fo.pending))"function"==typeof s&&s(!1);else{let t=uu.clone(Fo.pending);Fo.pending={},_o=null,zr.Session.setState(t,t=>{t?"function"==typeof n&&n():"function"==typeof s&&s(!0)})}},250)}},restore(t){var e;!0===Ro.is_full_view&&!0!==(null==(e=Ro.runtime)?void 0:e.lock_maximized)&&(t.maximized=!1);let i=Fo.defaultStates();for(let s in i)void 0===t[s]&&(t[s]=i[s]);Fo.isRestored=!0,Fo.session=t,Fo.restoredState=uu.keys(Fo.session)},retrigger(t){let e=Fo.defaultStates();Fo._triggerDefault(t,e[t])},triggerDefaultAll(t=[]){let e=Fo.defaultStates();for(let i in e)e.hasOwnProperty(i)&&Fo._triggerDefault(i,e[i],t.includes(i))},_triggerDefault(t,e,i=!1){"function"==typeof Fo.register[t]?(void 0===Fo.session[t]&&(Fo.session[t]=e),po(Fo.register[t],this)(Fo.session[t],i)):We.error(`No such state handler: ${t}`)},er(t){let e=!1,i=Fo.restoredState.indexOf(t);return-1!==i&&(Fo.restoredState.splice(i,1),e=!0),e},ir(t,i=!1){if(!0!==i&&(Fo.er("trigger"),(null==t?void 0:t.length)>0))for(let s=0;s<t.length;s++)e().Trigger.markProcessed(t[s])},sr(t,e=!1){if(!0===e)return;let i,s,n,r,o,u;Fo.er("alert");let a=!1,l={};for(let h in t)if(t.hasOwnProperty(h)){if(i=t[h],s=ro.states[h],n=!1,s===i)n=!0;else if("unlock"!==i&&"lock"===s)n=!0;else for(let t=0;t<mo.length;t++)r=mo[t],s===r[0]&&i===r[1]&&(n=!0);if(o="show"===i||"unlock"===i,u="hide"===i||"lock"===i,!0===o&&(l[h]=!0,a=!0),!1===n){if(!0===o)ro.hook("show",h);else{if(!0!==u)return void We.error(`Unknown action: ${i}`);ro.hook("hide",h)}ro.states[h]=i,Us.focusOnForeground()}else ro.states[h]=i}wo.current_alerts=!0===a?l:null},nr(t,e=!1){if(co.states=t,!0===e)return;let i=Fo.er("intent");for(let s in t)co.toggle(s,t[s],!i);co.cleanup(t)},rr(t,i=!1){var s,n;if(!0===i)return;let r,o,u,a,l,h;Fo.er("operator"),jo.operator_details=t||{},uu.isEmpty(jo.operator_details)?(r="initial",u="website",a=null==(s=Ro.website)?void 0:s.id):(r="ongoing",u=t.type||"operator",a=t.user_id,l=t.avatar,o="website"===t.type?t.nickname:js.name().parse_first_name(t.nickname)),(l||a)&&(h=Ns.url(240,u,a,l)),h&&("ongoing"===r&&(wo.ongoing_operator={type:u,name:o,user_id:a,url:h},!0===(null==(n=Tr.chat)?void 0:n.ongoing_operator_face)&&(no.pane.is_ongoing=!0)),wo.status_marker=r),e().Chat.Interface.requestDynamicSizingProperties(!0)},ur(t,e=!1){if(!0===e)return;!1===Fo.er("scroll")&&Us.handleScroll(t)},ar(t,i=!1){var s;if(!0===i)return;let n=!0!==Fo.er("maximized")&&!0;!0===(null==(s=Ro.runtime)?void 0:s.lock_maximized)&&(t=!0),!1===t?(e().Chat.Interface.toggleVisibility("pane",n),Us.blurFromForeground(),e().Chat.Viewport.unadapt(),oo.hide(),ao.hide(),wo.toggleChannelDropdown(!1),Do.close(),fo.stop(),e().Action.event("chat:closed")):(!0===Kr.settings_only&&"helpdesk"!==wo.mode&&Kr.showSearch(),e().Chat.Interface.toggleVisibility("chat",n),Us.focusOnForeground(),e().Chat.Viewport.adapt(),Us.checkClearance(),e().Action.event("chat:opened"))},lr(t,i=!1){!0!==i&&(Fo.er("textarea"),e().Action.set_message_text(t))}});function go(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}Ze(()=>{Fo.session={},Fo.pending={},Fo.restoredState=[]}),Fo.register={trigger:Fo.ir,alert:Fo.sr,intent:Fo.nr,operator:Fo.rr,scroll:Fo.ur,maximized:Fo.ar,textarea:Fo.lr};const vo=[["email","Email"],["phone","Phone"],["messenger","Messenger"],["telegram","Telegram"],["twitter","X (Twitter)"],["whatsapp","WhatsApp"],["instagram","Instagram"]];const wo=Ye({mode:"chat",status_marker:"none",is_maximized:!1,is_opened:!1,is_locked_identify:!1,is_locked_prompt:!1,has_offline:!1,has_channels:!1,has_window_focus:!1,show_operator_count:!0,animate_minimize:!1,animate_maximize:!1,reconnect_failed:!1,reconnect_inactive:!1,blocked:!1,message:"",ongoing_operator:{user_id:"",type:"",name:"",url:""},current_alerts:null,activity:{metrics:null,last:null},status:{url:""}},{onPaneToggleClick(t){var i;let s=t.target;(null==(i=null==s?void 0:s.classList)?void 0:i.contains("cc-14kee"))?e().Action.do_message_read():e().Action.do_chat_toggle()},onPaneTooltipNewMessagesClick(){e().Chat.Interface.toggleChatMode(!0)},setMessageText(t=null){if("string"!=typeof t)throw new Error("Invalid message text");{let e=document.querySelector(".cc-sxv5t");e&&!0!==e.disabled&&(wo.message=t,e.dispatchEvent(new window.KeyboardEvent("keydown")))}},minimize(){!0!==Ro.runtime.lock_maximized&&Fo.propagate("maximized",!1)},maximize(){Fo.propagate("maximized",!0,!1,()=>{Us.scrollTo()})},toggleChannelDropdown(t=null){null===t&&(t=!wo.has_channels),t!==wo.has_channels&&(wo.has_channels=t)},generateChannelLink(t){let e="",i=Tr.channels[t]||null;switch(t){case"email":{let t=Ro.session_hash;if(t){let i=Tr.website.name,s=`s.${t}.i@${Tr.website.mailer}`;e="mailto:",i&&(e+=`"${encodeURI(i)}"`),e+=`<${encodeURI(s)}>`}else i&&(e=`mailto:${i}`);break}case"phone":i&&(e=`tel:${i}`);break;case"messenger":i&&(e=`https://m.me/${encodeURI(i)}`);break;case"telegram":i&&(e=`https://telegram.me/${encodeURI(i)}`);break;case"twitter":i&&(e=`https://x.com/${encodeURI(i)}`);break;case"whatsapp":i&&(e=`https://wa.me/${encodeURI(i)}`);break;case"instagram":i&&(e=`https://www.instagram.com/${encodeURI(i)}/`);break;case"helpdesk":case"status":if(i){e=`${"production"===Pe.ENVIRONMENT?"https":"http"}://${i}/`}}return e}});wo.is_visible=je(()=>wo.is_maximized&&!0!==Ro.is_hidden),wo.has_health=je(()=>{var t;return wo.status.url&&!0===Tr.chat.status_health_dead&&"dead"===(null==(t=Tr.website.status)?void 0:t.health)&&(new Date).getTime()-Tr.website.status.since>=18e4}),wo.has_chat_focus=je(()=>wo.has_window_focus&&wo.is_visible&&"chat"===wo.mode&&!0),wo.branding_link=je(()=>`${Pe.URL_WEBSITE}/${Rs.web}/livechat/?ref=chatbox&domain=${Ro.website.domain}&name=${encodeURIComponent(Tr.website.name)}`),wo.activity_metrics=je(()=>{let t=Tr.website.response_metrics;return(null==t?void 0:t.mean)&&t.mean>=1e3&&t.mean<216e5?t.mean:null}),wo.activity_last=je(()=>{let t=Tr.website.last_available;return t&&t>0?t:null}),wo.channels=je(()=>{let t=[];for(let e=0;e<vo.length;e++){let i=vo[e][0],s=vo[e][1],n=wo.generateChannelLink(i);n&&("email"!==i&&"phone"!==i||(s=go(Ls.text,Ls)("chat",`chat_header_ongoing_channel_continue_${i}`)),t.push({name:i,format:s,link:n}))}return t});const bo={events:["chat-message-receive","chat-message-action"],call:["call-established","call-hangup","call-ring"]};const yo=new class extends Ge{constructor(){super(),this.In()}reset(){this.stop(),this.In()}allow(t=!0){this.hr=t}mute(t=!0){this.cr=t}initialize(t){if(!1===this.hr)return;this.dr[t]=this.dr[t]||{};let e=bo[t];for(let i=0;i<e.length;i++)void 0===this.dr[t][e[i]]&&this.Dr(t,e[i])}start(t,e,i=!1,s=50){if(!1!==this.hr&&!0===Xo.feature.has_html_audio&&!0===this.pr(t)){let n=bo[t];void 0!==n?n.includes(e)?(this.stop(),this.Dr(t,e,n=>{if(null!==this.mr){"suspended"===this.mr.state&&this.mr.resume();let r=this.mr.createGain();r.gain.setValueAtTime(s/100,0),r.connect(this.mr.destination),this._r=this.mr.createBufferSource(),this._r.buffer=n,this._r.loop=i,this._r.connect(r),this._r.start(),this.Fr=t,this.gr=e}},t=>{})):We.error(`Sound does not exist: ${e} in subset ${t}`):We.error(`Subset does not exist: ${t}`)}}stop(t=null,e=null){try{null===this._r||null!==t&&t!==this.Fr||null!==e&&e!==this.gr||(this._r.stop(),this._r=null,this.Fr=null,this.gr=null)}catch(i){We.error(i)}}Dr(t,e,i=null,s=null){try{if(this.dr[t]=this.dr[t]||{},this.vr[t]=this.vr[t]||{},void 0===this.vr[t][e])if(this.vr[t][e]={success:"function"==typeof i?[i]:[],error:"function"==typeof s?[s]:[]},void 0!==this.dr[t][e])this.wr("success",t,e,this.dr[t][e]);else{let i=this.br(t,e);if(i){let s=new window.XMLHttpRequest;s.open("GET",i,!0),s.responseType="arraybuffer",s.onload=()=>{null===this.mr&&(this.mr=this.yr()),null!==this.mr?this.mr.decodeAudioData(s.response,i=>{this.dr[t]=this.dr[t]||{},this.dr[t][e]=i,this.wr("success",t,e,i)},i=>{this.wr("error",t,e,i)}):this.wr("error",t,e)},s.onerror=i=>{this.wr("error",t,e,i)},s.send()}}else"function"==typeof i&&this.vr[t][e].success.push(i),"function"==typeof s&&this.vr[t][e].error.push(s)}catch(n){We.error(n)}}wr(t,e,i,s=null){var n;let r=null==(n=this.vr[e])?void 0:n[i];if(void 0!==r){for(let e=0;e<r[t].length;e++)"function"==typeof r[t][e]&&r[t][e](s);delete this.vr[e][i]}}br(t,e){let i=Xo.feature.html_audio_format;return null!==i?`${Pe.URL_CLIENT}/static/sounds/${t}/${e}.${i}?${Pe.REVISION}`:null}yr(){try{return!0===Xo.base.has_interacted&&"function"==typeof window.AudioContext?new window.AudioContext:null}catch(t){return We.error(t),null}}pr(t){let e=!this.cr&&!0,i="call"===t||!0!==zr.Call.isOngoing();return e&&i&&!0}In(){this.hr=!0,this.cr=!1,this.mr=null,this._r=null,this.Fr=null,this.gr=null,this.dr={},this.vr={}}};const Eo=["text","file","animation","audio","picker","field","carousel"],Co=["welcome","identity","game","feedback"],ko=["email","phone"],$o=["ð¨","âï¸"],Bo=["field","picker"];let Ao=null,xo={},So=null,zo=null;const Io={registerUnreadHandler(){zr.Message.setUnreadMessagesCallback((t,e,i)=>{uu.setTimeout(()=>{jo.updateUnread(t,e,i)},0)})},updateUnread(t=0,e=[],i=[]){let s=no.tooltips;if(jo.unread_count=t,t>0){no.pane.unread.count=t;let n=!1===s.new_messages.visible;jo.Er(t,e,i,n),null===Ro.page_title_current&&(Ro.page_title_current=document.title),Ro.page_title_current&&!0!==Ro.is_invisible&&(document.title=`ð¬${t} - ${Ro.page_title_current}`),!0===n&&(null!==zo&&uu.clearTimeout(zo),zo=uu.setTimeout(()=>{zo=null,s.new_messages.visible=!0,s.new_messages.animate=!0,uu.setTimeout(()=>{s.new_messages.animate=!1},500)},100),no.pane.unread.visible=!0)}else null!==zo&&uu.clearTimeout(zo),s.new_messages.visible=!1,s.new_messages.animate=!1,no.pane.unread.visible=!1,Ro.page_title_current&&(document.title=Ro.page_title_current)},synchronize(){zr.Message.getMessageCompose(),zr.Message.getUnreadMessages(),zr.Message.getMessageHistory(),0===zr.Message.countMessageHistory()&&jo.Cr()},history(t=[]){for(let e=0;e<t.length;e++){let i=t[e];jo.kr(i),"user"===i.from&&!0===i.read&&jo.sent_read_fingerprints.push(i.fingerprint)}jo.Cr()},send(t="text",i=null){!0===jo.checkIntentSend()&&(t&&i?e().Action.do_message_send(t,i):wo.message&&(e().Action.do_message_send("text",wo.message),wo.setMessageText("")))},sent(t){var i;if(t.from="user",!0===jo.kr(t)&&jo.$r(t.fingerprint),jo.Br(t.fingerprint),!0===(void 0===(null==(i=null==co?void 0:co.states)?void 0:i.identity))){let t=e().Action.get_user_email(),i=e().Action.get_user_phone(),s=Tr.chat.email_visitors,n=Tr.chat.phone_visitors;(t||!0!==s)&&(i||!0!==n)||t||i?ro.update("wait_reply","show"):(null!==So&&uu.clearTimeout(So),So=uu.setTimeout(()=>{So=null;let t="default";!1===(s&&n)&&(!0===s?t="email":!0===n&&(t="phone")),co.update("identity",t),ro.update("warn_reply","show")},1500))}Us.scrollTo()},received(t,e=!0,i=!0,s=!0,n=!1){let r=jo.kr(t),o=wo.has_chat_focus;!0===e&&!1===o&&yo.start("events","chat-message-receive"),!0===i&&!0===r&&jo.$r(t.fingerprint),t.user&&!Co.includes(t.user.source)&&(uu.isEqual(t.user,jo.operator_details)||Fo.propagate("operator",t.user)),!1===n&&fo.stop(),jo.message_compose_timestamp&&t.timestamp>0&&jo.message_compose_timestamp<t.timestamp&&jo.hideCompose(),!0===s&&uu.nextRender(()=>{Us.scrollToLastMessage("from"),uu.setTimeout(()=>{Us.scrollToLastMessage("from")},400)})},removed(t){jo.Ar(t.fingerprint)},remove(t){for(let e=0;e<jo.list.length;e++)if(jo.list[e].fingerprint===t){jo.list.splice(e,1),delete jo.fingerprints[t];break}},restore(){jo.Sr(),jo.synchronize()},getMessageFromStore(t){let e=null;for(let i=0;i<jo.list.length;i++)if(jo.list[i].fingerprint===t){e=jo.list[i];break}return e},hasUnsentMessages(){var t,e;let i=!0===zr.Message.isSendingMessages(),s=jo.list;if(!1===i&&s.length>0)for(let n=s.length-1;n>=0;n--){let r=s[n];if("user"===r.from&&(!0===(null==(t=r.metas)?void 0:t.is_pending)||(null==(e=r.metas)?void 0:e.error))){i=!0;break}}return i},sentAcknowledgement(t){jo.zr(t.fingerprint),jo.kr(t),jo.Ir(),Us.scrollToLastMessage("to")},acknowledgeReadSend(t,e=!1){if(!0!==Tr.chat.operator_privacy){let e=null;if(t.length>0)for(let i=0;i<jo.list.length;i++){let s=jo.list[i].fingerprint;t.includes(s)&&(jo.list[i].read=!0,e=s)}null!==e&&(jo.latest_fingerprint=e)}},errorRejected(t,e=null){jo.zr(t,e||"other")},triggerWillSendHooks(){let t=!1,e=[],i=zr.Message.getCachedMessages();for(let s=i.length-1;s>=0&&"local"===i[s].user.source;s--)e.push(i[s]);for(let s=0;s<e.length;s++){let i=e[s];jo.receive_mirror_fingerprints.includes(i.fingerprint)||(jo.receive_mirror_fingerprints.push(i.fingerprint),zr.Message.receiveMessageMirror(i.type,"urn:crisp.im:triggers:0",i.content,i.fingerprint),t=!0)}return t},dispatchLocal(t,e,i=null,s=!1){let n=Tr.website.active_operators||[],r={source:"local"};n[0]&&!0!==s?(r.user_id=n[0].user_id,r.nickname=n[0].nickname,n[0].avatar&&(r.avatar=n[0].avatar)):(r.type="website",r.user_id=Ro.website.id,r.nickname=Tr.website.name),zr.Message.receiveMessageLocal(t,e,r,i)},checkIntentSend(){let t=!0;return!0!==e().Broker._socketConnected&&(t=!1,zr.socket.connect()),t},checkFormIdentifyLock(){var t;!0===(null==(t=null==Tr?void 0:Tr.chat)?void 0:t.force_identify)&&(wo.is_locked_identify=!0)},checkFormIdentifyUnlock(){wo.is_locked_identify=!1},showIdentity(t=!0){var e;let i=`**${Ls.text("chat","chat_message_text_identity_main")}**\n_${Ls.text("chat","chat_message_text_identity_ask")}_`,s=t=>()=>{co.update("identity",t)},n=[];for(let r=0;r<ko.length;r++){let t=ko[r],i=$o[r];!0===(null==(e=null==Tr?void 0:Tr.chat)?void 0:e[`${t}_visitors`])&&n.push({value:t,icon:i,selected:!1,label:Ls.text("chat",`chat_message_text_identity_pick_${t}`),handler:s(t)})}n.length>0&&jo.jr("identity","default","picker",{id:"ask-identity",text:i,choices:n},t,t)},hideIdentity(){jo.Rr("identity")},showIdentityField(t,i=!0){if(ko.includes(t)){let s=`chat_message_text_identity_ask_${t}`,n=`chat_message_text_identity_ask_field_${t}`;jo.jr("identity",t,"field",{id:`identity-${t}`,text:`_${Ls.text("chat",s)}_`,explain:Ls.text("chat",n),previous:"identity",handler:i=>{try{e().Action[`set_user_${t}`](i)}catch{}}},i,i)}},showGame(t=!0){let e=`**${Ls.text("chat","chat_message_text_game_main")}**\n_${Ls.text("chat","chat_message_text_game_ask")}_`;jo.jr("game","default","picker",{id:"ask-game",text:e,choices:[{value:"play",icon:"ð¹ï¸",selected:!1,label:Ls.text("chat","chat_message_text_game_pick_yes"),handler:()=>{fo.start(),co.update("game",!1)}},{value:"ignore",selected:!1,label:Ls.text("chat","chat_message_text_game_pick_no"),handler:()=>{co.update("game",!1)}}]},t,t)},hideGame(){jo.Rr("game")},showFeedback(t=!0){let e=`**${Ls.text("chat","chat_message_text_feedback_main")}**\n_${Ls.text("chat","chat_message_text_feedback_ask")}_`;jo.jr("feedback","default","picker",{id:"ask-feedback",text:e,choices:[{value:"rate",icon:"â­ï¸",selected:!1,label:Ls.text("chat","chat_message_text_feedback_pick_rate"),handler:()=>{ao.show(),co.update("feedback","rate")}},{value:"ignore",selected:!1,label:Ls.text("chat","chat_message_text_feedback_pick_ignore"),handler:()=>{co.update("feedback",!1)}}]},t,t)},showFeedbackSubmitted(t=!0){let e=Ls.text("chat","chat_message_text_feedback_submitted");jo.jr("feedback","submitted","text",e,t,t)},hideFeedback(){jo.Rr("feedback")},showCompose(t,e=!1){let i=jo.compose.is_active||!1;jo.message_compose_timestamp=t,jo.compose.is_active=!0,jo.compose.is_automated=e,!0!==i&&(jo.Or(),Us.scrollToLastMessage("from"))},hideCompose(){jo.compose.is_active=!1,jo.compose.is_automated=!1,jo.message_compose_timestamp=null},kr(t){let e=!0,i=uu.clone(t);if(e=!jo.fingerprints[i.fingerprint],!0===e)void 0===i.read&&(i.read=!1),void 0===i.metas&&(i.metas={is_new:!1,is_pending:!1,error:null},"field"!==i.type&&"picker"!==i.type||(i.metas.field={value:""})),jo.fingerprints[i.fingerprint]=!0,jo.list.push(i);else for(let s=0;s<jo.list.length;s++)if(jo.list[s].fingerprint===i.fingerprint){uu.merge(jo.list[s],i);break}return jo.Mr(i.type,i.content,i.fingerprint,i.from,i.user||{},i.timestamp),e},Ar(t){let e=!1;if(!0===jo.fingerprints[t]){delete jo.fingerprints[t];let i={messages:jo.list,preview:jo.preview};for(let e in i){let s=i[e];if(s.length>0)for(let e=0;e<s.length;e++){let i=s[e];if(i.fingerprint===t){s.splice(e,1),jo.qr(i.type,i.content,i.fingerprint,i.from,i.timestamp);break}}}e=!0}return e},Mr(t,e,i,s,n,r){let o="local"!==n.source&&!Co.includes(n.source)&&!0;"operator"===s&&(jo.message_compose_timestamp&&r>0&&r>jo.message_compose_timestamp&&jo.hideCompose(),r>0&&!0===o&&(ro.update("wait_reply","lock"),co.update("game",!1),jo.Ur(t,e,i))),r>0&&(jo.has_messages=!0,jo.message_last_timestamp=r,!0===o&&("operator"===s?jo.has_received_messages=!0:jo.has_sent_messages=!0),jo.Pr()),!1===Ro.has_local_messages&&"local"===n.source&&(Ro.has_local_messages=!0)},zr(t,e=null){let i=!1,s=jo.getMessageFromStore(t);return s&&(s.metas.is_pending=!1,s.metas.error=e),t in xo&&(uu.clearTimeout(xo[t]),delete xo[t],i=!0),i},qr(t,e,i,s,n){"operator"===s&&n>0&&jo.Tr(t,e,i)},Cr(){jo.has_restored_history=!0,jo.sent_read_fingerprints.length>0&&(jo.acknowledgeReadSend(jo.sent_read_fingerprints,!0),jo.sent_read_fingerprints=[]),Fo.retrigger("intent"),Fo.retrigger("scroll"),Us.focusOnForeground(),jo.Ir(!0)},Sr(){var t,e;let i=Ls.text("theme_welcome",["default_chat",`${null==(t=Tr.chat)?void 0:t.theme_welcome}_chat`],[null==(e=Tr.website)?void 0:e.name]);jo.jr("welcome","default","text",i,!1,!1)},jr(t,e,i,s,n=!1,r=!0){var o,u;if(Co.includes(t)&&jo.website_messages_parts[t]!==e){jo.website_messages_parts[t]=e;let a=(new Date).getTime();"welcome"===t&&(a=0),jo.received({type:i,timestamp:a,content:s,fingerprint:`$${t}`,from:"operator",user:{source:t,type:"website",user_id:null==(o=Ro.website)?void 0:o.id,nickname:null==(u=Tr.website)?void 0:u.name}},!1,n,r,!0)}},Rr(t){Co.includes(t)?jo.website_messages_parts[t]&&(delete jo.website_messages_parts[t],jo.remove(`$${t}`)):We.error(`Source ${t} not allowed`)},Or(){jo.message_compose_timestamp&&((new Date).getTime()-jo.message_compose_timestamp>=12e4?jo.hideCompose():uu.setTimeout(()=>{jo.Or()},5e3))},Pr(){var t;let i=!0===jo.has_messages&&!0!==Ro.is_activity_outdated;if(Ro.is_activity_ongoing!==i){Ro.is_activity_ongoing=i;let s=((null==(t=document.activeElement)?void 0:t.tagName)||"").toLowerCase();"input"!==s&&"textarea"!==s&&e().Chat.Interface.requestDynamicSizingProperties()}},Ur(t,e,i){if(!0===Bo.includes(t)&&!0===e.required){let s=!1;switch(t){case"field":e.value&&(s=!0);break;case"picker":for(let t=0;t<e.choices.length;t++)if(!0===e.choices[t].selected){s=!0;break}}let n=jo.prompt_fingerprints.indexOf(i);!1===s?-1===n&&jo.prompt_fingerprints.push(i):n>-1&&jo.prompt_fingerprints.splice(n,1),wo.is_locked_prompt=jo.prompt_fingerprints.length>0,ro.update("warn_prompt",wo.is_locked_prompt?"show":"hide")}},Tr(t,e,i){if(!0===Bo.includes(t)&&!0===e.required){let t=jo.prompt_fingerprints.indexOf(i);t>-1&&(jo.prompt_fingerprints.splice(t,1),0===jo.prompt_fingerprints.length&&(wo.is_locked_prompt=!1,ro.update("warn_prompt","hide")))}},Ir(t=!1){var e;!1!==(null==(e=null==co?void 0:co.states)?void 0:e.game)&&!0===jo.has_sent_messages&&!0!==jo.has_received_messages&&null===Ao&&(Ao=uu.setTimeout(()=>{var t;Ao=null,!0!==jo.has_received_messages&&!0===(null==(t=Tr.chat)?void 0:t.wait_game)&&co.update("game")},!0===t?3e4:6e4))},Br(t){let e=jo.getMessageFromStore(t);e&&(e.metas.is_pending=!0,xo[t]=uu.setTimeout(()=>{jo.errorRejected(t,"timeout")},3e4))},$r(t){let e=jo.getMessageFromStore(t);e&&(e.metas.is_new=!0,uu.setTimeout(()=>{e.metas.is_new=!1},400))},Er(t,e,i,s){let n=[],r=null,o=[];for(let u=i.length-1;u>=0&&!(e.includes(i[u].fingerprint)&&(n.unshift(i[u]),n.length>=3));u--);jo.preview=[];for(let u=0;u<n.length;u++){let t=n[u],e=uu.clone(t);Eo.includes(t.type)&&jo.preview.push(e),u===n.length-1&&null===r&&(r=e.fingerprint),null===r&&null!==jo.preview_stack_last_fingerprint||o.push(e)}null!==r&&(jo.preview_stack_last_fingerprint=r);for(let u=0;u<o.length;u++)o[u].animate=!0;return uu.setTimeout(()=>{for(let t=0;t<o.length;t++)o[t].animate=!1},1e3+(!0===s?100:0)),n}};Pe.TEST&&(window.$showCompose=(t,e=!1)=>{jo.showCompose(t,e)},window.$hideCompose=()=>{jo.hideCompose()});const jo=Ye({list:[],preview:[],fingerprints:{},compose:{is_active:!1,is_automated:!1},states:{expanded_sources:{}},message_last_timestamp:0,message_compose_timestamp:null,website_messages_parts:{},unread_count:0,operator_details:{},has_sent_messages:!1,has_received_messages:!1,has_messages:!1,has_restored_history:!1,sent_read_fingerprints:[],receive_mirror_fingerprints:[],preview_stack_last_fingerprint:null,prompt_fingerprints:[],latest_fingerprint:null},Io);Ze(()=>{jo.list=[],jo.preview=[],jo.fingerprints={},jo.website_messages_parts={},jo.operator_details={}});const Ro=Ye({session_id:null,session_hash:null,token_id:null,cookie_expire:null,cookie_domain:null,browser_useragent:null,browser_timezone:null,browser_capabilities:[],browser_locales:[],page_domain:null,page_url:null,page_title_current:null,color_mode:"light",is_hidden:!1,is_full_view:!1,is_small_view:!1,is_large_view:!1,is_activity_ongoing:!1,has_interacted:!1,has_local_messages:!1,force_show:!1,error_mode:!1,website:{id:"",domain:""},features:{audio_recording:!1},runtime:{}},{checkIsFullView(){var t;return!0===(null==(t=Ro.runtime)?void 0:t.lock_full_view)||(window.innerHeight<600||window.innerWidth<480)},checkIsSmallView:()=>window.innerHeight<720||window.innerWidth<540,checkIsLargeView:()=>window.innerHeight>840&&window.innerWidth>640,applySizing(){Ro.is_full_view=Ro.checkIsFullView(),Ro.is_small_view=Ro.checkIsSmallView(),Ro.is_large_view=Ro.checkIsLargeView()}});Ro.is_mobile_view=je(()=>!0===Ro.is_full_view&&!0===Jr.has_screen_touch),Ro.is_blocked=je(()=>(!0===Ro.is_blocked_page||!0===Ro.is_blocked_locale)&&!0),Ro.is_activity_outdated=je(()=>jo.message_last_timestamp>0&&(new Date).getTime()-jo.message_last_timestamp>=6e5),Ro.is_blocked_locale=je(()=>{var t,e;let i=Rs.code;return!!(null==(e=null==(t=Tr.chat)?void 0:t.blocked_locales)?void 0:e.includes(i))}),Ro.is_blocked_page=je(()=>{var t,e,i,s;return!(!((null==(e=null==(t=Tr.chat)?void 0:t.allowed_pages)?void 0:e.length)>0)||uu.comparePageRules(Ro.page_url,null==(i=Tr.chat)?void 0:i.allowed_pages))||uu.comparePageRules(Ro.page_url,null==(s=Tr.chat)?void 0:s.blocked_pages)&&!0}),Ro.is_invisible=je(()=>{var t,e,i;let s=!1;return!0===Ro.runtime.lock_maximized||!0===jo.has_messages&&!0!==Ro.is_activity_outdated||(!0===Ro.is_blocked&&(s=!0),!0===(null==(t=Tr.chat)?void 0:t.hide_vacation)&&(s=!0),!0===(null==(e=Tr.chat)?void 0:e.hide_on_away)&&!0!==ws.was_availability_online&&!0!==ws.users_available&&(s=!0),!0===(null==(i=Tr.chat)?void 0:i.hide_on_mobile)&&!0===Ro.is_mobile_view&&(s=!0)),s}),Ro.active_operators=je(()=>{var t;let e=[],i=null==(t=null==Tr?void 0:Tr.website)?void 0:t.active_operators;if(i.length>0)for(let s=0;s<i.length;s++)s<3&&e.push({type:"operator",identifier:i[s].user_id,avatar:i[s].avatar,name:js.name().parse_first_name(i[s].nickname)});return e.push({type:"website",identifier:Ro.website.id}),e}),Ro.other_operators_count=je(()=>{var t,e,i,s;let n=0,r=Tr,o=(null==(e=null==(t=null==r?void 0:r.website)?void 0:t.active_operators)?void 0:e.length)||0;return(null==(i=null==r?void 0:r.website)?void 0:i.count_operators)>o&&(n=(null==(s=null==r?void 0:r.website)?void 0:s.count_operators)-o),n});const Oo=new class extends qs{constructor(){super()}subscribe(t,e){super.subscribe(t,e)}unsubscribe(t,e){super.unsubscribe(t,e)}assistMouse(t){super.emit("assist:mouse",t)}assistScroll(t){super.emit("assist:scroll",t)}assistClick(t){super.emit("assist:click",t)}},Mo="assist";let qo=null;const Uo=Ye({data:null,type:null},{prepare(t){Uo.data=t,Xr(()=>import("./features/browsing_default_e0e2da7.js"),__vite__mapDeps([0,2])).then(t=>{qo=t.default(".cc-1tx1r")})},startAssist(){null===Uo.type&&(Uo.type=Mo)},stopAssist(){Uo.type===Mo&&(Uo.type=null),qo.unmount(),qo=null},pipeMouse(t){Uo.type===Mo&&Oo.assistMouse(t)},pipeScroll(t){Uo.type===Mo&&Oo.assistScroll(t)},pipeClick(t){Uo.type===Mo&&Oo.assistClick(t)}});const Po=new class extends qs{constructor(){super()}subscribe(t,e){super.subscribe(t,e)}unsubscribe(t,e){super.unsubscribe(t,e)}success(t){super.emit("success",t)}};let To=null;const Lo=Ye({is_opened:!1,is_ringing:!1,is_calling:!1,mode:null,state:null,user:{user_id:"",nickname:"",type:""},muted:{audio:!1,video:!1},actions:[]},{ring(t){this.Lr(),yo.initialize("call"),Lo.mode=t.mode,Lo.state=null,Lo.user.user_id=t.user.user_id||Ro.website.id,Lo.user.nickname=js.name().parse_first_name(t.user.nickname)||Tr.website.name,Lo.user.type=t.user.user_id?"operator":"website",Lo.actions=this.Nr(t.mode),Lo.muted.audio=!1,Lo.muted.video=!1,Lo.is_ringing=!0,Xr(()=>import("./features/call_default_e0e2da7.js"),__vite__mapDeps([0,3])).then(t=>{To=t.default(".cc-vx6i0"),Lo.is_opened=!0,yo.start("call","call-ring",!0)})},screen(){this.Lr(!1),this.toggleState("connecting"),Lo.is_ringing=!1,Lo.is_calling=!0},stop(){this.Lr(),Lo.is_calling=!1,Lo.is_ringing=!1,Lo.is_opened=!1,yo.start("call","call-hangup")},success(t){Po.success(t)},error(){this.Lr(),yo.start("call","call-hangup")},toggleMediaStatus(t,e=!1){let i=null;for(let s=0;s<Lo.actions.length;s++){let e=Lo.actions[s];if(e.type===t){i=e;break}}null!==i&&(i.value=e),Lo.muted[t]=!1===e},toggleState(t){Lo.state=t},Lr(t=!0){!0===Lo.is_opened&&!0===t&&(To&&(To.unmount(),To=null),yo.stop("call","call-ring"))},Nr:t=>[{type:"audio",value:!0,visible:!0,supported:!0},{type:"video",value:!0,visible:!0,supported:"video"===t},{type:"hangup",value:!1,visible:!0,supported:!0},{type:"toggle",value:!1,visible:!0,supported:!0},{type:"screensharing",value:!1,visible:!0,supported:zr.Call.hasSupportScreensharing()}]});function No(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}const Vo="File",Ho="application/octet-stream",Wo=Ye({Vr:[],Hr:null,Wr:null,has_drop_zone:!1,state:"none"},{uploadGenerated(t,e,i){if(Wo.Vr[0]){if(!t||!e)return alert(Ls.text("chat","chat_form_attach_alert_quota")),void Wo.Jr();if(Wo.Vr[0].size>=i)return alert(Ls.text("chat","chat_form_attach_alert_size")),void Wo.Jr();Wo.Hr=e,Wo.Gr(t,Wo.Vr[0])}else Wo.Jr()},setDropZone(t){var e;!0===(null==(e=Tr.chat)?void 0:e.file_transfer)&&(Wo.has_drop_zone=t)},handleFileChange(t=[]){if(!1!==jo.checkIntentSend()&&0!==t.length&&"none"===Wo.state){Wo.Vr=[];for(let e=0;e<t.length;e++)Wo.Vr.push(t[e]);Wo.state="preparing",zr.Bucket.getUrlUpload(t[0].name||Vo,t[0].type||Ho)}},Gr(t,e){Wo.Wr=new window.XMLHttpRequest,Wo.Wr.file=e,Wo.Wr.addEventListener("loadstart",No(Wo.Kr,this),!1),Wo.Wr.addEventListener("error",No(Wo.Yr,this),!1),Wo.Wr.addEventListener("abort",No(Wo.Yr,this),!1),Wo.Wr.addEventListener("load",No(Wo.Zr,this),!1),Wo.Wr.open("PUT",t,!0),Wo.Wr.setRequestHeader("Content-Disposition","attachment"),this.Wr.send(e)},Kr(){Wo.state="uploading"},Yr(){Wo.Vr.length>0&&alert(Ls.text("chat","chat_form_attach_alert_error")),Wo.Jr()},Zr(){if(200!==Wo.Wr.status&&201!==Wo.Wr.status)return Wo.Yr();if(0===Wo.Vr.length)return;if(!Wo.Hr)return;let t=Wo.Vr[0];uu.setTimeout(()=>{var i;(null==(i=t.type)?void 0:i.includes("audio/"))&&"number"==typeof t.duration?e().Action.do_message_send("audio",{url:Wo.Hr,type:t.type,duration:t.duration}):e().Action.do_message_send("file",{url:Wo.Hr,name:t.name||Vo,type:t.type||Ho}),Wo.Jr()},2e3)},Jr(){Wo.Wr&&(Wo.Wr.removeEventListener("loadstart",Wo.Kr,!1),Wo.Wr.removeEventListener("error",Wo.Yr,!1),Wo.Wr.removeEventListener("abort",Wo.Yr,!1),Wo.Wr.removeEventListener("load",Wo.Zr,!1));let t=document.querySelector(".cc-1grbu");t&&(t.value=null),Wo.state="none",Wo.Vr.shift(),Wo.Vr.length>0&&Wo.handleFileChange(Wo.Vr)}});function Jo(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}const Go=[["weba","audio/webm; codecs=opus"],["weba","audio/webm; codecs=vorbis"],["oga","audio/ogg; codecs=vorbis"],["m4a","audio/mp4; codecs=mp4a.40.5"]],Ko=Ye({Xr:null,Qr:!1,eo:!1,so:null,state:"none",duration:0,progress:0,mime:"",chunks:[],extension:null},{record(){!1!==Jr.has_audio_recording&&!0===Tr.chat.audio_record&&null===Ko.Xr&&navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(t=>{for(let e=0;e<Go.length;e++){let t=Go[e];if(!0===window.MediaRecorder.isTypeSupported(t[1])){Ko.extension=t[0],Ko.mime=t[1];break}}null!==Ko.extension&&null!==Ko.mime&&(Ko.Xr=new window.MediaRecorder(t,{mimeType:Ko.mime,audioBitsPerSecond:64e3}),Ko.Xr.addEventListener("start",Jo(Ko.no,this)),Ko.Xr.addEventListener("stop",Jo(Ko.ro,this)),Ko.Xr.addEventListener("resume",Jo(Ko.oo,this)),Ko.Xr.addEventListener("pause",Jo(Ko.uo,this)),Ko.Xr.addEventListener("dataavailable",Jo(Ko.ao,this)),Ko.Xr.addEventListener("error",Jo(Ko.lo,this)),Ko.Xr.start())}).catch(t=>{alert(Ls.text("chat","chat_form_speech_capture_error"))})},cancel(){null!==Ko.Xr&&!0!==Ko.Qr&&(Ko.Qr=!0,Ko.eo=!0,Ko.Xr.stop())},send(){null!==Ko.Xr&&!0!==Ko.Qr&&(Ko.Qr=!0,Ko.Xr.stop())},no(){Ko.duration=0,Ko.progress=0,Ko.oo()},ro(){if(Ko.state="none",Ko.ho(),!0!==Ko.eo){let t=(new Date).getTime(),e=new window.File(Ko.chunks,`audio_${t}.${Ko.extension}`,{type:Ko.mime.split(";")[0].trim(),lastModified:t});e.duration=Ko.duration,Wo.handleFileChange([e])}let t=Ko.Xr.stream.getTracks();for(let e=0;e<t.length;e++)t[e].stop();Ko.co()},uo(){Ko.ho(),Ko.state="paused"},oo(){Ko.state="recording",Ko.Do()},ao(t){t.data.size>0&&Ko.chunks.push(t.data)},lo(t){alert(Ls.text("chat","chat_form_speech_capture_error"))},Do(){if(null===Ko.so){let t=90;Ko.so=uu.setInterval(()=>{Ko.duration>=t?Ko.Xr.pause():(Ko.duration++,Ko.progress=Math.floor(100*Math.min(Ko.duration/t,1)))},1e3)}},ho(){null!==Ko.so&&(uu.clearInterval(Ko.so),Ko.so=null)},co(){Ko.Xr=null,Ko.Qr=!1,Ko.eo=!1,Ko.so=null,Ko.duration=0,Ko.progress=0,Ko.mime="",Ko.chunks=[],Ko.extension=null}});je(()=>{var t;return!0!==Ro.runtime.lock_maximized&&(!0===(null==(t=Tr.chat)?void 0:t.hide_vacation)||!0===Ro.is_blocked)});const Yo=Ye({},{}),Zo=Ye({bundle:{pending:{chat:!1,overlay:!1}}},{});var Xo={availability:ws,base:Ro,browsing:Uo,call:Lo,chat:wo,chatAlert:ro,chatFrame:Do,chatIntent:co,chatFeedback:ao,chatPicker:oo,chatFile:Wo,chatSpeech:Ko,common:Yo,feature:Jr,game:fo,helpdesk:Kr,messages:jo,minimized:no,overlay:io,partial:Zo,state:Fo,locale:Rs,website:Tr};const Qo=new class{constructor(){this.$store=Xo}install(t){t.config.globalProperties.$store=Xo}},tu=/([*]{1})/g,eu=/([*]{2})/g,iu=/^([!]{1})/,su=/(\[match:single\])/g,nu=/(\[match:double\])/g,ru=/(\[match:negate\])/g,ou=new RegExp(["^(\\!)?","(?:https?:[\\/]*)?","(?:www\\.)?([^\\/]+)([^#?]*)?","(?:[\\/]+)?","(?:[#?].*)?"].join(""),"i");const uu=new class extends Ge{constructor(){super(),this.In()}reset(){this.In()}getOrFallback(t,e,i=null){let s=t;return s=null!==i?typeof t!==i?e:t:t||e,s}filterImageUrlResize(t,e,i){let s=Pe.URL_IMAGE;return this.fo(t,`${s}/process/resize/?url=${encodeURIComponent(t)}&width=${e}&height=${i}`)}filterImageUrlOriginal(t){let e=Pe.URL_IMAGE;return this.fo(t,`${e}/process/original/?url=${encodeURIComponent(t)}`)}toHashCode(t){let e=0;if(t.length>0)for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return e}isEmpty(t){return 0===this.keys(t).length}isEqual(t,e){let i,s,n=!0,r=-1;if(typeof t!=typeof e)n=!1;else if(t&&"object"==typeof t&&e&&"object"==typeof e)for(t instanceof Array||e instanceof Array?(s=this.union(t,e),t.length===s.length&&e.length===s.length||(n=!1)):s=this.union(this.keys(t),this.keys(e));++r<s.length&&!0===n;)i=s[r],n=this.isEqual(t[i],e[i]);else n=t===e;return n}keys(t){let e=[];return"object"==typeof t&&t&&(e=Object.keys(t)),e}clone(t){let e,i,s=Array.isArray(t)?[]:{};for(e in t)i=t[e],s[e]="object"==typeof i&&null!==i?this.clone(i):i;return s}merge(t,e){if("object"!=typeof t||!t)return t;if("object"!=typeof e||!e)return t;for(let i in e)e.hasOwnProperty(i)&&("object"!=typeof e[i]||null===e[i]||Array.isArray(e[i])?t[i]=e[i]:(("object"!=typeof t[i]||null===t[i]||Array.isArray(t[i]))&&(t[i]={}),this.merge(t[i],e[i])));return t}intersect(t,e){let i=[];for(let s=0;s<t.length;s++)e.includes(t[s])&&i.push(t[s]);return i}union(t,e){let i=[];for(let s=0;s<t.length;s++)i.includes(t[s])||i.push(t[s]);for(let s=0;s<e.length;s++)i.includes(e[s])||i.push(e[s]);return i}extract(t,e,i="",s=1){let n=e||i||"",r=(e||"").trim().match(t);return n=(null==r?void 0:r[s])?r[s]:i||"",n}compareRule(t,e,i=".",s="."){let n=!1;return!0===iu.test(e)&&(e=(e=e.replace(iu,"[match:negate]")).replace(ru,"")),e.includes("*")?(e=(e=(e=(e=e.replace(eu,"[match:double]")).replace(tu,"[match:single]")).replace(nu,s+"*")).replace(su,i+"*"),n=new RegExp(`^${e}$`).test(t)):n=t===e,n}compareRules(t,e,i,s=".",n="."){let r=!1,o=!1,u=!1;if(e.length>0){let i=0;for(;i<e.length&&!0!==o;)o=this.compareRule(t,e[i],s,n),i++;!1===o&&(r=!0)}if(!1===o&&i.length>0){let e=0;for(;e<i.length&&!0!==u;)u=this.compareRule(t,i[e],s,n),e++;r=u}return r}normalizeUrlPath(t,e,i=""){let s="";return e?e.length>1&&"/"!==e[e.length-1]&&"*"!==e[e.length-1]&&(e+="/"):e="/",s=`${i}${t}${e}`,s}comparePageRules(t,e,i=null){var s,n;let r=!1;if((null==e?void 0:e.length)>0){let o,u=[],a=[],l=[];null===i&&(i=null==(n=null==(s=Xo.website)?void 0:s.website)?void 0:n.domain);for(let t=0;t<e.length;t++){let s=(e[t]||"").trim();s&&(!1===ou.test(s)&&(s=this.normalizeUrlPath(i,s)),o=s.match(ou),o?u.push(this.normalizeUrlPath(o[2],o[3],o[1])):u.push(`${i}${s}`))}let h=t.match(ou),c=h?this.normalizeUrlPath(h[2],h[3],h[1]):null;for(let t=0;t<u.length;t++)!0===iu.test(u[t])?a.push(u[t]):l.push(u[t]);!0===this.compareRules(c,a,l,"[^/]",".")&&(r=!0)}return r}playMedia(t){let e=t.play();void 0!==e&&"function"==typeof e.catch&&e.catch(t=>{})}openLink(t){let e=window.open();e.opener=null,e.location=t}acquireChannelUrlRegex(t,e,i=""){var s;let n=null;if(Xo.website.channels[t]&&(n=null==(s=this.po[t])?void 0:s[e],!n)){let s=Xo.chat.generateChannelLink("helpdesk");n=new RegExp(`^${js.parse().escape_regex(s)}${i}$`),this.po[t]=this.po[t]||{},this.po[t][e]=n}return n}nextRender(t){di(t)}setTimeout(t,e=0){let i=null;if(!zr.Schedule)throw new Error(`Could not set timeout after ${e}ms, as the schedule wrapper is not yet available`);return i=zr.Schedule.setTimeout(t,e),i}clearTimeout(t){if(!zr.Schedule)throw new Error(`Could not clear timeout #${t}, as the schedule wrapper is not yet available`);zr.Schedule.clearTimeout(t)}setInterval(t,e=0){let i=null;if(!zr.Schedule)throw new Error(`Could not set interval every ${e}ms, as the schedule wrapper is not yet available`);return i=zr.Schedule.setInterval(t,e),i}clearInterval(t){if(!zr.Schedule)throw new Error(`Could not clear interval #${t}, as the schedule wrapper is not yet available`);zr.Schedule.clearInterval(t)}addEventListener(t,e,i,s={}){return zr.Listener.addEventListener(t,e,i,s)}removeEventListener(t,e,i){zr.Listener.removeEventListener(t,e,i)}insertLinkQueryValues(t,e={}){let i=t;if((null==i?void 0:i.length)>0){let t="";for(let i in e)t&&(t+="&"),t+=`${i}=${encodeURIComponent(e[i])}`;if((null==t?void 0:t.length)>0){let e=i[i.length-1];"?"!==e&&"&"!==e&&(i+=!0===i.includes("?")?"&":"?"),i+=t}}return i}fo(t,e){let i=Pe.URL_IMAGE;return t.substring(0,i.length)===i?t:e}In(){this.po={}}},au=/^(([^\s@]+)@([^\s@]+)\.([^\s@]+))$/,lu=new RegExp(["^(?:(?:\\(?(?:00|\\+)([1-4]\\d\\d|[1-9]\\d?)\\)?)?","[\\-\\.\\ \\\\\\/]?)?((?:\\(?\\d{1,}\\)?[\\-\\.\\ \\\\\\/]?){0,})","(?:[\\-\\.\\ \\\\\\/]?(?:#|ext\\.?|extension|x)[\\-\\.\\ \\\\/]?","(\\d+))?$"].join(""),"i"),hu=/^https?:\/\/(.+)$/,cu=/^([A-Za-z0-9_\\-]{1,50})$/;const du=new class{isEmail(t){return au.test(t)}isPhone(t){return lu.test(t)}isAvatar(t){return hu.test(t)}isData(t){let e=!1;if(t instanceof Object){e=uu.keys(t).length>0&&!0;for(let i in t){let s=t[i];if("string"!=typeof i||!0!==cu.test(i)||"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s){e=!1;break}}}return e}areEvents(t){let e=!1;if(t instanceof Array){e=t.length>0&&!0;for(let i=0;i<t.length;i++)if("string"!=typeof t[i][0]||!t[i][0]||!1===uu.isEmpty(t[i][1])&&!1===this.isData(t[i][1])){e=!1;break}}return e}areSegments(t){let e=!1;if(t instanceof Array){e=!0;let i=[];for(let s=0;s<t.length;s++){let n=t[s]||"",r="";if("string"==typeof n&&(r=n.trim()),!r||r.length>80||i.includes(r)){e=!1;break}i.push(r)}}return e}},Du=Pe.THEME.DEFAULT_COLOR,fu=Pe.THEME.AVAILABLE_COLORS,pu=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,mu=/_/g;const _u=new class{applyTheme(t,e=!1){let i=document.querySelector(".crisp-client"),s=this.mo(t,e);for(let n in s)i.style.setProperty(`--crisp-color-theme-${n}`,s[n].rgb)}applyContainerIndex(t){let e=document.querySelector(".crisp-client");t&&e.style.setProperty("--crisp-customization-container-index",t.toString())}applyPosition(t){let e=document.querySelector(".crisp-client"),i=this._o(t);for(let s in i){let t=s.replace(mu,"-");e.style.setProperty(`--crisp-customization-${t}`,`${i[s]}px`)}}mo(t,e=!1){let i,s,n={};i=!0!==e?Ps.getCustomization("color","chatbox"):{},s=fu[t]||fu[Du],this.Fo(i,s);for(let r in i)n[r]={hex:i[r],rgb:this.vo(i[r])};return n}_o(t){let e=Ps.getCustomization("position","chatbox");for(let i in t)e[i]=t[i];return e}Fo(t,e){for(let i in e)t[i]||(t[i]=e[i])}vo(t){let e=[0,0,0],i=t.match(pu);return i&&(e[0]=parseInt(i[1],16),e[1]=parseInt(i[2],16),e[2]=parseInt(i[3],16)),`${e[0]}, ${e[1]}, ${e[2]}`}},Fu=["session:loaded","chat:initiated","chat:opened","chat:closed","message:sent","message:received","message:compose:sent","message:compose:received","user:email:changed","user:phone:changed","user:nickname:changed","user:avatar:changed","website:availability:changed","helpdesk:queried"],gu=/^(light|dark)$/,vu=/^([a-f0-9]{64})$/;class wu extends Ge{constructor(t){super(),this.client=t,this._eventPipeMethods={on:this.wo,off:this.bo},this.yo={}}reset(){void 0===this.client.Base._dollarCrisp.__spool.pending_actions&&(this.client.Base._dollarCrisp.__spool.pending_actions=[])}do_chat_open(t=null){!0===this.client.Chat._isInitialized?(Xo.chat.maximize(),"function"==typeof t&&t()):Xo.minimized._paneOpenHandler(e=>{this.client.Chat.init(e,t)})}do_chat_close(){!0===this.client.Chat._isInitialized&&Xo.chat.minimize()}do_chat_toggle(){!0===this.is_chat_closed()?this.do_chat_open():this.do_chat_close()}do_chat_show(){!1!==this.is_chat_hidden()&&(Xo.base.is_hidden=!1,Xo.base.force_show=!0,!0===this.client.Chat._isInitialized&&(this.client.Chat.Interface.requestDynamicSizingProperties(),this.client.Chat.Interface.applyChatFocus()))}do_chat_hide(){!1!==this.is_chat_visible()&&(Xo.base.is_hidden=!0,Xo.base.force_show=!1,!0===this.client.Chat._isInitialized&&this.client.Chat.Interface.applyChatFocus())}do_helpdesk_search(){Xo.helpdesk.doSearch()}do_helpdesk_article_open(t,e,i=null,s=null){if("string"!=typeof t||!t)throw new Error("Invalid article locale");if("string"!=typeof e||!e)throw new Error("Invalid article slug");Xo.helpdesk.articleOpen(t,e,i,s)}do_helpdesk_query(t=""){this.client.Base.ensureSocket().then(()=>{zr.Helpdesk.getArticleSearch(t,Xo.locale.code)})}do_overlay_open(t=null){if(!0!==Xo.overlay.open(t))throw new Error("Overlay is unavailable (was it disabled?)")}do_overlay_close(){Xo.overlay.close()}do_message_send(t,e){this.client.Base.ensureSocket().then(()=>{let i=this.Eo(t,e);null!==i.type&&null!==i.content&&this.client.Chat.startMaximized(()=>{let t=!0===Xo.messages.triggerWillSendHooks()?500:0;switch(i.type){case"text":zr.Message.sendTextMessage(i.content,t);break;case"file":zr.Message.sendFileMessage(i.content.name,i.content.url,i.content.type,t);break;case"animation":zr.Message.sendAnimationMessage(i.content.url,i.content.type,t);break;case"audio":zr.Message.sendAudioMessage(i.content.url,i.content.type,i.content.duration,t);break;case"picker":zr.Message.sendPickerMessage(i.content.id,i.content.text,i.content.choices,t);break;case"field":zr.Message.sendFieldMessage(i.content.id,i.content.text,i.content.explain,t);break;case"carousel":zr.Message.sendCarouselMessage(i.content.text,i.content.targets,t)}})})}do_message_show(t,e,i=null,s=!1){this.client.Base.ensureSocket().then(()=>{let n=this.Eo(t,e);null!==n.type&&null!==n.content&&Xo.messages.dispatchLocal(n.type,n.content,i,s)})}do_message_read(){!0===this.client.Chat._isInitialized&&zr.Message.markMessagesAsRead()}do_message_thread_start(t){if("string"!=typeof t||!t)throw new Error("Invalid message thread start text");if(!0!==this.client.Chat._isInitialized)throw new Error("Chat must be active for message thread to start");this.client.Base.ensureSocket().then(()=>{zr.Message.sendMessageThread("start",t)})}do_message_thread_end(t=""){if("string"!=typeof t&&!t)throw new Error("Invalid message thread end text");if(!0!==this.client.Chat._isInitialized)throw new Error("Chat must be active for message thread to end");this.client.Base.ensureSocket().then(()=>{zr.Message.sendMessageThread("end",t||"")})}do_session_reset(t=!1){!1===t&&(this.client.Base.uninsertClient(),this.client.Base.reset()),this.client.Base.updateSocketCookieKey(!1,!0),zr.Session.reset(),!1===t?uu.nextRender(()=>{this.client.Base.reTriggerLoader()}):document.location.reload()}do_trigger_run(t){if(!0!==this.client.Trigger.run(t))throw new Error("Trigger does not exist")}do_bot_scenario_run(t){if("string"!=typeof t||!t)throw new Error("Invalid bot scenario identifier");this.client.Base.ensureSocket(!0).then(()=>{zr.Session.sendPluginAction("urn:crisp.im:bot:0",{action:"run",scenario:t})})}is_chat_opened(){return!(!0!==Xo.chat.is_opened||!0!==this.client.Chat._isInitialized)}is_chat_closed(){return!1===this.is_chat_opened()&&!0}is_chat_visible(){return!1===this.is_chat_hidden()&&!0}is_chat_hidden(){return(null===this.client.Base._containerEl||!0===Xo.base.is_hidden||null===this.client.Base._containerEl.offsetParent)&&!0}is_chat_small(){return!1===Xo.base.is_full_view&&!0}is_chat_large(){return!1===this.is_chat_small()&&!0}is_session_ongoing(){return(!0===Xo.messages.has_sent_messages||!0===Xo.messages.has_received_messages)&&!0}is_website_available(){return Xo.availability.users_available&&!0}is_overlay_opened(){return!0===Xo.overlay.is_opened&&!0}is_overlay_closed(){return!1===this.is_overlay_opened()&&!0}get_chat_unread_count(){return Xo.messages.unread_count||0}get_message_text(){return!0===this.client.Chat._isInitialized&&Xo.chat.message||""}get_session_identifier(){return Xo.base.session_id||null}get_session_data(t=null){return zr.Session.getData(t)||null}get_user_email(){return zr.Session.getEmail()||null}get_user_phone(){return zr.Session.getPhone()||null}get_user_nickname(){return zr.Session.getNickname()||null}get_user_avatar(){return zr.Session.getAvatar()||null}get_user_company(){var t,e;let i=zr.Session.getCompany()||null;return(null==(t=null==i?void 0:i.employment)?void 0:t.title)&&(i.employment=[i.employment.title,i.employment.role]),(null==(e=null==i?void 0:i.geolocation)?void 0:e.country)&&(i.geolocation=[i.geolocation.country,i.geolocation.city||null]),i}set_message_text(t=null){Xo.chat.setMessageText(t)}set_session_data(t,e){this.client.Base.ensureSocket(!0).then(()=>{let i=t instanceof Array&&t[0]instanceof Array?t:[[t,e]],s={};for(let t=0;t<i.length;t++){let e=i[t][1];e&&"string"==typeof e&&("false"===e?e=!1:"true"===e?e=!0:!1===isNaN(Number(e))&&(e=Number(e))),s[i[t][0]]=e}if(!0!==du.isData(s))throw new Error("Invalid data");zr.Session.setData(s);for(let t in s)this.client.Trigger.doEvent("user_data",{key:t,value:s[t]})})}set_session_segments(t,e=!1){this.client.Base.ensureSocket(!0).then(()=>{if(!t||!0!==du.areSegments(t))throw new Error("Invalid segments value");zr.Session.setSegments(t,e)})}set_session_event(t,e=null,i=null){this.client.Base.ensureSocket(!0).then(()=>{let s=t instanceof Array&&t[0]instanceof Array?t:[[t,e,i]];if(!0!==du.areEvents(s))throw new Error("Invalid event text or data");zr.Session.sendEvent(s);for(let t=0;t<s.length;t++)this.client.Trigger.doEvent("user_event",{text:s[t][0]})})}set_user_email(t=null,e=null){if(!t||!0!==du.isEmail(t))throw new Error("Invalid email");if(null!==e&&!0!==vu.test(e))throw new Error("Invalid verify signature (should be lowercase HMAC-SHA256)");zr.Session.setEmail(t,!1,e),this.Co(),this.event("user:email:changed",t)}set_user_phone(t=null){if("number"==typeof t&&(t=`${t}`),!t||!0!==du.isPhone(t))throw new Error("Invalid phone");zr.Session.setPhone(t),this.Co(),this.event("user:phone:changed",t)}set_user_nickname(t=null){if("string"!=typeof t||!t)throw new Error("Invalid nickname");zr.Session.setNickname(t),this.event("user:nickname:changed",t)}set_user_avatar(t=null){if(!t||!0!==du.isAvatar(t))throw new Error("Invalid avatar");zr.Session.setAvatar(t),this.event("user:avatar:changed",t)}set_user_company(t,e={}){var i,s;if(!t)throw new Error("Invalid company name");{let n={name:t};if(e.url){if("string"!=typeof e.url)throw new Error("Invalid URL");n.url=e.url}if(e.description){if("string"!=typeof e.description)throw new Error("Invalid description");n.description=e.description}if(null==(i=e.employment)?void 0:i[0]){if("string"!=typeof e.employment[0]||"string"!=typeof e.employment[1])throw new Error("Invalid employment");n.employment={title:e.employment[0],role:e.employment[1]}}if(null==(s=e.geolocation)?void 0:s[0]){if("string"!=typeof e.geolocation[0]||e.geolocation[1]&&"string"!=typeof e.geolocation[1])throw new Error("Invalid geolocation");n.geolocation={country:e.geolocation[0],city:e.geolocation[1]||null}}zr.Session.setCompany(n)}}config_availability_tooltip(t=!1){this.client.Base.updateConfiguration("availability_tooltip",t),!0===t&&!0!==Xo.base.is_full_view&&(Xo.minimized.pane.general_entice.visible=!0)}config_hide_vacation(t=!1){this.client.Base.updateConfiguration("hide_vacation",t)}config_hide_on_away(t=!1){this.client.Base.updateConfiguration("hide_on_away",t)}config_hide_on_mobile(t=!1){this.client.Base.updateConfiguration("hide_on_mobile",t)}config_position_reverse(t=!1){this.client.Base.updateConfiguration("position_reverse",t)}config_sound_mute(t=!1){yo.mute(t)}config_color_theme(t=null){_u.applyTheme(t)}config_color_mode(t=null){if(!t||!0!==gu.test(t))throw new Error("Invalid color mode");Xo.base.color_mode=t}config_container_index(t=null){_u.applyContainerIndex(t)}config_show_operator_count(t=!0){Xo.chat.show_operator_count=t}event(t,e=[]){if(!Fu.includes(t))throw new Error(`Event namespace not recognized: ${t}`);"function"==typeof this.yo[t]&&uu.nextRender(()=>{try{this.yo[t].apply(window,e instanceof Array?e:void 0!==e?[e]:[])}catch{}})}unstackPending(){let t=this.client.Base._dollarCrisp.__spool.pending_actions;if(delete this.client.Base._dollarCrisp.__spool.pending_actions,(null==t?void 0:t.length)>0)for(let e=0;e<t.length;e++)try{Cu.push(t[e])}catch{}}wo(t,e){if("function"!=typeof e)throw new Error("Handler must be a function");this.yo[t]=e}bo(t){void 0!==this.yo[t]&&delete this.yo[t]}Co(){!0===this.client.Chat._isInitialized&&(!0===Xo.messages.has_sent_messages&&Xo.chatAlert.update("wait_reply","show"),Xo.chatAlert.update("warn_reply","hide"),Xo.chatAlert.update("email_invalid","hide"),Xo.chatIntent.update("identity",!1))}Eo(t,e){let i={type:null,content:null};switch(t){case"text":if("string"!=typeof e||!e)throw new Error("Invalid text message");i.type="text",i.content=e;break;case"file":if("object"!=typeof e||!e.name||!e.url||!e.type)throw new Error("Invalid file message");i.type="file",i.content={name:e.name,url:e.url,type:e.type};break;case"animation":if("object"!=typeof e||!e.url||!e.type)throw new Error("Invalid animation message");i.type="animation",i.content={url:e.url,type:e.type};break;case"audio":if("object"!=typeof e||!e.url||!e.type||!e.duration)throw new Error("Invalid audio message");i.type="audio",i.content={url:e.url,type:e.type,duration:e.duration};break;case"picker":if("object"!=typeof e||!e.id||!e.text||0===(e.choices||[]).length)throw new Error("Invalid picker message");i.type="picker",i.content={id:e.id,text:e.text,choices:e.choices};break;case"field":if("object"!=typeof e||!e.id||!e.text||!e.explain)throw new Error("Invalid field message");i.type="field",i.content={id:e.id,text:e.text,explain:e.explain};break;case"carousel":if("object"!=typeof e||!e.text||0===(e.targets||[]).length)throw new Error("Invalid carousel message");i.type="carousel",i.content={text:e.text,targets:e.targets}}return i}}const bu=["get","set","is","do","on","off","config","safe","help"],yu=["on","off"],Eu=/:/g;const Cu=new class{constructor(){this._safeMode=!1,this.In()}reset(){this.In()}push(t){var e;let i=(null==(e=window.$__CRISP_INSTANCE)?void 0:e.__spool)||{};void 0!==i.pending_actions?i.pending_actions.push(t):t[0]&&void 0!==t[1]&&bu.includes(t[0])&&"function"==typeof this[t[0]]&&this[t[0]](t[1],t[2]||[])}get(t,e=[]){return this.ko("get",t,this.$o(e))}set(t,e=[]){return this.ko("set",t,this.$o(e))}is(t){return this.ko("is",t)}do(t,e=[]){return this.ko("do",t,this.$o(e))}on(t,e){return this.Bo("on",t,[t,e])}off(t){return this.Bo("off",t,[t])}config(t,e=[]){return this.ko("config",t,this.$o(e))}safe(t=!0){if("boolean"!=typeof t)throw new Error("Safe mode value must be 'true' or 'false'.");this._safeMode=t}help(){let t=[];for(let i in e().Action){let s=i.split("_");s.length>1&&bu.includes(s[0])&&"function"==typeof e().Action[i]&&t.push(`$crisp.${s[0]}('${s.slice(1).join(":")}')`)}for(let e=0;e<yu.length;e++)for(let i=0;i<Fu.length;i++)t.push(`$crisp.${yu[e]}('${Fu[i]}')`);return t}$o(t){return t?t instanceof Array?t:[t]:[]}ko(t,i,s=[]){let n=null,r=null;try{let r=`${t}_${(i||"").replace(Eu,"_")}`;"function"==typeof e().Action[r]?n=e().Action[r].apply(e().Action,s):this.Ao(i)}catch(o){!0!==this._safeMode&&(r=o)}if(null!==r)throw r;return n}Bo(t,i,s=[]){let n=null,r=null;try{let r=e().Action._eventPipeMethods[t];if("function"!=typeof r)throw new Error(`No such event method for action: ${t}`);Fu.includes(i)?n=r.apply(e().Action,s):this.Ao(i)}catch(o){!0!==this._safeMode&&(r=o)}if(null!==r)throw r;return n}Ao(t){throw new Error(`No such namespace: ${t} - Call $crisp.help() for a list of available actions.`)}In(){this._safeMode=!1}};function ku(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}function $u(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}const Bu={capture:!1};class Au extends Ge{constructor(t){super(),this.client=t,this._isInactive=!1,this._isZombie=!1,this.In()}init(){this.xo()}reset(){null!==this.So&&uu.clearTimeout(this.So),this.In()}triggerInteracted(t=!1){Xo.base.has_interacted=!0,this.zo(),!0===t&&this.Io()}checkActivityAutokill(){null===this.jo&&this.Ro(),null===this.Oo&&this.Mo()}xo(){this.qo(),this.Uo(),this.Po()}qo(){uu.addEventListener("window","resize",()=>{null!==this.So&&(uu.clearTimeout(this.So),this.So=null);let t=()=>{!0===this.client.Chat._isInitialized?(this.client.Chat.Interface.refreshResizePageScroll(),this.client.Chat.Interface.requestDynamicSizingProperties()):Xo.base.applySizing()};Xo.base.is_mobile_view?(t(),this.So=uu.setTimeout(()=>{this.So=null,t()},300)):t()})}Uo(){this.zo(),uu.addEventListener("window","click",$u(this.To,this),Bu),uu.addEventListener("window","touchend",$u(this.To,this),Bu),uu.addEventListener("window","touchmove",$u(this.To,this),Bu),uu.addEventListener("window","keydown",$u(this.To,this),Bu),uu.addEventListener("window","mousemove",$u(this.zo,this),Bu),uu.addEventListener("window","focus",$u(this.zo,this),Bu),uu.addEventListener("window","blur",$u(this.zo,this),Bu)}Po(){this.Io()}To(){this.triggerInteracted()}zo(){null!==this.jo&&uu.clearTimeout(this.jo),this.jo=uu.setTimeout(()=>{this.jo=null,this.Ro()},6e5),!0===this._isInactive&&!1===this._isZombie&&zr.socket.connect(),this._isInactive=!1,zr.Session.markActive()}Ro(){!0===zr.socket.connected&&(this._isInactive=!0,zr.socket.disconnect())}Io(){null!==this.Oo&&uu.clearTimeout(this.Oo),this.Oo=uu.setTimeout(()=>{this.Oo=null,this.Mo()},36e5),!0===this._isZombie&&zr.socket.connect(),this._isZombie=!1}Mo(){!0!==zr.socket.connected&&!0!==this._isInactive||(this._isZombie=!0,!0===zr.socket.connected&&zr.socket.disconnect())}In(){this._isInactive=!1,this._isZombie=!1,this.jo=null,this.Oo=null,this.So=null}}class xu extends Ge{constructor(t){super(),this.client=t,this.Lo=!1,this.No=null,this.In()}init(){this.Vo()}reset(){this.In()}toggleChatMode(t=!1){"chat"===Xo.chat.mode||!0!==t&&!0===Xo.helpdesk.settings_only||(Xo.chat.mode="chat",this.requestDynamicSizingProperties())}toggleVisibility(t="pane",e=!0){let i=(t,e)=>{!0===(t!==e)&&(Xo.chat.is_opened=t,uu.nextRender(()=>{this.Ho(t)}))};(t=>{let s=Xo.chat.is_opened;if(Xo.chat.is_maximized=t,!0===e){let e=!0!==t?"animate_minimize":"animate_maximize";!0===t?Xo.chat.is_opened=!0:this.Ho(!1),null!==this.Wo&&(uu.clearTimeout(this.Wo),Xo.chat.animate_minimize=!1,Xo.chat.animate_maximize=!1),Xo.chat[e]=!0,this.Wo=uu.setTimeout(()=>{this.Wo=null,Xo.chat[e]=!1,i(t,s)},350)}else i(t,s)})("pane"!==t),!0===e&&this.applyChatFocus()}toggleSocketState(t=!1,e=!1){null!==this.Jo&&uu.clearTimeout(this.Jo),this.Jo=uu.setTimeout(()=>{this.Jo=null,Xo.chat.has_offline=!0!==t;let i={failed:e,inactive:this.client.Event._isInactive||this.client.Event._isZombie||!1};for(let t in i)Xo.chat[`reconnect_${t}`]=i[t]},!0===t?0:1e3)}applyChatFocus(){let t=Xo.chat.has_chat_focus;zr.Message.setMessagesInView(t)}pane(){this.Go(),this.No=Mr.dom('<div class="cc-1kr6o cc-cxjxh cc-jx6a3"><div class="cc-rsqmy" id="crisp-chatbox-chat" :data-visible="$store.chat.is_opened" :data-chat-status="$store.chat.status_marker" :data-animate-minimize="$store.chat.animate_minimize" :data-animate-maximize="$store.chat.animate_maximize"></div><div class="cc-18ov6" id="crisp-chatbox-button" v-crisp-accessibility="{ role: \'button\' }" @click.prevent.stop="$store.chat.onPaneToggleClick" :data-visible="$store.chat.is_opened" :data-maximized="$store.chat.is_opened" :data-animate-maximize="$store.chat.animate_maximize" :data-animate-minimize="$store.chat.animate_minimize" :data-pane-animate-entrance="$store.minimized.pane?.animate_entrance" :aria-label="$store.chat.is_opened ? $render._e(\'minimized\', \'tooltip_button_close_hint\') : $render._e(\'minimized\', \'tooltip_button_open_hint\')" data-is-failure="false"><span class="cc-1442g"><span class="cc-17cli" v-if="!$store.chat.is_opened &amp;&amp; $store.minimized.tooltips?.new_messages?.visible" @click="$store.chat.onPaneTooltipNewMessagesClick" :class="{ \'cc-1ok7i\': $store.minimized.tooltips?.new_messages?.animate }" data-id="new_messages"><span class="cc-1xtn0" v-if="$store.messages?.preview?.length &gt; 0"><span class="cc-qspya"><span class="cc-14kee cc-orziz"></span></span><span class="cc-7qtvq"><span class="cc-17smt" v-for="message in $store.messages?.preview" :class="{ \'cc-2b8z3\': message.animate &amp;&amp; $store.feature.has_css_animations  }"><span class="cc-19ujn"><span class="cc-183u6 cc-1egul"><span class="cc-qnxjf cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(120, (message.user?.type || message.from), message.user?.user_id, message.user?.avatar) + \') !important\') }"></span></span><span class="cc-113ud"><span class="cc-1gcap"></span><span class="cc-1pfsk"><span class="cc-19d4b cc-1plpv">{{ $render._e("chat", "minimized_tooltip_message_from") }}</span><span class="cc-zkyxg cc-vqf16">{{ (message.user?.type === \'website\') ? message.user?.nickname : $render._n(message.user?.nickname) }}</span><span class="cc-7iqkz"></span></span><span class="cc-shexu cc-1plpv" v-if="message?.type === \'text\'" v-html="$render._f(message.content)"></span><span class="cc-shexu cc-1plpv" v-else-if="message?.type === \'picker\' || message?.type === \'field\' || message?.type === \'carousel\'" v-html="$render._f(message.content.text)"></span><span class="cc-shexu" v-else-if="message?.type === \'file\' || message?.type === \'animation\'"><span class="cc-x4hk6" v-if="message?.content?.type === \'image/gif\' || message?.type === \'animation\'" :style="{ backgroundImage: (\'url(\' + $render.imageUrlOriginal(message.content.url) + \') !important\') }"></span><span class="cc-x4hk6" v-else-if="message?.content?.type === \'image/jpeg\' || message?.content?.type === \'image/jpg\' || message?.content?.type === \'image/webp\' || message?.content?.type === \'image/png\'" :style="{ backgroundImage: (\'url(\' + $render.imageUrlResize(message.content.url, 180, 180) + \') !important\') }"></span><span class="cc-shexu cc-1plpv" v-else>ð¦ {{ message?.content?.name }}</span></span><span class="cc-shexu cc-1plpv" v-else-if="message?.type === \'audio\'">ð§</span></span></span><span class="cc-7iqkz"></span></span></span></span><span class="cc-za3im" v-if="!$store.helpdesk.settings_only"><span class="cc-unrzf cc-1o31k"><span class="cc-1oz0d cc-qdda2"></span><span class="cc-1uv4w cc-vqf16 cc-bxbnb" data-for-id="new_messages">{{ $render._e("chat", "minimized_tooltip_message_compose") }}</span></span></span></span></span><span class="cc-1qbp0 cc-1o31k" :data-has-unread="$store.minimized.pane?.unread?.visible"><span class="cc-otlyh" :data-is-ongoing="$store.minimized.pane?.is_ongoing" data-prefer-search="false" data-id="chat_opened"><span class="cc-xrw89" v-if="$store.partial.bundle.pending.chat"><span class="cc-16p6v cc-975hf"></span></span><span class="cc-11f3x" v-else><span class="cc-fajze cc-1egul" v-if="$store.website?.chat?.website_logo"><span class="cc-1p2bq cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(120, \'website\', $store.base.website?.id) + \') !important\') }"></span></span><span class="cc-fajze cc-1egul" v-else-if="$store.chat.ongoing_operator?.url"><span class="cc-1p2bq cc-1e566" :style="{ backgroundImage: (\'url(\' + $store.chat.ongoing_operator?.url + \') !important\') }"></span></span><span class="cc-fajze cc-1egul" v-else-if="$store.website?.chat?.last_operator_face &amp;&amp; $store.website?.website?.active_operators?.length &gt; 0"><span class="cc-1p2bq cc-1e566" :style="{ backgroundImage: (\'url(\' + $render._a(120, \'operator\', $store.website?.website?.active_operators[0]?.user_id, $store.website?.website?.active_operators[0]?.avatar) + \') !important\') }"></span></span></span><span class="cc-1v4wj"></span><span class="cc-lysdp cc-vqf16" v-if="$store.minimized.pane?.unread?.visible">{{ $store.minimized.pane?.unread?.count }}</span></span></span></div><span class="cc-lpuhc" :data-visible="$store.chat.is_opened || $store.minimized.tooltips?.new_messages?.visible" :data-animate-minimize="$store.chat.animate_minimize" :data-animate-maximize="$store.chat.animate_maximize"><span class="cc-uh1kj"></span></span></div>'),this.client.Base._containerEl.innerHTML="",this.client.Base._containerEl.appendChild(this.No),Mr.vue(this.No),this.client.Chat.Viewport.bindAll(),Xo.chat.is_maximized=!1,Xo.chat.is_opened=!1,Xo.state.triggerDefaultAll(["intent"])}requestDynamicSizingProperties(t=!1){!0!==this.Lo&&(this.Lo=!0,uu.nextRender(()=>{"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame(()=>{this.Ko(t),this.Lo=!1}):(this.Ko(t),this.Lo=!1)}))}refreshResizePageScroll(t=!1){if(window.scroll&&!0===Xo.chat.is_opened&&this.Yo>-1)if(!0!==t&&Xo.base.is_mobile_view)window.scrollTo(0,-1);else{let t=document.querySelector("html");t&&t.classList.remove("cc-1ge4k"),this.Zo&&(uu.removeEventListener("document","touchstart",this.Zo),this.Zo=null),this.Xo&&(uu.removeEventListener("document","touchmove",this.Xo),this.Xo=null),window.scroll(window.scrollX,this.Yo),this.Yo=-1}}Go(){let t={status:{url:Xo.chat.generateChannelLink("status")}};uu.merge(Xo.chat,t)}Ko(t=!1){if(!0===this.client.Action.is_chat_visible()){let e,i=Xo.base.is_full_view,s=Ps.getCustomization("position","chatbox");if(Xo.base.applySizing(),!0===Xo.base.is_large_view?(this.Qo=730,this.tu=400,e=600):!0===Xo.base.is_small_view?(this.Qo=490,this.tu=320,e=440):(this.Qo=610,this.tu=360,e=500),this.No&&"helpdesk"===Xo.chat.mode&&Xo.helpdesk.viewer.url){let t=this.No.querySelector(".cc-rsqmy"),i=window.innerHeight-t.getBoundingClientRect().bottom;this.tu=e,this.Qo=window.innerHeight-i-22}if(!0===Xo.base.is_full_view&&(this.Qo=window.innerHeight,this.tu=window.innerWidth,window.visualViewport&&(this.Qo=window.visualViewport.height+window.visualViewport.offsetTop)),!1===Xo.base.is_full_view&&(null==s?void 0:s.default_button_vertical)&&(this.Qo-=s.default_button_vertical),!0===this.client.Chat._isInitialized||!0===t){let t=this.No.querySelector(".cc-rsqmy");if(i&&!1===Xo.base.is_full_view){let e=t.style.getPropertyValue("transition");t.style.setProperty("transition","none","important"),requestAnimationFrame(()=>{t.style.setProperty("transition",e,"important")})}t.style.setProperty("width",`${this.tu}px`,"important"),t.style.setProperty("height",`${this.Qo}px`,"important"),Xo.base.is_full_view&&!0===this.client.Action.is_chat_visible()?this.client.Chat.Viewport.adapt():this.client.Chat.Viewport.unadapt()}yo.allow(!Xo.base.is_mobile_view)}}Ho(t=!1){if(Xo.base.is_mobile_view&&window.scroll)if(!0===t){if(-1===this.Yo){this.Yo=window.scrollY;let t=document.querySelector("html");t&&t.classList.add("cc-1ge4k"),window.scroll(window.scrollX,0);let e=0;this.Zo&&(uu.removeEventListener("document","touchstart",this.Zo),this.Zo=null),this.Zo=uu.addEventListener("document","touchstart",t=>{var i;(null==(i=t.changedTouches)?void 0:i[0])&&(e=t.changedTouches[0].pageY)}),this.Xo&&(uu.removeEventListener("document","touchmove",this.Xo),this.Xo=null),this.Xo=uu.addEventListener("document","touchmove",t=>{var i;if(document.activeElement&&(null==(i=t.changedTouches)?void 0:i[0])){"input"!==document.activeElement.tagName&&"textarea"!==document.activeElement.tagName||t.preventDefault();let i=t.changedTouches[0].pageY||0;Math.abs(i-e)>10&&document.activeElement.blur()}},{passive:!1,capture:!0})}}else this.refreshResizePageScroll(!0);else this.refreshResizePageScroll(!0)}Vo(){Xo.chat.has_window_focus=(!window.hasFocus||window.hasFocus())&&!0,uu.addEventListener("window","focus",()=>{Xo.chat.has_window_focus=!0,this.applyChatFocus()},{capture:!1}),uu.addEventListener("window","blur",()=>{Xo.chat.has_window_focus=!1,this.applyChatFocus()},{capture:!1})}In(){this.Jo=null,this.Wo=null,this.Yo=-1,this.Zo=null,this.Xo=null}}const Su=/;/g;class zu extends Ge{constructor(t){super(),this.client=t,this.In()}init(){}reset(){this.In()}bindAll(){this._viewportEl=document.querySelector('head meta[name="viewport"]')}adapt(){if(!0===Xo.base.is_full_view){if(!1===this.eu){null===this.iu&&(this.iu=this.Cn());let t=uu.clone(this.iu);t.width="device-width",t["initial-scale"]="1",t["maximum-scale"]="1",t["user-scalable"]="0";let e=this.su(t);null!==this._viewportEl?this._viewportEl.setAttribute("content",e):(this._viewportEl=document.createElement("meta"),this._viewportEl.setAttribute("name","viewport"),this._viewportEl.setAttribute("content",e),document.querySelector("head").appendChild(this._viewportEl))}this.eu=!0}else this.eu=!1}unadapt(){if(!0===this.eu){if(null!==this._viewportEl&&this._viewportEl.length>0){let t=this.su(this.iu);t?this._viewportEl.setAttribute("content",t):(this._viewportEl.remove(),this._viewportEl=null)}this.eu=!1}}Cn(){let t={};if(null!==this._viewportEl){let e=this._viewportEl.getAttribute("content").trim().replace(Su,",");if(e){let i;i=!0===e.includes(",")?e.split(","):[e];for(let e=0;e<i.length;e++){let s=i[e];if(!0===s.includes("=")){let e=s.split("="),i=e[0].trim(),n=e[1].trim();i&&n&&(t[i]=n)}}}}return t}su(t){let e="",i=[];for(let s in t)t.hasOwnProperty(s)&&i.push([s,t[s]].join("="));return e=i.join(", "),e}In(){this._viewportEl=null,this.eu=!1,this.iu=null}}class Iu extends Ge{constructor(t){super(),this.client=t,this.Interface=new xu(this.client),this.Viewport=new zu(this.client),this.In()}init(t=null,e=null){!0!==this._isInitialized?(null!==e&&this.nu.push(e),!0!==this.ru&&(this.ru=!0,null!==t&&Xo.state.restore(t),this.client.Partial.spawnFeatureBundle("chat",()=>Xr(()=>import("./features/chat_default_e0e2da7.js").then(t=>t.m),__vite__mapDeps([0,4])),e=>{this.ou(t,!0),e.default(".cc-rsqmy")},e=>{We.error(e),this.ou(t,!1)}))):"function"==typeof e&&e()}reset(){this.In()}startMinimized(t=null){this.uu(!1,t)}startMaximized(t=null){this.uu(!0,t)}ou(t=null,e=!0){if(this.ru=!1,!0===e)for(this.au(),this.client.Chat.Interface.pane(),this.client.Base.updateSocketCookieKey(!1),this.lu(t),this._isInitialized=!0;this.nu.length>0;)this.nu.shift()();else this.nu=[]}uu(t=!1,e=null){let i=()=>{"function"==typeof e&&e()};!0!==this._isInitialized?this.init({maximized:t},()=>{Xo.state.propagate("maximized",t,!0),i()}):i()}au(){let t,e=[this.client.Chat.Viewport,this.client.Chat.Interface];for(t=0;t<e.length;t++)e[t].init()}lu(t=null){null===t&&this.client.Action.event("chat:initiated"),Xo.availability.apply(),zr.Socket.getState(),yo.initialize("events"),Xo.messages.restore()}In(){this._isInitialized=!1,this.ru=!1,this.nu=[]}}class ju extends Ge{constructor(t){super(),this.client=t}init(t=!0,e=!1,i=!1,s=!0){!0!==i&&zr.Message.getMessageHistory(),this.lu(e,i,t,s)}reset(){}lu(t=!1,e=!1,i=!1,s=!0){!0!==e?Xo.minimized.paneAuthorized(t,i,s):Xo.minimized.paneUnauthorized(t,s),!0===Xo.base.runtime.lock_maximized&&Xo.minimized._paneOpenHandler(t=>{this.client.Chat.init(t)})}}const Ru=/\{\s*\[native code\]\s*\}$/;const Ou=new class extends Ge{constructor(){super(),this.In()}reset(){this.In()}scheduleWarnIncompatible(t=!1){null!==this.hu&&clearTimeout(this.hu),this.hu=setTimeout(()=>{this.hu=null,!0!==Cu._safeMode&&(this.cu(),this.du())},!0===t?0:2e4)}cu(){(document.characterSet||document.charset||"").toUpperCase()}du(){let t=window;if((null==t?void 0:t.console)&&"function"==typeof t.console.warn&&"function"==typeof Function.prototype.toString){let e,i,s,n,r=[[null,t,["eval","escape","unescape","decodeURI","encodeURI","decodeURIComponent","encodeURIComponent","setTimeout","clearTimeout","setInterval","clearInterval","parseInt","parseFloat","RTCPeerConnection","MutationObserver","XMLHttpRequest","AudioContext","WebSocket","Proxy","Text","Comment"]],[null,t,["Array","Object","String","Number","Date","Function","RegExp","Symbol","Set","Map","WeakMap","Event","Error"]],["Array",t.Array,["from","isArray"]],["Array.prototype",t.Array.prototype,["push","pop","indexOf","includes","sort","splice","slice","shift","unshift","map","filter","find","findIndex","forEach"]],["Object",t.Object,["assign","create","keys","values","is","isExtensible","defineProperty","defineProperties","getOwnPropertyNames","getOwnPropertyDescriptors"]],["Object.prototype",t.Object.prototype,["hasOwnProperty","propertyIsEnumerable","toString"]],["String",t.String,["fromCharCode"]],["String.prototype",t.String.prototype,["indexOf","charAt","charCodeAt","trim","toLowerCase","toUpperCase","slice","replace","match"]],["Math",t.Math,["random","round","floor","ceil","abs"]],["Date",t.Date,["now"]],["Date.prototype",t.Date.prototype,["getTime","toISOString"]],["Function.prototype",t.Function.prototype,["bind","apply","call"]],["RegExp.prototype",t.RegExp.prototype,["test","exec"]],["Event.prototype",t.Event.prototype,["preventDefault","stopPropagation"]],["Reflect",t.Reflect,["get","set","has","ownKeys","deleteProperty"]],["document",t.document,["querySelector","querySelectorAll","createElement","createEvent","addEventListener","removeEventListener"]],["JSON",t.JSON,["stringify","parse"]],["localStorage",t.localStorage,["setItem","getItem","removeItem"]],["sessionStorage",t.sessionStorage,["setItem","getItem","removeItem"]]],o=[];for(let t=0;t<r.length;t++)if(e=r[t],s=e[1],void 0===s)o.push(e[0]||"[root]");else{i=e[2]||[];for(let t=0;t<i.length;t++)n=s[i[t]],void 0===n||Ru.test(String(n))||(null!==e[0]?o.push(`${e[0]}.${i[t]}`):o.push(i[t]))}}}In(){this.hu=null}};const Mu={socket:!0,buster:1},qu={childList:!0,attributes:!1,subtree:!1,characterData:!1};class Uu{constructor(t){this.client=t,this._dollarCrisp=null,this.Du(),this.In()}init(t={}){!1===this._isInitialized&&(this._isInitialized=!0,this._dollarCrisp=t.dollarCrisp||null,Xo.base.cookie_expire=t.cookieExpire||null,Xo.base.cookie_domain=t.cookieDomain||null,Xo.base.website.domain=t.websiteDomain||null,Xo.base.website.id=t.websiteId||null,Xo.base.token_id=t.tokenId||null,Xo.base.page_url=t.pageUrl||null,Xo.base.page_domain=t.pageDomain||null,Xo.base.browser_locales=t.browserLocales||[],Xo.base.browser_useragent=t.browserUseragent||null,Xo.base.browser_timezone=t.browserTimezone||null,Xo.base.browser_capabilities=t.browserCapabilities||[],Xo.base.runtime=t.runtimeConfiguration||{},this.fu=t.readyTrigger||null,this.pu=t.resetHandler||null,Ou.scheduleWarnIncompatible(!1),this.mu().then(t=>{this._u=t.socket,this.Fu=t.buster||1,this.gu=t.endpoints||{};let e=!document.cookie.includes(this.vu(!0))&&!1!==this._u&&!0;!1===e&&!0===Xo.base.runtime.lock_maximized&&(e=!0),!0===e?this.wu():this.runStatic(),this.client.Event.init()}).catch(t=>{"invalid_website_id"===t&&this.runError()}))}reset(){let t=this.pu;this.In(),this.Du(),this.pu=t,Je.forEach(t=>{try{"function"==typeof t.fn&&t.fn()}catch(e){We.error(e)}})}spawnClient(t=!1){t&&(Xo.base.error_mode=!0,We.error("Spawn client with error mode")),this.bu(),js.init(),!0!==t&&(zr.Config.setIgnorePrivacy(Xo.website.chat.ignore_privacy),zr.Config.setVisitorCompose(Xo.website.chat.visitor_compose)),this.client.Trigger.init(Ps.getTriggers()),this.Go(),this._clientEl=Mr.dom('<div class="crisp-client" :lang="$store.locale.code" :dir="$store.locale.direction" aria-live="polite" translate="no" tabindex="-1"><div class="cc-1lkve"></div><div class="cc-yv368" id="crisp-chatbox" :data-hidden="$store.base.is_hidden" :data-force-show="$store.base.force_show || $store.base.error_mode" :data-color-mode="$store.base.color_mode" :data-availability="$store.availability?.availability" :data-lock-maximized="$store.base.runtime?.lock_maximized ? true : false" :data-website-logo="$store.website?.chat?.website_logo ? true : false" :data-last-operator-face="($store.website?.chat?.last_operator_face &amp;&amp; $store.base.active_operators?.length &gt; 0) ? true : false" :data-ongoing-operator-face="($store.website?.chat?.ongoing_operator?.url) ? true : false" :data-availability-tooltip="$store.website?.chat?.availability_tooltip" :data-hide-vacation="$store.website?.chat?.hide_vacation" :data-blocked="$store.base.is_blocked" :data-mobile-view="$store.base.is_mobile_view" :data-full-view="$store.base.is_full_view" :data-small-view="$store.base.is_small_view" :data-large-view="$store.base.is_large_view" :data-has-local-messages="$store.base.has_local_messages" :data-was-availability-online="$store.availability?.was_availability_online" :data-is-activity-ongoing="$store.base.is_activity_ongoing" :data-hide-on-away="$store.website?.chat?.hide_on_away" :data-hide-on-mobile="$store.website?.chat?.hide_on_mobile" :data-position-reverse="$store.website?.chat?.position_reverse"></div><div class="cc-yv368 cc-vx6i0"></div><div class="cc-yv368 cc-1tx1r"></div><div class="cc-yv368 cc-jcxto" :data-color-mode="$store.base.color_mode"></div></div>'),this._containerEl=this._clientEl.querySelector(".cc-yv368"),this.yu(),this.insertStyle()}runStatic(t=!0){!1!==t&&this.Eu(!1),this.acquireWebsiteSettings({},this.Fu).then(t=>{!0!==t&&(Xo.availability.receive(Xo.website.website.online||!1,!1),this.spawnClient(t),this.client.Minimized.init(!1,!1,t),uu.nextRender(()=>{this.triggerSessionLoaded()}))})}runError(){Ls.load("en").then(()=>{this.spawnClient(!0),this.client.Minimized.init(!0,!1,!0)}).catch(t=>{We.error(t)})}triggerSessionLoaded(){if("function"==typeof this.fu)try{this.fu(),this.fu=null}catch{}this.client.Action.unstackPending(),!0===this.client.Chat._isInitialized&&this.client.Chat.Interface.applyChatFocus(),this.client.Action.event("session:loaded",Xo.base.session_id),Ou.scheduleWarnIncompatible(!0)}updateSocketCookieKey(t=!0,e=!1){let i,s=this.vu(t);i=!0===e?new Date(0):new Date((new Date).getTime()+(!0===t?6e5:1728e5)),document.cookie=`${s}; expires=${i.toUTCString()}; path=/; samesite=lax;`}updateConfiguration(t,e=!1){var i;typeof(null==(i=Xo.website.chat)?void 0:i[t])==typeof e&&(Xo.website.chat[t]=e)}insertStyle(){var t,e;let i=this.Cu;_u.applyTheme(i.color.theme||(null==(e=null==(t=Xo.website)?void 0:t.chat)?void 0:e.theme),!!i.color.theme),_u.applyContainerIndex(i.other.container_index),_u.applyPosition(i.position)}acquireWebsiteSettings(t,e=null){let i=!1;return this.client.Partial.loadSettings(`settings/website/${encodeURIComponent(Xo.base.website.id)}/`,e||t.buster).catch(()=>(We.error("Failed to acquire website settings"),Promise.reject(null))).then(e=>(i=!(e&&!e.error),Xo.website.updateWebsite(e,t),Ls.load(Xo.website.chat.locale))).then(()=>Promise.resolve(i)).catch(t=>(We.error(t),Promise.resolve(!0)))}ensureSocket(t=!1){return!0===zr.socket.connected?Promise.resolve():new Promise(e=>{!1!==this._u&&(this.client.Broker._fnInitialize.actions.push(e),null===this.client.Broker._fnInitialize.master&&(this.client.Broker._fnInitialize.master=()=>{!0===t&&this.client.Minimized.init(!0,!1,!1,!1)}),zr.socket.connect())})}configureConsoleSink(){"production"===Pe.ENVIRONMENT&&(zr.Issue.configure({project:Pe.PROJECT_NAME,revision:Pe.REVISION,environment:Pe.ENVIRONMENT,useragent:Xo.base.browser_useragent,page:Xo.base.page_url}),We.setLogSink((t,e,i)=>{var s;if("error"===t){Array.isArray(i)&&(i=i[0]),"object"==typeof(null==(s=this._dollarCrisp)?void 0:s.__spool)&&(this._dollarCrisp.__spool.error_last={ns:e,value:i});let n=(new Date).getTime();n-this.ku>=1e4&&(this.ku=n,zr.Issue.report(t,e,i))}}))}uninsertClient(){"MutationObserver"in window&&(this.$u("html"),this.$u("body")),zr.socket.disconnect(),this.bu()}reTriggerLoader(){"function"==typeof this.pu&&this.pu()}mu(){let t=new Date,e=`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}-${t.getHours()}-${t.getMinutes()}`;return this.client.Partial.loadSettings(`settings/website/${encodeURIComponent(Xo.base.website.id)}/prelude/`,e).then(t=>(Pe.TEST&&window.$mock_prelude&&uu.merge(t,window.$mock_prelude),t.error?Promise.reject(t.error):Promise.resolve(t||Mu))).catch(t=>(We.error("Error loading website prelude:",t),Promise.reject(t)))}yu(){this.Bu(),"MutationObserver"in window&&(this.Au(document.documentElement),this.xu(document.body))}Bu(){let t=document.querySelector("body");t&&t.appendChild(this._clientEl),Mr.vue(this._clientEl)}bu(){null!==this._clientEl&&(this._clientEl.remove(),this._clientEl=null)}wu(){this.Eu(!0)}Eu(t=!1){var e;let i=!0===Pe.SOCKET_AFFINITY,s=this.gu.socket||{},n=(null==(e=this.gu.rescue)?void 0:e.socket)||{},r=(i?s.client:null)||Pe.URL_RELAY_CLIENT,o=(i?s.stream:null)||Pe.URL_RELAY_STREAM,u=i&&n.client||null;this.client.Broker.init(r,o,u,t)}Au(t){this.$u("html"),this.Su.html=new window.MutationObserver(t=>{for(let e=0;e<((null==t?void 0:t.length)||0);e++){let i=t[e];if("childList"===i.type&&i.addedNodes)for(let t=0;t<i.addedNodes.length;t++){let e=i.addedNodes[t];if("body"===(e.tagName||"").toLowerCase()){this.xu(e),this.zu();break}}}}),this.Su.html.observe(t,qu)}xu(t){this.$u("body"),this.Su.body=new window.MutationObserver(t=>{for(let e=0;e<((null==t?void 0:t.length)||0);e++){let i=t[e];if("childList"===i.type&&i.removedNodes)for(let t=0;t<i.removedNodes.length;t++)if(i.removedNodes[t]===this._clientEl){this.zu();break}}}),this.Su.body.observe(t,qu)}$u(t){let e=this.Su[t];void 0!==e&&(e.disconnect(),delete this.Su[t])}zu(){null===this.Iu&&(this.Iu=uu.setTimeout(()=>{this.Iu=null,this.Bu()},1e3))}vu(t=!0){return`${encodeURIComponent("crisp-client/socket/"+Xo.base.website.id)}=${encodeURIComponent(!0===t?"0":"1")}`}Go(){uu.merge(Xo.base,{is_full_view:!1,is_small_view:!1,is_large_view:!1}),Xo.base.is_full_view=Xo.base.checkIsFullView(),Xo.base.is_small_view=Xo.base.checkIsSmallView(),Xo.base.is_large_view=Xo.base.checkIsLargeView()}Du(){this._clientEl=null,this._containerEl=null}In(){this._isInitialized=!1,this.Fu=1,this._u=!0,this.gu={},this.pu=null,this.fu=null,this.ju={},this.ku=0,this.Iu=null,this.Cu={color:{},other:{}},this.Su={}}}class Pu extends Ge{constructor(t){super(),this.client=t,this.In()}init(t,e,i=null,s=!0){zr.init({ticketGenerator:(t,e)=>{this.client.Ticket.acquire(t,e)},environment:Pe.ENVIRONMENT,urlRelayClient:t,urlRelayStream:e,urlRelayRescueClient:i,websiteDomain:Xo.base.website.domain,websiteId:Xo.base.website.id,tokenId:Xo.base.token_id,cookieExpire:Xo.base.cookie_expire,cookieDomain:Xo.base.cookie_domain,useragent:Xo.base.browser_useragent,timezone:Xo.base.browser_timezone,capabilities:Xo.base.browser_capabilities,locales:Xo.base.browser_locales,runtimeConfiguration:Xo.base.runtime,connectSocket:s,platformName:Pe.PLATFORM_NAME,platformSignatureKey:Pe.PLATFORM_SIGNATURE_KEY}),Xo.messages.registerUnreadHandler(),this.Ru=zr.event,this.Ou=s,this.client.Base.configureConsoleSink(),this.Mu(),this.qu(),this.Uu(),this.Pu(),this.Tu(),this.Lu(),this.Nu(),this.Vu(),this.Hu(),this.Wu(),this.Ju(),this.Gu(),this.Ku(),this.Yu(),this.Zu(),this.Xu(),this.Qu(),this.ta(),this.ea(),this.ia(),this.sa(),this.na(),this.ra(),this.oa(),this.ua(),this.aa(),this.la(),this.ha(),this.ca(),this.da(),this.Da(),this.fa(),this.pa(),this.ma(),this.Fa(),this.ga(),this.va(),this.wa(),this.ba(),this.ya(),this.Ea(),this.Ca(),this.ka(),this.$a(),this.Ba(),this.Aa(),this.xa(),this.Sa(),this.za(),this.Ia(),this.ja(),this.Ra(),this.Oa(),this.Ma(),this.qa(),this.Ua(),this.Pa(),this.Ta(),this.La(),this.Na()}reset(){this.In()}Mu(){this.Ru.on("socket:state",t=>{t.connected===this._socketConnected&&t.failed_reconnect===this.Va||(this._socketConnected=t.connected||!1,this.Va=t.failed_reconnect||!1,this.client.Chat.Interface.toggleSocketState(this._socketConnected,this.Va),Xo.minimized.pane.is_offline=!0!==this._socketConnected,!0===this._socketConnected&&this.client.Event.checkActivityAutokill())})}qu(){this.Ru.on("socket:rescued",()=>{!1===this.Ou?zr.socket.connect():null===this.client.Base._containerEl&&(this.client.Base.updateSocketCookieKey(!0),this.client.Base.runStatic(!1))})}Uu(){this.Ru.on("session:created",t=>{t.error?"invalid_website_id"===t.error&&this.client.Base.runError():t.session_id?this.Ha=!0:We.error("Unrecognized session creation error")})}Pu(){this.Ru.on("session:joined",t=>{t.error?"invalid_session"===t.error&&++this.Wa<=1&&zr.Session.reset(()=>{zr.Session.create()},()=>{}):(Xo.base.session_id=t.session_id||null,Xo.base.session_hash=t.session_hash||null,!1===t.socket&&!0!==t.initiated&&this.client.Base.updateSocketCookieKey(!0),!0===this.Ja?(this.Ja=!1,this.client.Base.acquireWebsiteSettings(t).then(t=>{!0!==t&&(this.client.Base.spawnClient(t),zr.Website.getUsersAvailable())})):Xo.messages.synchronize())})}Tu(){this.Ru.on("session:state",t=>{if(1===this.Ga&&(this.Ga++,this.Ka=!0),!1===this.client.Chat._isInitialized){let e=()=>{uu.nextRender(()=>{this.client.Base.triggerSessionLoaded()})};if(null!==this._fnInitialize.master){this._fnInitialize.master(uu.isEmpty(t)?null:t);for(let t=0;t<this._fnInitialize.actions.length;t++)this._fnInitialize.actions[t]();this._fnInitialize.master=null,this._fnInitialize.actions=[],e()}else uu.isEmpty(t)?(this.client.Minimized.init(!0,this.Ha),zr.Session.getRequestInitiate(),e()):this.client.Chat.init(t,e)}Xo.state.receive(t),this.Ya()})}Lu(){this.Ru.on("session:error",t=>{if("email:invalid_format"===t.type)Xo.chatAlert.update("email_invalid","show")})}Nu(){this.Ru.on("session:request:initiate",()=>{})}Vu(){this.Ru.on("session:request:purge",()=>{this.client.Action.do_session_reset()})}Hu(){this.Ru.on("session:request:feedback",()=>{Xo.chatFeedback.request()})}Wu(){this.Ru.on("session:feedback:rate",()=>{})}Ju(){this.Ru.on("session:feedback:rated",()=>{})}Gu(){this.Ru.on("website:users:available",t=>{Pe.TEST&&window.$mock_users_available&&(t=window.$mock_users_available),Xo.availability.receive(t.available,t.changed),0===this.Ga?(this.Ga++,zr.Session.getState()):Xo.availability.apply()})}Ku(){this.Ru.on("message:received",t=>{this.Za(t)})}Yu(){this.Ru.on("message:received:local",t=>{this.Za(t)})}Zu(){this.Ru.on("message:send",t=>{Xo.messages.sent(t)})}Xu(){this.Ru.on("message:sent",t=>{Xo.messages.sentAcknowledgement(t),this.client.Action.event("message:sent",t)})}Qu(){this.Ru.on("message:removed",t=>{Xo.messages.removed(t)})}ea(){this.Ru.on("message:compose:send",t=>{this.client.Action.event("message:compose:sent",t)})}ia(){this.Ru.on("message:acknowledge:pending",()=>{})}sa(){this.Ru.on("message:acknowledge:read:send",t=>{Xo.messages.acknowledgeReadSend(t)})}na(){this.Ru.on("message:acknowledge:read:received",()=>{})}ra(){this.Ru.on("message:error:rejected",t=>{Xo.messages.errorRejected(t.fingerprint,t.reason)})}oa(){this.Ru.on("message:thread",()=>{})}ta(){this.Ru.on("message:compose:received",t=>{var e,i;if(!0!==(null==(i=null==(e=Xo.website)?void 0:e.chat)?void 0:i.operator_privacy))switch(t.type){case"start":Xo.messages.showCompose(t.timestamp,t.automated);break;case"stop":Xo.messages.hideCompose()}this.client.Action.event("message:compose:received",t)})}ua(){this.Ru.on("history:messages",t=>{Xo.messages.history(t)})}aa(){this.Ru.on("overlay:answer:search",t=>{this._responseSpool.overlay_answer_search=t.id})}la(){this.Ru.on("overlay:answer:search:partial",t=>{this._responseSpool.overlay_answer_search===t.id&&Xo.overlay.handleSearchChunk(t.partial.chunk)})}ha(){this.Ru.on("overlay:answer:search:processed",t=>{this._responseSpool.overlay_answer_search===t.id&&Xo.overlay.handleSearchAnswer(t.result.text,t.search.query)})}ca(){this.Ru.on("overlay:answer:search:sources",t=>{this._responseSpool.overlay_answer_search===t.id&&Xo.overlay.handleSearchSources(t.result.sources)})}da(){this.Ru.on("overlay:category:suggest",t=>{this._responseSpool.overlay_category_suggest=t.id})}Da(){this.Ru.on("overlay:category:suggest:sources",t=>{this._responseSpool.overlay_category_suggest===t.id&&Xo.overlay.handleSearchSources(t.result.sources,!0)})}fa(){this.Ru.on("call:request:initiate",t=>{zr.Call.init({ice:Pe.RTC_ICE,call_id:t.call_id,mode:t.mode,has_support:t.has_support},()=>{Xo.call.ring(t)},()=>{})})}pa(){this.Ru.on("call:action:stopped",()=>{Xo.call.stop()})}ma(){this.Ru.on("call:peer:local:error",()=>{Xo.call.error()})}Fa(){this.Ru.on("call:peer:remote:error",()=>{Xo.call.error()})}ga(){this.Ru.on("call:media:local:success",()=>{Xo.call.success("media_local")})}va(){this.Ru.on("call:media:local:error",()=>{Xo.call.error()})}wa(){this.Ru.on("call:media:remote:success",()=>{Xo.call.success("media_remote")})}ba(){this.Ru.on("call:track:local:started",t=>{Xo.call.toggleMediaStatus(t.media,!0)})}ya(){this.Ru.on("call:track:local:ended",t=>{Xo.call.toggleMediaStatus(t.media,!1)})}Ea(){this.Ru.on("browsing:request:initiate",t=>{this.Xa.push(()=>{Xo.browsing.prepare(t)}),this.Ya()})}Ca(){this.Ru.on("browsing:assist:started",()=>{Xo.browsing.startAssist()})}ka(){this.Ru.on("browsing:assist:stopped",()=>{Xo.browsing.stopAssist()})}$a(){this.Ru.on("browsing:assist:mouse",t=>{Xo.browsing.pipeMouse(t)})}Ba(){this.Ru.on("browsing:assist:scroll",t=>{Xo.browsing.pipeScroll(t)})}Aa(){this.Ru.on("browsing:assist:click",t=>{Xo.browsing.pipeClick(t)})}xa(){this.Ru.on("bucket:url:upload:generate",t=>{this._responseSpool.bucket_url_upload_generate=t.id})}Sa(){this.Ru.on("bucket:url:upload:generated",t=>{var e,i,s;if(this._responseSpool.bucket_url_upload_generate===t.id){if("preparing"===(Xo.chatFile.state||null)){let n=(null==(e=t.url)?void 0:e.signed)||"",r=(null==(i=t.url)?void 0:i.resource)||"",o=(null==(s=t.policy)?void 0:s.size_limit)||0;Xo.chatFile.uploadGenerated(n,r,o)}}})}za(){this.Ru.on("media:animation:list",t=>{this._responseSpool.media_animation_list=t.id})}Ia(){this.Ru.on("media:animation:listed",t=>{this._responseSpool.media_animation_list===t.id&&(Xo.chatPicker.gif.results=t.results)})}ja(){this.Ru.on("helpdesk:article:search",t=>{this._responseSpool.helpdesk_article_search=t.id})}Ra(){this.Ru.on("helpdesk:article:searched",t=>{if(this._responseSpool.helpdesk_article_search===t.id){let e=!!t.search.query;Xo.helpdesk.handleArticles(t.results,t.search,e);let i=Xo.chat.generateChannelLink("helpdesk");if(i){let e,s=[];for(let n=0;n<t.results.length;n++)e=t.results[n],s.push({title:e.title,url:`${i}${e.locale}/article/${e.slug}/`});this.client.Action.event("helpdesk:queried",{query:t.search.query,results:s})}}})}Oa(){this.Ru.on("helpdesk:article:suggest",t=>{this._responseSpool.helpdesk_article_suggest=t.id})}Ma(){this.Ru.on("helpdesk:article:suggested",t=>{this._responseSpool.helpdesk_article_suggest===t.id&&Xo.helpdesk.handleAutocomplete(t.results)})}qa(){this.Ru.on("helpdesk:article:report",()=>{})}Ua(){this.Ru.on("storage:sync:update",()=>{})}Pa(){this.Ru.on("storage:sync:updated",()=>{})}Ta(){this.Ru.on("trigger:fired",()=>{})}La(){this.Ru.on("issue:report",()=>{})}Na(){this.Ru.on("window:history",t=>{Xo.base.page_url=t.page_url,Xo.base.page_domain=t.page_domain,null!==this.client.Base._containerEl&&!1===Xo.base.is_blocked&&this.client.Chat.Interface.requestDynamicSizingProperties(),this.client.Trigger.reprocessEventsPage()})}Za(t){this.client.Chat.startMinimized(()=>{let e="network"===t.origin&&!0;Xo.messages.received(t,e,e,!0,!1),this.client.Action.event("message:received",t)})}Ya(){if(!0===this.Ka)for(;this.Xa.length>0;)this.Xa.shift()()}In(){this._socketConnected=!1,this._responseSpool={},this._fnInitialize={master:null,actions:[]},this.Ru=null,this.Ha=!1,this.Ja=!0,this.Ou=!1,this.Va=!1,this.Ga=0,this.Ka=!1,this.Xa=[],this.Wa=0}}class Tu extends Ge{constructor(t){super(),this.client=t}loadSettings(t,e=null,i={}){let s=`${Pe.URL_CLIENT}/${t}`,n="?";e&&(s+=`${n}${encodeURIComponent(e)}`,n="&");for(let r in i)null!==i[r]&&(s+=`${n}${r}=${encodeURIComponent(i[r])}`,n="&");return fetch(s).then(t=>t.json()).then(t=>Promise.resolve(t)).catch(t=>(We.error("Failed to load settings on",s),Promise.reject(t)))}spawnWorker(t,e,i,s,n=!1){try{if(window.Worker&&window.URL){let r=[`${Pe.URL_CLIENT}/static/javascripts/workers/`,`${t}_${Pe.REVISION}.js`].join(""),o=new window.XMLHttpRequest;o.open("GET",r,!0),o.responseType="blob",o.onload=()=>{try{let t=window.URL.createObjectURL(o.response),r=new window.Worker(t);r.addEventListener("message",e=>{try{i(e.data),!0===n&&(r.terminate(),window.URL.revokeObjectURL(t))}catch(s){We.error(s)}}),r.addEventListener("error",t=>{try{let e=t.message||"Cannot spawn";s(e)}catch(e){We.error(e)}}),e(r,t)}catch(t){We.error(t),s(t)}},o.onerror=()=>{s(new Error("Could not load worker runtime"))},o.send()}else s(new Error("Workers are not supported"))}catch(r){We.error(r),s(r)}}spawnFeatureBundle(t,e,i,s){try{Xo.partial.bundle.pending[t]=!0,e().then(e=>{i(e),Xo.partial.bundle.pending[t]=!1}).catch(t=>{We.error(t),s(t)})}catch(n){Xo.partial.bundle.pending[t]=!1,We.error(n)}}}const Lu="ticket",Nu=["token","expire","session"];class Vu extends Ge{constructor(t){super(),this.client=t,this.In()}reset(){this.In()}acquire(t,e){let i=()=>{this.Qa.token?e({token:this.Qa.token}):e(null)};!0!==this.tl&&(this.tl=!0,this.il());let s=new Date;!0===(this.Qa.refreshAfter||0)-s.getTime()<=0?this.sl(t,s,i):i()}sl(t,e,i){this.nl.push(i),1===this.nl.length&&this.rl(t,e,()=>{for(;this.nl.length>0;)this.nl.shift()()})}rl(t,e,i){let s=`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`,n=`settings/session/${encodeURIComponent(t)}`;this.client.Partial.loadSettings(`${n}/challenge/`,s).then(t=>{this.ol(t.mint||{},s=>{var r;let o={mint_signature:(null==(r=t.mint)?void 0:r.signature)||null,mint_proof:(null==s?void 0:s.token)||null,mint_cost:(null==s?void 0:s.duration)||null};this.client.Partial.loadSettings(`${n}/ticket/`,null,o).then(t=>{t.token&&this.ul(t,e),i()}).catch(()=>{i()})})}).catch(()=>{i()})}ol(t,e){try{if(1!==t.version)throw new Error(`Mint version unsupported: V${t.version||0}`);this.al(t.vector,e)}catch(i){We.error(i),e(null,i)}}al(t,e){try{this.client.Partial.spawnWorker("ticket",e=>{e.postMessage({action:"mint",data:t})},t=>{e(t)},i=>{setTimeout(()=>{this.ll(t,e)},0)},!0)}catch(i){We.error(i)}}ll(t,e){try{Xr(()=>import("./features/chat_default_e0e2da7.js").then(t=>t.a),__vite__mapDeps([0,4])).then(i=>{let s=i.default.mint(t,zr.sha256);e(s)})}catch(i){We.error(i),e(null,i)}}il(){let t={};for(let e=0;e<Nu.length;e++){let i=Nu[e];t[i]=zr.Storage.getStampLocal(Lu,this.hl(i))}t.token&&t.expire&&t.session&&t.session===Xo.base.session_id&&(this.Qa.token=t.token,this.Qa.refreshAfter=parseInt(t.expire,10))}ul(t,e){this.Qa.token=t.token,this.Qa.refreshAfter=e.getTime()+Math.floor(.75*t.duration);let i={token:this.Qa.token,expire:`${this.Qa.refreshAfter}`,session:Xo.base.session_id};for(let s in i)zr.Storage.setStampLocal(Lu,this.hl(s),i[s])}hl(t){return[Xo.base.website.id,t]}In(){this.Qa={},this.nl=[],this.tl=!1}}function Hu(t,e,...i){return t.bind&&/\[native code\]/.test(t.bind.toString())?t.bind(e,...i):function(...s){return t.apply(e,[...i,...s])}}const Wu=["page","url_parameter"],Ju="trigger";class Gu extends Ge{constructor(t){super(),this.client=t,this.cl={delay:this.dl,leave:this.Dl,link:this.fl,page:this.pl,url_parameter:this.ml,user_data:this._l,user_event:this.Fl},this.gl={message:this.vl,open:this.wl,sound:this.bl},this.yl={page:this.El,url_parameter:this.Cl},this.In()}init(t){this.kl=t,this.$l()}reset(){this.In()}run(t){var e;let i=null==(e=this.kl)?void 0:e[t];return!0===(null==i?void 0:i.enabled)&&(this.Bl(t,i),!0)}doEvent(t,e){let i=this.Al[t]||[];for(let s=0;s<i.length;s++)i[s](e)}markProcessed(t){this._processed.includes(t)||this._processed.push(t),zr.Storage.setStampLocal(Ju,[Xo.base.website.id,"status",t],"1")}reprocessEventsPage(){let t,e,i;for(let s in this.kl)if(t=this.kl[s],!0===t.enabled&&(e=t.events,e))for(let n in e)"page"===n&&(i=e[n],!0===i.enabled&&this.pl(s,t,e))}$l(){let t,e,i,s,n=!1;for(let r in this.kl)if(t=this.kl[r],!0===t.enabled&&(e=t.events,e))for(let o in e)i=e[o],!0===i.enabled&&(s=this.cl[o],"function"==typeof s?(Hu(s,this)(r,t,e,i.settings||{}),n=!0):We.error(`Did not attach ${o} event listener for trigger: ${r} because: no such event listener`));!0===n&&this.xl()}Bl(t,e){if(!0===this.Sl(e)&&!1===this.zl(t)){let i=uu.clone(this._processed);i.push(t),this.Il(()=>{Xo.state.propagate("trigger",i,!1,i=>{if(!0===i&&!0===this.Sl(e)&&e.actions){let i,s;for(let n in e.actions)i=e.actions[n],!0===i.enabled&&(s=this.gl[n],"function"==typeof s?(Hu(s,this)(t,e,i.settings||{}),zr.Trigger.fired(t,e.name)):We.error(`Did not execute ${n} action for trigger: ${t} because: no such action processor`))}})})}}Il(t){this.client.Base.ensureSocket().then(()=>{!0!==this.jl?(this.jl=!0,this.client.Chat.startMinimized(t)):t()})}Sl(t){var e;let i=!1;if(i=!1===Xo.base.is_invisible,!0===this.Rl(t,"if_website_online")&&(i=!0===this.client.Action.is_website_available()&&i),!0===this.Rl(t,"if_first_visit")){i="1"===zr.Storage.getStampLocal(Ju,this.Ol("count"))&&i}if(!0===this.Rl(t,"if_trigger_sole")&&(i=!0!==Xo.messages.has_messages&&i),!0===this.Rl(t,"if_countries")){let s=!1,n=null==(e=t.behaviors.if_countries)?void 0:e.settings,r=Xo.website.chat.country;if(n)for(let t in n)t===r&&(s=!0);i=!0===s&&i}return!1===Xo.base.is_mobile_view&&!1===this.Ml(t,"desktop")&&(i=!1),Xo.base.is_mobile_view&&!1===this.Ml(t,"mobile")&&(i=!1),i}ql(t=!1,e={}){let i=100;return!0===t&&e.after&&e.after>0&&(i=1e3*e.after),i}dl(t,e,i,s){if(s.after&&s.after>0){let n=!1;for(let t in i)if("delay"!==t&&!0===i[t].enabled){n=!0;break}!1===n&&this.Ul(t,e,{enabled:!0,settings:s})}}Dl(t,e,i){var s;let n=!0;for(let r=0;r<Wu.length;r++){let t=Wu[r];if(!0===(null==(s=i[t])?void 0:s.enabled)&&(n=Hu(this.yl[t],this)(i),!1===n))break}!0===n&&(this.Pl&&uu.removeEventListener("window","mouseout",this.Pl),this.Pl=uu.addEventListener("window","mouseout",s=>{!0===this.Tl&&!s.relatedTarget&&!s.toElement&&s.clientY<=this.Ll&&(this.Tl=!1,null===this.Nl&&(this.Nl=this.Ul(t,e,i.delay)))}),uu.removeEventListener("window","mouseover",this.Vl),this.Vl=uu.addEventListener("window","mouseover",()=>{!0!==this.Tl&&(this.Tl=!0,null!==this.Nl&&(uu.clearTimeout(this.Nl),this.Nl=null))}))}fl(t,e,i,s){var n;(null==(n=s.ids)?void 0:n.length)>0&&(this.Hl&&uu.removeEventListener("document","click",this.Hl),this.Hl=uu.addEventListener("document","click",n=>{try{if((null==n?void 0:n.target)&&"a"===(n.target.nodeName||"").toLowerCase())for(let r=0;r<s.ids.length;r++){let o=document.getElementById(s.ids[r]),u="function"==typeof document.querySelectorAll?document.querySelectorAll(s.ids[r]):null,a=!1;if((null==u?void 0:u.length)>0)for(let t=0;t<u.length;t++)if(u[t]===n.target){a=!0;break}if(o===n.target||!0===a){this.Ul(t,e,i.delay);break}}}catch(r){We.error(r)}}))}pl(t,e,i){var s;if(!0!==(null==(s=i.leave)?void 0:s.enabled)){!0===this.El(i)&&this.Ul(t,e,i.delay)}}ml(t,e,i){var s;if(!0!==(null==(s=i.leave)?void 0:s.enabled)){!0===this.Cl(i)&&this.Ul(t,e,i.delay)}}_l(t,e,i,s){s.points&&uu.keys(s.points).length>0&&this.Wl("user_data",n=>{let r=`${n.value}`;if(n.key&&r){`${s.points[n.key]}`===r&&this.Ul(t,e,i.delay)}})}Fl(t,e,i,s){var n;(null==(n=s.texts)?void 0:n.length)>0&&this.Wl("user_event",n=>{s.texts.includes(n.text)&&this.Ul(t,e,i.delay)})}vl(t,e,i){if(i){let s=(i[Xo.locale.code]||i.default||"").trim();if(s){let i=uu.toHashCode(`trigger/${t}`),n=!1;!0===this.Rl(e,"show_as_website")&&(n=!0),this.client.Action.do_message_show("text",s,i,n)}}}wl(t,e){this.client.Action.do_chat_open()}bl(t,e){yo.start("events","chat-message-receive")}El(t){var e,i;let s=!1,n=null==(e=t.page)?void 0:e.settings;return(null==(i=null==n?void 0:n.urls)?void 0:i.length)>0&&(s=uu.comparePageRules(Xo.base.page_url,n.urls)),s}Cl(t){var e;let i=!1,s=(null==(e=t.url_parameter)?void 0:e.settings)||{};if(uu.keys(s.parameters||{}).length>0){let t=document.location.search||"",e=t.slice(t.indexOf("?")+1).split("&"),n={};for(let i=0;i<e.length;i++){let[t,s]=e[i].split("=");t&&(n[t.toLowerCase()]=decodeURIComponent(s||"").toLowerCase())}for(let r in s.parameters){let t=r.toLowerCase(),e=String(s.parameters[t].toLowerCase());if(n[t]===e){i=!0;break}}}return i}Ul(t,e,i={}){let s=null;return s=uu.setTimeout(()=>{this.Bl(t,e)},this.ql(null==i?void 0:i.enabled,null==i?void 0:i.settings)),s}Wl(t,e){this.Al[t]=this.Al[t]||[],this.Al[t].push(e)}Rl(t,e){var i,s;return!0===(null==(s=null==(i=t.behaviors)?void 0:i[e])?void 0:s.enabled)}zl(t){let e=this._processed.includes(t)&&!0;if(!0!==e){e="1"===zr.Storage.getStampLocal(Ju,[Xo.base.website.id,"status",t])&&!0}return e}Ml(t,e){var i,s;return!1!==(null==(s=null==(i=t.platforms)?void 0:i[e])?void 0:s.enabled)}xl(){let t=this.Ol("last"),e=this.Ol("count"),i=parseInt(zr.Storage.getStampLocal(Ju,t)||"0",10),s=parseInt(zr.Storage.getStampLocal(Ju,e)||"0",10),n=(new Date).getTime();(isNaN(i)||isNaN(s)||s<=0||n-i>=18e5)&&(s+=1,i=n,zr.Storage.setStampLocal(Ju,e,`${s}`)),zr.Storage.setStampLocal(Ju,t,`${n}`)}Ol(t){return[Xo.base.website.id,"visit",t]}In(){this._processed=[],this.kl=null,this.jl=!1,this.Tl=!1,this.Nl=null,this.Ll=10,this.Hl=null,this.Pl=null,this.Vl=null,this.Al={}}}new class{constructor(){t=this,this.Partial=new Tu(this),this.Action=new wu(this),this.Ticket=new Vu(this),this.Broker=new Pu(this),this.Event=new Au(this),this.Trigger=new Gu(this),this.Base=new Uu(this),this.Minimized=new ju(this),this.Chat=new Iu(this),function(t){try{var e={push:ku(Cu.push,Cu),get:ku(Cu.get,Cu),set:ku(Cu.set,Cu),is:ku(Cu.is,Cu),on:ku(Cu.on,Cu),off:ku(Cu.off,Cu),do:ku(Cu.do,Cu),config:ku(Cu.config,Cu),safe:ku(Cu.safe,Cu),help:ku(Cu.help,Cu)};if(Object.defineProperty(e,"__init",{enumerable:!1,value:ku(t.Base.init,t.Base)}),Object.defineProperty(e,"__spool",{enumerable:!1,value:{}}),Object.defineProperty(e,"__debug",{enumerable:!1,value:{}}),t._dollarCrisp=e,t.__spool=e.__spool,t.__debug=e.__debug,e.__spool.pending_actions=[],"object"==typeof window.$crisp&&window.$crisp.length>0)for(var i=0;i<window.$crisp.length;i++)e.__spool.pending_actions.push(window.$crisp[i]);window.$__CRISP_INSTANCE=e,window.$crisp=e,t._dollarCrisp=e}catch(s){}}(this)}__init(t={}){this.Base.init(t)}};const Ku=(t,e)=>{const i=t.Jl||t;for(const[s,n]of e)i[s]=n;return i};function Yu(t){return t&&t.Be&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}export{K as $,d as A,h as B,rt as C,B as D,n as E,S as F,U as G,R as H,I,Fe as J,q as K,Rt as L,ve as M,r as N,a as O,Ot as P,_e as Q,ut as R,je as S,qe as T,j as U,Ue as V,v as W,Y as X,Z as Y,p as Z,G as _,g as a,Ku as a0,Pe as a1,Ls as a2,uu as a3,js as a4,Ge as a5,Us as a6,Xo as a7,Rr as a8,Or as a9,Q as aa,zr as ab,Oo as ac,Xr as ad,We as ae,Qo as af,Yu as ag,yo as ah,Po as ai,e as aj,Os as ak,Gr as al,w as b,Ce as c,D as d,l as e,L as f,T as g,be as h,F as i,Ee as j,ye as k,Be as l,xe as m,J as n,u as o,o as p,ze as q,$e as r,qt as s,Ae as t,Et as u,Ct as v,b as w,s as x,ke as y,M as z};
